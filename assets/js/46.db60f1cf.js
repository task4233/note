(window.webpackJsonp=window.webpackJsonp||[]).push([[46],{314:function(t,s,a){"use strict";a.r(s);var n=a(10),r=Object(n.a)({},(function(){var t=this,s=t._self._c;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h1",{attrs:{id:"seccon-ctf-2022-writeup"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#seccon-ctf-2022-writeup"}},[t._v("#")]),t._v(" SECCON CTF 2022 Writeup")]),t._v(" "),s("h2",{attrs:{id:"ã¯ã—ã‚™ã‚ã«"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#ã¯ã—ã‚™ã‚ã«"}},[t._v("#")]),t._v(" ã¯ã˜ã‚ã«")]),t._v(" "),s("p",[t._v("2022/11/12ã€œ13ã«ã‹ã‘ã¦é–‹å‚¬ã•ã‚ŒãŸSECCON CTF 2022ã«ãƒãƒ¼ãƒ taskã¨ã—ã¦å‚åŠ ã—243/726ä½ã§ã—ãŸã€‚")]),t._v(" "),s("p",[t._v("revã®warmupã§ã‚ã‚‹babycmpã—ã‹é€šã›ãªã‹ã£ãŸãŸã‚writeupã¯ä¸è¦ã‹ã¨æ€ã£ã¦ã„ã¾ã—ãŸã€‚")]),t._v(" "),s("p",[t._v("ã—ã‹ã—ã€ä»–ã®å‚åŠ è€…ã®writeupã‚’è¦‹ã‚‹ã¨ã€ç§ã®ã‚ˆã†ã«GDBã§ç„¡ç†çŸ¢ç†è§£ã„ã¦ã„ã‚‹äººãŒã„ãªã‹ã£ãŸãŸã‚ã€è§£æ³•å…±æœ‰ã®ãŸã‚ã«writeupã‚’æ›¸ãã“ã¨ã«ã—ã¾ã—ãŸã€‚")]),t._v(" "),s("h2",{attrs:{id:"rev-babycmp-176-solves-79pts"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#rev-babycmp-176-solves-79pts"}},[t._v("#")]),t._v(" [Rev] babycmp(176 solves/79pts)")]),t._v(" "),s("blockquote",[s("p",[s("code",[t._v("baby_mode = 1")]),t._v(" ğŸ‘¶")]),t._v(" "),s("p",[s("a",{attrs:{href:"https://dashboard.quals-score.seccon.jp/api/download?key=prod%2Fbabycmp%2Fchall.baby",target:"_blank",rel:"noopener noreferrer"}},[t._v("chall.baby"),s("OutboundLink")],1),t._v(" 214fb8d53720d5183ed0fa850d00c33adb310e60")])]),t._v(" "),s("p",[t._v("64bitã®ELFãƒ•ã‚¡ã‚¤ãƒ«ã§ã€ã‚³ãƒãƒ³ãƒ‰ãƒ©ã‚¤ãƒ³å¼•æ•°ã«æ­£ã—ã„FLAGã‚’è¨­å®šã™ã‚‹ã¨Correctã¨è¡¨ç¤ºã•ã‚Œã‚‹ç³»ã®å•é¡Œã«è¦‹ãˆã¾ã™ã€‚")]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("$ file chall.baby \nchall.baby: ELF 64-bit LSB shared object, x86-64, version 1 (SYSV), dynamically linked, interpreter /lib64/ld-linux-x86-64.so.2, BuildID[sha1]=ded5cc024f968b3087bf5d3df8649d14714e7202, for GNU/Linux 3.2.0, not stripped\n$ ./chall.baby\nUsage: ./chall.baby FLAG\n$ ./chall.baby SECCON{hoge}\nWrong...\n")])])]),s("p",[t._v("Ghidraã§è§£æã™ã‚‹ã¨ã€ä»¥ä¸‹ã®ifæ–‡ãŒtrueãªã‚‰Correctã«ãªã‚‹ã‚ˆã†ã§ã™ã€‚ã—ã‹ã—ã€ã“ã‚Œã‚‰ã®ãƒ‡ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«çµæœã‚’è¦‹ã¦ã‚‚ã‚ˆãåˆ†ã‹ã‚Šã¾ã›ã‚“ã§ã—ãŸã€‚ãã“ã§ã€å‹•çš„è§£æã—ã¦ã¿ã‚‹ã“ã¨ã«ã—ã¾ã—ãŸã€‚")]),t._v(" "),s("p",[s("img",{attrs:{src:"https://user-images.githubusercontent.com/29667656/201532416-ddfe5fb2-a4eb-4c23-91bf-957f0e493919.png",alt:"ghidra"}})]),t._v(" "),s("p",[t._v("GDBã®é€†ã‚¢ã‚»ãƒ³ãƒ–ãƒ«çµæœã‚’è¦‹ã‚‹ã«")]),t._v(" "),s("ul",[s("li",[s("code",[t._v("0x0000000000001271")]),t._v(" ã® "),s("code",[t._v("je")]),t._v(" å‘½ä»¤")]),t._v(" "),s("li",[s("code",[t._v("0x00000000000012b5")]),t._v(" ã® "),s("code",[t._v("jne")]),t._v(" å‘½ä»¤")]),t._v(" "),s("li",[s("code",[t._v("0x00000000000012c0")]),t._v(" ã® "),s("code",[t._v("jne")]),t._v(" å‘½ä»¤")])]),t._v(" "),s("p",[t._v("ãŒãã‚Œãã‚Œæ¡ä»¶ã‚’æº€ãŸã›ã°è‰¯ã„ã“ã¨ãŒåˆ†ã‹ã‚Šã¾ã™ã€‚")]),t._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[t._v("$ gdb -q ./chall.baby\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("snip"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\ngdb-peda$ disas main\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("snip"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n   0x0000000000001257 "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("+21"),s("span",{pre:!0,attrs:{class:"token operator"}},[s("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[t._v("5")]),t._v(">")]),t._v(":\tmov    r12,QWORD PTR "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("rbp+0x8"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n   0x000000000000125b "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("+21"),s("span",{pre:!0,attrs:{class:"token operator"}},[s("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[t._v("9")]),t._v(">")]),t._v(":\tmov    rax,QWORD PTR "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("r12"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n   0x000000000000125f "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("+22"),s("span",{pre:!0,attrs:{class:"token operator"}},[s("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[t._v("3")]),t._v(">")]),t._v(":\tmov    rdx,QWORD PTR "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("r12+0x8"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n   0x0000000000001264 "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("+22"),s("span",{pre:!0,attrs:{class:"token operator"}},[s("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[t._v("8")]),t._v(">")]),t._v(":\txor    rax,QWORD PTR "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("rsp+0x20"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" \n   0x0000000000001269 "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("+23"),s("span",{pre:!0,attrs:{class:"token operator"}},[s("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[t._v("3")]),t._v(">")]),t._v(":\txor    rdx,QWORD PTR "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("rsp+0x28"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n   0x000000000000126e "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("+23"),s("span",{pre:!0,attrs:{class:"token operator"}},[s("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[t._v("8")]),t._v(">")]),t._v(":\tor     rdx,rax\n   0x0000000000001271 "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("+24"),s("span",{pre:!0,attrs:{class:"token operator"}},[s("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[t._v("1")]),t._v(">")]),t._v(":\tje     0x129e "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("main+28"),s("span",{pre:!0,attrs:{class:"token operator"}},[s("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[t._v("6")]),t._v(">")]),t._v("         "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 1ã¤ç›®ã®æ¡ä»¶")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("snip"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("   \n   0x000000000000129e "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("+28"),s("span",{pre:!0,attrs:{class:"token operator"}},[s("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[t._v("6")]),t._v(">")]),t._v(":\tmov    rax,QWORD PTR "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("r12+0x10"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n   0x00000000000012a3 "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("+29"),s("span",{pre:!0,attrs:{class:"token operator"}},[s("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[t._v("1")]),t._v(">")]),t._v(":\tmov    rdx,QWORD PTR "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("r12+0x18"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n   0x00000000000012a8 "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("+29"),s("span",{pre:!0,attrs:{class:"token operator"}},[s("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[t._v("6")]),t._v(">")]),t._v(":\txor    rax,QWORD PTR "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("rsp+0x30"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n   0x00000000000012ad "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("+30"),s("span",{pre:!0,attrs:{class:"token operator"}},[s("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[t._v("1")]),t._v(">")]),t._v(":\txor    rdx,QWORD PTR "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("rsp+0x38"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n   0x00000000000012b2 "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("+30"),s("span",{pre:!0,attrs:{class:"token operator"}},[s("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[t._v("6")]),t._v(">")]),t._v(":\tor     rdx,rax\n   0x00000000000012b5 "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("+30"),s("span",{pre:!0,attrs:{class:"token operator"}},[s("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[t._v("9")]),t._v(">")]),t._v(":\tjne    0x1273 "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("main+24"),s("span",{pre:!0,attrs:{class:"token operator"}},[s("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[t._v("3")]),t._v(">")]),t._v("         "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 2ã¤ç›®ã®æ¡ä»¶")]),t._v("\n   0x00000000000012b7 "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("+31"),s("span",{pre:!0,attrs:{class:"token operator"}},[s("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[t._v("1")]),t._v(">")]),t._v(":\tmov    eax,DWORD PTR "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("rsp+0x40"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n   0x00000000000012bb "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("+31"),s("span",{pre:!0,attrs:{class:"token operator"}},[s("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[t._v("5")]),t._v(">")]),t._v(":\t"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("cmp")]),t._v("    DWORD PTR "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("r12+0x20"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(",eax\n   0x00000000000012c0 "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("+32"),s("span",{pre:!0,attrs:{class:"token operator"}},[s("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[t._v("0")]),t._v(">")]),t._v(":\tjne    0x1273 "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("main+24"),s("span",{pre:!0,attrs:{class:"token operator"}},[s("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[t._v("3")]),t._v(">")]),t._v("         "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 3ã¤ç›®ã®æ¡ä»¶")]),t._v("\n   0x00000000000012c2 "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("+32"),s("span",{pre:!0,attrs:{class:"token operator"}},[s("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[t._v("2")]),t._v(">")]),t._v(":\tlea    rdi,"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("rip+0x1e1b"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("        \n   0x00000000000012c9 "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("+32"),s("span",{pre:!0,attrs:{class:"token operator"}},[s("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[t._v("9")]),t._v(">")]),t._v(":\txor    r12d,r12d\n   0x00000000000012cc "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("+33"),s("span",{pre:!0,attrs:{class:"token operator"}},[s("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[t._v("2")]),t._v(">")]),t._v(":\tcall   0x1100 "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("puts@plt"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("snip"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),s("p",[t._v("ãã®ãŸã‚ã«ã€ãã‚Œãã‚Œã®å‘½ä»¤ã®å‰ã® "),s("code",[t._v("xor")]),t._v(" å‘½ä»¤ãŠã‚ˆã³ "),s("code",[t._v("cmp")]),t._v(" å‘½ä»¤ã«ã¦ä»¥ä¸‹ã‚’æ¯”è¼ƒã—ã¦ã„ã‚‹ã“ã¨ãŒåˆ†ã‹ã‚Šã¾ã™ã€‚æœ€çµ‚çš„ã«ã€æ­£ã—ã„FLAGãŒã‚³ãƒãƒ³ãƒ‰ãƒ©ã‚¤ãƒ³å¼•æ•°ã§æ¸¡ã•ã‚ŒãŸæ™‚ã«ã€ã“ã‚Œã‚‰ã®ãƒ¬ã‚¸ã‚¹ã‚¿ã¨ã‚¹ã‚¿ãƒƒã‚¯é ˜åŸŸã®å€¤ãŒä¸€è‡´ã™ã‚‹ã¯ãšã§ã™ã€‚FLAGã«åˆ©ç”¨ã§ãã‚‹æ–‡å­—ç¨®ã¯Rulesã«æ›¸ã„ã¦ã‚ã‚‹é€šã‚Šã€ASCIIã® "),s("code",[t._v("0x20")]),t._v(" ã‹ã‚‰ "),s("code",[t._v("0x7e")]),t._v(" ã®é–“ã§ã™ã€‚ãã®ãŸã‚ã®1æ–‡å­—ãšã¤ãƒªãƒ¼ã‚¯ã•ã›ã‚‹ã“ã¨ãŒå¯èƒ½ã§ã™ã€‚")]),t._v(" "),s("table",[s("thead",[s("tr",[s("th",[t._v("ãƒ¬ã‚¸ã‚¹ã‚¿")]),t._v(" "),s("th",[t._v("ã‚¹ã‚¿ãƒƒã‚¯é ˜åŸŸ")])])]),t._v(" "),s("tbody",[s("tr",[s("td",[t._v("rax")]),t._v(" "),s("td",[t._v("QWORD PTR [rsp+0x20]")])]),t._v(" "),s("tr",[s("td",[t._v("rdx")]),t._v(" "),s("td",[t._v("QWORD PTR [rsp+0x28]")])]),t._v(" "),s("tr",[s("td",[t._v("rax")]),t._v(" "),s("td",[t._v("QWORD PTR [rsp+0x30]")])]),t._v(" "),s("tr",[s("td",[t._v("rdx")]),t._v(" "),s("td",[t._v("QWORD PTR [rsp+0x38]")])]),t._v(" "),s("tr",[s("td",[t._v("eax")]),t._v(" "),s("td",[t._v("DWORD PTR [rsp+0x40]")])])])]),t._v(" "),s("p",[t._v("ãã®æ“ä½œã‚’ã™ã‚‹ãŸã‚ã®GDB ScriptãŒã“ã¡ã‚‰ã§ã™ã€‚ "),s("code",[t._v("FLAG=")]),t._v(" ã®éƒ¨åˆ†16æ–‡å­—ãšã¤ã—ã‹ãƒªãƒ¼ã‚¯ã§ããªã„ã®ã§ã€å°‘ã—ãšã¤ä¸Šæ›¸ãã—ã¾ã—ãŸã€‚çµæœã€FLAGã‚’å–å¾—ã§ãã¾ã—ãŸã€‚")]),t._v(" "),s("div",{staticClass:"language-python extra-class"},[s("pre",{pre:!0,attrs:{class:"language-python"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" gdb\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" re\n\nFLAG"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("''")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 1st breakpoint")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v('# breakpoint="0x555555555264"')]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# -> SECCON{y0u_f0und")]),t._v("\nFLAG"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'SECCON{y0u_f0und'")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 2nd breakpoint")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v('# breakpoint="0x5555555552a8"')]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# -> SECCON{y0u_f0und_7h3_baby_flag_Y")]),t._v("\nFLAG"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'SECCON{y0u_f0und_7h3_baby_flag_Y'")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 3rd breakpoint")]),t._v("\nbreakpoint"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"0x5555555552bb"')]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# # -> SECCON{y0u_f0und_7h3_baby_flag_YaY}")]),t._v("\n\ngdb"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("execute"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string-interpolation"}},[s("span",{pre:!0,attrs:{class:"token string"}},[t._v('f"b *')]),s("span",{pre:!0,attrs:{class:"token interpolation"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("breakpoint"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")])]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"')])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" i "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("in")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("range")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("8")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# flag format is SECCON{[\\x20-\\x7e]+}")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" ch "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("in")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("range")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0x20")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0x7e")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("any")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("scheme "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("==")]),t._v(" ch "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" scheme "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("in")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0x27")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("continue")]),t._v("\n\n        tmp_flag "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" FLAG "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("chr")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("ch"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("print")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("tmp_flag"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    \n        gdb"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("execute"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string-interpolation"}},[s("span",{pre:!0,attrs:{class:"token string"}},[t._v("f\"r '")]),s("span",{pre:!0,attrs:{class:"token interpolation"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("tmp_flag"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")])]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'\"")])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n        "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# rax = gdb.parse_and_eval('$rax')")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# rdx = gdb.parse_and_eval('$rdx')")]),t._v("\n        eax "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" gdb"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("parse_and_eval"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'$eax'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n        i "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" gdb"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("inferiors"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n        rsp_list "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n\n        "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# offsetã¯0x20(rax) -> 0x28(rdx) -> 0x30(rax) -> 0x38(rdx) -> 0x40")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# y0uã®0ãŒã†ã¾ãå‹•ã„ã¦ãªã‹ã£ãŸã€ãªãœï¼Ÿguessã—ã¦ã—ã¾ã£ãŸã‘ã©")]),t._v("\n        padding "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0x20")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# offset = 0x20 + padding")]),t._v("\n        offset "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0x20")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" idx "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("in")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("range")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("8")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# stack_addr = gdb.parse_and_eval(f'$rsp+{hex(offset + idx)}')")]),t._v("\n            r12 "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" gdb"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("parse_and_eval"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'$r12'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n            stack_addr "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" gdb"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("parse_and_eval"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string-interpolation"}},[s("span",{pre:!0,attrs:{class:"token string"}},[t._v("f'")]),s("span",{pre:!0,attrs:{class:"token interpolation"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("hex")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("int")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("r12"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" offset"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" idx"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")])]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'")])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n            m "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" i"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("read_memory"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("stack_addr"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n            rsp_list"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("append"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("m"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("hex")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n        "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# rax_list = re.split('(..)',format(int(rax), '016x'))[1::2]")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# rax_list.reverse()")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# rdx_list = re.split('(..)',format(int(rdx), '016x'))[1::2]")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# rdx_list.reverse()")]),t._v("\n        eax_list "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" re"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("split"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'(..)'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("format")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("int")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("eax"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'016x'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n        eax_list"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("reverse"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n        "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v('# print(f"rax: {rax_list}")')]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v('# print(f"rdx: {rdx_list}")')]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("print")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string-interpolation"}},[s("span",{pre:!0,attrs:{class:"token string"}},[t._v('f"eax: ')]),s("span",{pre:!0,attrs:{class:"token interpolation"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("eax_list"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")])]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"')])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("print")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string-interpolation"}},[s("span",{pre:!0,attrs:{class:"token string"}},[t._v('f"rsp: ')]),s("span",{pre:!0,attrs:{class:"token interpolation"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("rsp_list"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")])]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"')])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n        gdb"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("execute"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'c'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n        is_ok "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("True")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" idx "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("in")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("range")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("len")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("tmp_flag"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("padding"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# paddingã®1ã®ä½ãŒ0ã®æ™‚ã¯raxã€8ã®æ™‚ã¯rdxãƒ¬ã‚¸ã‚¹ã‚¿ã‚’å‚ç…§ã™ã‚‹")]),t._v("\n            ra "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" eax_list"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("idx"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n            sp "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" rsp_list"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("idx"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("print")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string-interpolation"}},[s("span",{pre:!0,attrs:{class:"token string"}},[t._v('f"ra: ')]),s("span",{pre:!0,attrs:{class:"token interpolation"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("ra"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")])]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v(", sp: ")]),s("span",{pre:!0,attrs:{class:"token interpolation"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("sp"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")])]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v(", ra==sp: ")]),s("span",{pre:!0,attrs:{class:"token interpolation"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("ra"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("==")]),t._v("sp"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")])]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"')])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n            is_ok "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("ra"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("==")]),t._v("sp"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("not")]),t._v(" is_ok"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("continue")]),t._v("\n        FLAG "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" tmp_flag\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("print")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string-interpolation"}},[s("span",{pre:!0,attrs:{class:"token string"}},[t._v('f"OK!!!! ')]),s("span",{pre:!0,attrs:{class:"token interpolation"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("FLAG"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")])]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"')])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("break")]),t._v("\n")])])]),s("h2",{attrs:{id:"ãŠã‚ã‚Šã«"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#ãŠã‚ã‚Šã«"}},[t._v("#")]),t._v(" ãŠã‚ã‚Šã«")]),t._v(" "),s("p",[t._v("ã‚ã¾ã‚Šè³¢ã„è§£ãæ–¹ã§ã¯ãªã„ã§ã™ãŒã€è§£ã‘ãŸã®ã¯å¬‰ã—ã‹ã£ãŸã§ã™ã€‚Webå•é¡Œã®å¾©ç¿’ã«ã¯ã‚‚ã†å°‘ã—æ™‚é–“ãŒã‹ã‹ã‚Šãã†ãªã®ã§ã€ãã‚Œã‚‚çµ‚ã‚ã£ãŸã‚‰å¾©ç¿’è¨˜äº‹ã‚’æ›¸ã“ã†ã¨æ€ã„ã¾ã™ã€‚")]),t._v(" "),s("ul",[s("li",[s("a",{attrs:{href:"https://twitter.com/task4233/status/1591673054413094912?s=20&t=hABu5HZBk9yiez4FCmDPsQ",target:"_blank",rel:"noopener noreferrer"}},[t._v("Twitterã®Webå•å¾©ç¿’ã‚¹ãƒ¬ãƒƒãƒ‰"),s("OutboundLink")],1)])])])}),[],!1,null,null,null);s.default=r.exports}}]);