(window.webpackJsonp=window.webpackJsonp||[]).push([[41],{456:function(t,a,s){"use strict";s.r(a);var e=s(36),r=Object(e.a)({},(function(){var t=this,a=t.$createElement,s=t._self._c||a;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h1",{attrs:{id:"imctf-writeup"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#imctf-writeup"}},[t._v("#")]),t._v(" IMCTF writeup")]),t._v(" "),s("h2",{attrs:{id:"はじめに"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#はじめに"}},[t._v("#")]),t._v(" はじめに")]),t._v(" "),s("p",[t._v("IMCTF2021にTsukushiのメンバーとして参加し、その中で私が5694点獲得して全体2位でした。")]),t._v(" "),s("img",{attrs:{width:"1117",alt:"スクリーンショット 2021-12-19 18 20 22",src:"https://user-images.githubusercontent.com/29667656/146669851-acd54360-7ee2-42f3-8efa-642d0078f618.png"}}),t._v(" "),s("p",[t._v("解いた問題だけ簡単に方針を書いておきました。")]),t._v(" "),s("h2",{attrs:{id:"web"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#web"}},[t._v("#")]),t._v(" Web")]),t._v(" "),s("h3",{attrs:{id:"can-you-see-cookie-🍪"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#can-you-see-cookie-🍪"}},[t._v("#")]),t._v(" can you see cookie?🍪")]),t._v(" "),s("blockquote",[s("p",[t._v("君には、このクッキーが見えるか？")])]),t._v(" "),s("p",[t._v("対象ページにアクセスするとCookieが付与されているので、それを見れば良いです。見るとBase64エンコードされていたのでデコードしました。")]),t._v(" "),s("h3",{attrs:{id:"for-stranger-of-storage🤠"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#for-stranger-of-storage🤠"}},[t._v("#")]),t._v(" for stranger of storage🤠")]),t._v(" "),s("blockquote",[s("p",[t._v("なんてこった！最悪だぜ！まさかそんなとこに置き忘れるなんて！")])]),t._v(" "),s("p",[t._v("Local Storageに意味ありげな文字列があったので、CyberChefに投げ込みました。")]),t._v(" "),s("p",[s("a",{attrs:{href:"https://gchq.github.io/CyberChef/",target:"_blank",rel:"noopener noreferrer"}},[t._v("CyberChef"),s("OutboundLink")],1)]),t._v(" "),s("h3",{attrs:{id:"not-any-more-logging📜"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#not-any-more-logging📜"}},[t._v("#")]),t._v(" not any more logging📜")]),t._v(" "),s("blockquote",[s("p",[t._v("私たちにはもはやログなど必要ない。そう、リリースしたのだから。")])]),t._v(" "),s("p",[t._v("JavaScriptを見たら難読化されていたので、解除して部分文字列を連結しました。")]),t._v(" "),s("h2",{attrs:{id:"misc"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#misc"}},[t._v("#")]),t._v(" Misc")]),t._v(" "),s("h3",{attrs:{id:"no-this-site-no-life-🎥"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#no-this-site-no-life-🎥"}},[t._v("#")]),t._v(" no this site no life? 🎥")]),t._v(" "),s("blockquote",[s("p",[t._v("クリスマスが盗まれたらしい。緑の怪物がやりやがった。どうしてかって？知ったことか。取り返したいなら、このファイルを使いな！")])]),t._v(" "),s("p",[s("code",[t._v("dp B07PQNYBZ4")]),t._v("でググったら出てきたので、Chromeのconsoleで実行しました。")]),t._v(" "),s("h3",{attrs:{id:"made-of-honey🍯"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#made-of-honey🍯"}},[t._v("#")]),t._v(" made of honey🍯")]),t._v(" "),s("blockquote",[s("p",[t._v("100エーカーの森にもICT化の波は来ているらしい。ここ、はちみつ王国で怪しい影がうごめく。「よう！俺様テガー！今宵、クマ王子プー様はクリスマスパーティーにご出席らしい。やつのPCはお留守だ。今のうちにハチミツ金庫のパスワードを抜き取っちまおう。なんだこれ？」テガーはクリススー・エヴァンに見せてみた。「ああ、これは、プーが欲しがっているものだよ。これで新しいハチミツの産地を開拓するんだってね」")])]),t._v(" "),s("p",[t._v("crackstationに投げたら復元できたので連結しました。")]),t._v(" "),s("h3",{attrs:{id:"brute-force-gui💪"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#brute-force-gui💪"}},[t._v("#")]),t._v(" brute force gui💪")]),t._v(" "),s("blockquote",[s("p",[t._v("R2 は最高のアストロメク・ドロイドだと思うかい？彼はC3にクイズを出したらしい。「パスワードが分かるか？600万言語以上話せる私に不可能などあるものですか！」")])]),t._v(" "),s("p",[t._v("GUIアプリを立ち上げると2桁の数字が入力できたので、適当に99を入れたら通りました。")]),t._v(" "),s("h2",{attrs:{id:"crypto"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#crypto"}},[t._v("#")]),t._v(" Crypto")]),t._v(" "),s("h3",{attrs:{id:"static-random👽"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#static-random👽"}},[t._v("#")]),t._v(" static random👽")]),t._v(" "),s("blockquote",[s("p",[t._v("「俺たちの活躍を見逃すな！」「We Are ...」")])]),t._v(" "),s("p",[t._v("seedが固定値なので、randomも実質固定値です。encrypt関数が公開されているので、その逆操作を行いました。")]),t._v(" "),s("div",{staticClass:"language-python extra-class"},[s("pre",{pre:!0,attrs:{class:"language-python"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" random\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("def")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("dec")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("inputtext"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("str")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    random"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("seed"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"we wish a merry xmas"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    encoded"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("str")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('""')]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" item "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("in")]),t._v(" inputtext"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n        encoded "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("chr")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("ord")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("item"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" random"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("randint"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("10")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" encoded\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" __name__ "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("==")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"__main__"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("with")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("open")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"message.txt"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"r"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" f"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n        enc "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" f"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("read"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("print")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("dec"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("enc"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),s("h3",{attrs:{id:"oreore😎"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#oreore😎"}},[t._v("#")]),t._v(" oreore😎")]),t._v(" "),s("blockquote",[s("p",[t._v("太郎君は天才なので独自暗号を発明しました。彼によると最も安全な暗号らしいですが...")])]),t._v(" "),s("p",[t._v("base64 -> hexStringとされていたので、逆の変換を行ったら通りました。")]),t._v(" "),s("h3",{attrs:{id:"love-letter💌"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#love-letter💌"}},[t._v("#")]),t._v(" love letter💌")]),t._v(" "),s("blockquote",[s("p",[t._v("クリスマスのエモいエピソードを解読してフラグをゲットしましょう。")])]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("ewvnuwjq wlte b cupl cleelx eu ibtbiu rux fjxqwehbw. ewvnuwjq cqilw fer, wu jl vwlk ejl rcbz eu ldgxlww hn brrlfequt. ejl cupl cleelx mbw qhfer{lnl_cupl_nuv_ibtbiu_nlbbbbj}. ibtbiu mbw wjufilk btk euwwlk ejl cupl cleelx.\n")])])]),s("p",[t._v("換字式暗号です。"),s("code",[t._v("a")]),t._v("や"),s("code",[t._v("the")]),t._v("、"),s("code",[t._v("to")]),t._v("は変換できるので地道にやれば解けます。")]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("TSUYOSHI SENT A LOVE LETTER TO KANAKO FOR CHRISTMAS. TSUYOSHI LIKES CTF, SO HE USED THE FLA_ TO E__RESS MY AFFECTION. THE LOVE LETTER _AS IMCTF{EYE_LOVE_YOU_KANAKO_YEAAAAH}. KANAKO _AS SHOCKED AND TOSSED THE LOVE LETTER.\n")])])]),s("h2",{attrs:{id:"rev"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#rev"}},[t._v("#")]),t._v(" rev")]),t._v(" "),s("h3",{attrs:{id:"ninninpdf"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#ninninpdf"}},[t._v("#")]),t._v(" ninninpdf")]),t._v(" "),s("blockquote",[s("p",[t._v("「にんにん！拙者は忍者ハットリくん！今宵、秘密の暗号を雪の中に隠したぞ！」")])]),t._v(" "),s("p",[t._v("PDF Stream Dumper Parserで読み取ると、Base64エンコードされた文字列があったので、それをBase64デコードしました。")]),t._v(" "),s("h3",{attrs:{id:"become-monkey🐒"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#become-monkey🐒"}},[t._v("#")]),t._v(" become monkey🐒")]),t._v(" "),s("blockquote",[s("p",[t._v("カオスエンジニアリングを実践しましょう。さあ、今から Failure Injection Testing を始めます。皆さんにはこれからおサルさんになってもらいます。え？何ですか？「Chaos Monkey」っていうツールがあるんですか？知りません。とりあえず今すぐできることをやってください。")])]),t._v(" "),s("p",[t._v("Exceptionをたくさん出せば良いです。")]),t._v(" "),s("ul",[s("li",[t._v("Zero Division\n"),s("ul",[s("li",[t._v("ゼロ除算すれば良いです")])])]),t._v(" "),s("li",[t._v("Format Error\n"),s("ul",[s("li",[t._v("文字列を入力すれば良いです")])])]),t._v(" "),s("li",[t._v("Overflow\n"),s("ul",[s("li",[t._v("巨大な数字を入力すれば良いです")])])])]),t._v(" "),s("h2",{attrs:{id:"おわりに"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#おわりに"}},[t._v("#")]),t._v(" おわりに")]),t._v(" "),s("p",[t._v("今回はチームメンバがシュッとFlagを通してくれたので本当によかったです。")]),t._v(" "),s("p",[t._v("それと、BugHunterの称号をいただきました。")]),t._v(" "),s("p",[s("img",{attrs:{src:"https://i.imgur.com/wzoNgq4.png",alt:""}})]),t._v(" "),s("p",[t._v("問題数が多くて非常に楽しめました。\nありがとうございました！")])])}),[],!1,null,null,null);a.default=r.exports}}]);