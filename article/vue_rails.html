<!DOCTYPE html>
<html lang="ja">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Vue x Rails | Note</title>
    <meta name="generator" content="VuePress 1.8.2">
    <link rel="icon" href="/imgs/icons/icon.png">
    <link rel="manifest" href="/manifest.json">
    <link rel="shortcut icon" href="/imgs/icons/favicon.ico">
    <meta name="description" content="RailsのアプリケーションにVue.jsを導入できることがわかったので, 試してみることにした.">
    <meta name="theme-color" content="#3eaf7c">
    
    <link rel="preload" href="/assets/css/0.styles.e16f9711.css" as="style"><link rel="preload" href="/assets/js/app.742f0a32.js" as="script"><link rel="preload" href="/assets/js/2.b8499f1b.js" as="script"><link rel="preload" href="/assets/js/85.817aa786.js" as="script"><link rel="preload" href="/assets/js/3.31e57b96.js" as="script"><link rel="prefetch" href="/assets/js/10.27a0de37.js"><link rel="prefetch" href="/assets/js/11.a5a9905c.js"><link rel="prefetch" href="/assets/js/12.5d1e3edd.js"><link rel="prefetch" href="/assets/js/13.adfdc913.js"><link rel="prefetch" href="/assets/js/14.ef13afc6.js"><link rel="prefetch" href="/assets/js/15.ed40269d.js"><link rel="prefetch" href="/assets/js/16.8166e7a5.js"><link rel="prefetch" href="/assets/js/17.33cce054.js"><link rel="prefetch" href="/assets/js/18.5ea8b8bc.js"><link rel="prefetch" href="/assets/js/19.80e6c60e.js"><link rel="prefetch" href="/assets/js/20.0e296bc9.js"><link rel="prefetch" href="/assets/js/21.b2738c76.js"><link rel="prefetch" href="/assets/js/22.81a8f627.js"><link rel="prefetch" href="/assets/js/23.38dfae9e.js"><link rel="prefetch" href="/assets/js/24.9efdd680.js"><link rel="prefetch" href="/assets/js/25.3333e41a.js"><link rel="prefetch" href="/assets/js/26.edf3d886.js"><link rel="prefetch" href="/assets/js/27.28b6e9d6.js"><link rel="prefetch" href="/assets/js/28.397df9d9.js"><link rel="prefetch" href="/assets/js/29.4ae66d78.js"><link rel="prefetch" href="/assets/js/30.b2f9457d.js"><link rel="prefetch" href="/assets/js/31.c12ab2ca.js"><link rel="prefetch" href="/assets/js/32.b371ca19.js"><link rel="prefetch" href="/assets/js/33.315baaed.js"><link rel="prefetch" href="/assets/js/34.d6ea7706.js"><link rel="prefetch" href="/assets/js/35.e14804bb.js"><link rel="prefetch" href="/assets/js/36.29be0c17.js"><link rel="prefetch" href="/assets/js/37.a791948c.js"><link rel="prefetch" href="/assets/js/38.9f371b2a.js"><link rel="prefetch" href="/assets/js/39.624a65d5.js"><link rel="prefetch" href="/assets/js/4.00d6b6ad.js"><link rel="prefetch" href="/assets/js/40.b18b3c21.js"><link rel="prefetch" href="/assets/js/41.2c2cd910.js"><link rel="prefetch" href="/assets/js/42.75015da0.js"><link rel="prefetch" href="/assets/js/43.8bf93ca6.js"><link rel="prefetch" href="/assets/js/44.78668bc3.js"><link rel="prefetch" href="/assets/js/45.9fc3017a.js"><link rel="prefetch" href="/assets/js/46.8ae11a8d.js"><link rel="prefetch" href="/assets/js/47.cf076206.js"><link rel="prefetch" href="/assets/js/48.c85f5a87.js"><link rel="prefetch" href="/assets/js/49.a1176862.js"><link rel="prefetch" href="/assets/js/5.1d72ad79.js"><link rel="prefetch" href="/assets/js/50.afe5718f.js"><link rel="prefetch" href="/assets/js/51.f9ae16aa.js"><link rel="prefetch" href="/assets/js/52.bf63b8cd.js"><link rel="prefetch" href="/assets/js/53.1d582d3c.js"><link rel="prefetch" href="/assets/js/54.5e81163a.js"><link rel="prefetch" href="/assets/js/55.687a5957.js"><link rel="prefetch" href="/assets/js/56.9f5d23eb.js"><link rel="prefetch" href="/assets/js/57.90330f56.js"><link rel="prefetch" href="/assets/js/58.88393432.js"><link rel="prefetch" href="/assets/js/59.6f51f4d7.js"><link rel="prefetch" href="/assets/js/6.5a204597.js"><link rel="prefetch" href="/assets/js/60.7f62be46.js"><link rel="prefetch" href="/assets/js/61.1522686e.js"><link rel="prefetch" href="/assets/js/62.2cc7ef2d.js"><link rel="prefetch" href="/assets/js/63.2c2ffcc3.js"><link rel="prefetch" href="/assets/js/64.c5a97a54.js"><link rel="prefetch" href="/assets/js/65.72ab04cf.js"><link rel="prefetch" href="/assets/js/66.3c7c8a84.js"><link rel="prefetch" href="/assets/js/67.2a5e7dea.js"><link rel="prefetch" href="/assets/js/68.aba408a9.js"><link rel="prefetch" href="/assets/js/69.9cfbc645.js"><link rel="prefetch" href="/assets/js/7.0b1e9a07.js"><link rel="prefetch" href="/assets/js/70.6cdd914a.js"><link rel="prefetch" href="/assets/js/71.029e4fff.js"><link rel="prefetch" href="/assets/js/72.5ce05afc.js"><link rel="prefetch" href="/assets/js/73.82fc84f6.js"><link rel="prefetch" href="/assets/js/74.93545ca5.js"><link rel="prefetch" href="/assets/js/75.e29c350b.js"><link rel="prefetch" href="/assets/js/76.a23695d0.js"><link rel="prefetch" href="/assets/js/77.6b59075d.js"><link rel="prefetch" href="/assets/js/78.7d47e567.js"><link rel="prefetch" href="/assets/js/79.0c989041.js"><link rel="prefetch" href="/assets/js/8.7d241289.js"><link rel="prefetch" href="/assets/js/80.bb13499d.js"><link rel="prefetch" href="/assets/js/81.4f6027d0.js"><link rel="prefetch" href="/assets/js/82.6e7574a0.js"><link rel="prefetch" href="/assets/js/83.af84d6f4.js"><link rel="prefetch" href="/assets/js/84.47e724cd.js"><link rel="prefetch" href="/assets/js/86.91836f2b.js"><link rel="prefetch" href="/assets/js/87.5e26e887.js"><link rel="prefetch" href="/assets/js/88.a3490bcb.js"><link rel="prefetch" href="/assets/js/9.d5e50345.js">
    <link rel="stylesheet" href="/assets/css/0.styles.e16f9711.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">Note</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/#links" class="nav-link">Links</a></div><div class="nav-item"><a href="/tags/" class="nav-link">Articles</a></div><div class="nav-item"><a href="/chukapi_fun_art.html" class="nav-link">Chukapi-Fun-Art</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/#links" class="nav-link">Links</a></div><div class="nav-item"><a href="/tags/" class="nav-link">Articles</a></div><div class="nav-item"><a href="/chukapi_fun_art.html" class="nav-link">Chukapi-Fun-Art</a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>Vue x Rails</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/article/vue_rails.html#_2019-1-26" class="sidebar-link">2019/1/26</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/article/vue_rails.html#プロジェクトの生成" class="sidebar-link">プロジェクトの生成</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/article/vue_rails.html#vue-jsの参照" class="sidebar-link">Vue.jsの参照</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/article/vue_rails.html#devサーバの自動コンパイル" class="sidebar-link">devサーバの自動コンパイル</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/article/vue_rails.html#foreman-gemのインストール" class="sidebar-link">foreman gemのインストール</a></li><li class="sidebar-sub-header"><a href="/article/vue_rails.html#bin-serverとprocfileの追記" class="sidebar-link">bin/serverとProcfileの追記</a></li><li class="sidebar-sub-header"><a href="/article/vue_rails.html#実践" class="sidebar-link">実践</a></li></ul></li><li><a href="/article/vue_rails.html#apiの準備" class="sidebar-link">APIの準備</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/article/vue_rails.html#テーブルとモデルの作成" class="sidebar-link">テーブルとモデルの作成</a></li><li class="sidebar-sub-header"><a href="/article/vue_rails.html#apiのルーティングの設定" class="sidebar-link">APIのルーティングの設定</a></li><li class="sidebar-sub-header"><a href="/article/vue_rails.html#コントローラを作成" class="sidebar-link">コントローラを作成</a></li><li class="sidebar-sub-header"><a href="/article/vue_rails.html#viewのjsonファイル" class="sidebar-link">ViewのJSONファイル</a></li><li class="sidebar-sub-header"><a href="/article/vue_rails.html#seeds-rbを作成し-curlコマンドで確認" class="sidebar-link">seeds.rbを作成し, curlコマンドで確認</a></li><li class="sidebar-sub-header"><a href="/article/vue_rails.html#curlでgetしてみる" class="sidebar-link">curlでGETしてみる</a></li><li class="sidebar-sub-header"><a href="/article/vue_rails.html#curlでpostしてみる" class="sidebar-link">curlでPOSTしてみる</a></li><li class="sidebar-sub-header"><a href="/article/vue_rails.html#認証機能の追加" class="sidebar-link">認証機能の追加</a></li></ul></li><li><a href="/article/vue_rails.html#_2019-1-27" class="sidebar-link">2019/1/27</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/article/vue_rails.html#認証機能の追加-つづき" class="sidebar-link">認証機能の追加(つづき)</a></li></ul></li><li><a href="/article/vue_rails.html#secureな認証付きトークンを用いてpostする" class="sidebar-link">secureな認証付きトークンを用いてPOSTする</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/article/vue_rails.html#最悪の対処法" class="sidebar-link">最悪の対処法</a></li></ul></li><li><a href="/article/vue_rails.html#materializeの導入" class="sidebar-link">Materializeの導入</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/article/vue_rails.html#componentsを活用してヘッダを作成" class="sidebar-link">Componentsを活用してヘッダを作成</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/article/vue_rails.html#vue-routerを使用する" class="sidebar-link">Vue-Routerを使用する</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/article/vue_rails.html#what-s-vue-router" class="sidebar-link">What's Vue-Router?</a></li><li class="sidebar-sub-header"><a href="/article/vue_rails.html#vue-routerの追加" class="sidebar-link">Vue-Routerの追加</a></li><li class="sidebar-sub-header"><a href="/article/vue_rails.html#componentsの作成" class="sidebar-link">Componentsの作成</a></li><li class="sidebar-sub-header"><a href="/article/vue_rails.html#作成したcomponentsをvue-routerに登録" class="sidebar-link">作成したComponentsをVue-routerに登録</a></li></ul></li><li><a href="/article/vue_rails.html#axiosを用いたapi通信-ajax" class="sidebar-link">Axiosを用いたAPI通信(Ajax)</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/article/vue_rails.html#what-s-axios" class="sidebar-link">What's Axios?</a></li><li class="sidebar-sub-header"><a href="/article/vue_rails.html#axiosのインストール" class="sidebar-link">Axiosのインストール</a></li><li class="sidebar-sub-header"><a href="/article/vue_rails.html#実践-axios" class="sidebar-link">実践(Axios)</a></li><li class="sidebar-sub-header"><a href="/article/vue_rails.html#新規作成フォームの作成" class="sidebar-link">新規作成フォームの作成</a></li></ul></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="vue-x-rails"><a href="#vue-x-rails" class="header-anchor">#</a> Vue x Rails</h1> <p><a href="https://re-engines.com/2018/04/09/vue-js%E3%81%A8rails%E3%81%A7todo%E3%82%A2%E3%83%97%E3%83%AA%E3%81%AE%E3%83%81%E3%83%A5%E3%83%BC%E3%83%88%E3%83%AA%E3%82%A2%E3%83%AB%E3%81%BF%E3%81%9F%E3%81%84%E3%81%AA%E3%82%82%E3%81%AE%E3%82%92/" target="_blank" rel="noopener noreferrer">こちら<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>のサイトを参考にチュートリアルを進めています.</p> <h2 id="_2019-1-26"><a href="#_2019-1-26" class="header-anchor">#</a> 2019/1/26</h2> <h2 id="プロジェクトの生成"><a href="#プロジェクトの生成" class="header-anchor">#</a> プロジェクトの生成</h2> <div class="language- extra-class"><pre class="language-text"><code>$ rails new {project_name} --webpack=vue
</code></pre></div><h2 id="vue-jsの参照"><a href="#vue-jsの参照" class="header-anchor">#</a> Vue.jsの参照</h2> <p>Viewのページで, <code>javascript_pack_tag</code>を使用することで,<code>app/javascript/packs</code>以下にあるJSファイルを探す.<br>
インストール時に<code>app/javascript/packs/hello_vue.js</code>というファイルが生成されているので, これを<code>index</code>アクションにて読み込ませる.</p> <h2 id="devサーバの自動コンパイル"><a href="#devサーバの自動コンパイル" class="header-anchor">#</a> devサーバの自動コンパイル</h2> <h3 id="foreman-gemのインストール"><a href="#foreman-gemのインストール" class="header-anchor">#</a> foreman gemのインストール</h3> <p><code>bin/webpack</code>というコマンドでコンパイルされる.</p> <p>毎回のコンパイルが面倒なので, 変更を検出して自動コンパイルする.<br> <a href="https://medium.com/statuscode/introducing-webpacker-7136d66cddfb" target="_blank" rel="noopener noreferrer">Introducing Webpacker<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p><code>foreman</code>のGemをインストールする.<br>
Gemfileファイルに<code>gem 'foreman'</code>を追加して<code>bundle install</code>する.</p> <h3 id="bin-serverとprocfileの追記"><a href="#bin-serverとprocfileの追記" class="header-anchor">#</a> bin/serverとProcfileの追記</h3> <h4 id="bin-server"><a href="#bin-server" class="header-anchor">#</a> bin/server</h4> <p>以下で示すProcfile.devの内容を実行する.</p> <div class="language- extra-class"><pre class="language-text"><code>// bin/server
#! /bin/bash -i
bundle install
bundle exec foreman start -f Procfile.dev
</code></pre></div><div class="custom-block warning"><p><code>$ chmod 777 bin/server</code>を実行しておかないと, <code>bin/server</code>がパーミッションのせいで実行できなくなる可能性がある.</p></div> <h4 id="packfile-dev"><a href="#packfile-dev" class="header-anchor">#</a> Packfile.dev</h4> <p><code>rails s</code>と<code>bin/webpack-dev-server</code>を実行する.<br>
ポート指定のために, <code>-b 0.0.0.0</code>オプションをつける.<br> <a href="https://qiita.com/Tocyuki/items/de66987ead2183e4fcae" target="_blank" rel="noopener noreferrer">RailsでポートとIPアドレスを指定する方法<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>.</p> <div class="language- extra-class"><pre class="language-text"><code>// Procfile.dev
web: bundle exec rails s -b 0.0.0.0
webpacker: ./bin/webpack-dev-server
</code></pre></div><h3 id="実践"><a href="#実践" class="header-anchor">#</a> 実践</h3> <p><code>app/javascript/app.vue</code>のmessageを編集するとすぐにコンパイルされる.</p> <h2 id="apiの準備"><a href="#apiの準備" class="header-anchor">#</a> APIの準備</h2> <h3 id="テーブルとモデルの作成"><a href="#テーブルとモデルの作成" class="header-anchor">#</a> テーブルとモデルの作成</h3> <p>テーブル名は<code>tasks</code>, モデル名は<code>Task</code>とする.</p> <table><thead><tr><th style="text-align:center;">Column Name</th> <th style="text-align:center;">Type</th> <th style="text-align:center;">Options</th></tr></thead> <tbody><tr><td style="text-align:center;">name</td> <td style="text-align:center;">string</td> <td style="text-align:center;">presence: true</td></tr> <tr><td style="text-align:center;">is_done</td> <td style="text-align:center;">boolean</td> <td style="text-align:center;">presence: true, default: false</td></tr> <tr><td style="text-align:center;">created_at</td> <td style="text-align:center;">datetime</td> <td style="text-align:center;">null: false</td></tr> <tr><td style="text-align:center;">updated_at</td> <td style="text-align:center;">datetime</td> <td style="text-align:center;">null: false</td></tr></tbody></table> <p>とりあえず,<br> <code>$ rails g model Task name:string is_done:boolean</code>.</p> <p>その後, <code>options</code>の内容を以下のようにして<code>db/migrate/*.rb</code>に追記.</p> <div class="language- extra-class"><pre class="language-text"><code>// db/migrate/*.rb
class CreateTasks &lt; ActiveRecord::Migration[5.1]
  def change
    create_table :tasks do |t|
      t.string :name    , presence: true
      t.boolean :is_done, default: false, presence: true

      t.timestamps
    end
  end
end

</code></pre></div><p>ついでに, <code>app/models/task.rb</code>に上で定義したvalidatesの内容を追加.</p> <div class="language- extra-class"><pre class="language-text"><code>// app/models/task.rb
class Task &lt; ApplicationRecord
  validates :name, presence: true
end
</code></pre></div><h3 id="apiのルーティングの設定"><a href="#apiのルーティングの設定" class="header-anchor">#</a> APIのルーティングの設定</h3> <p>urlを<code>api/tasks</code>のようにnamespaceを切る.<br>
そうすることで, api用のルーティングが用意できる.<br>
(具体的には, <code>/api/*</code>のようにnamespaceが区切られる)</p> <div class="language- extra-class"><pre class="language-text"><code>// config/routes.rb
Rails.application.routes.draw do
  # For details on the DSL available within this file, see http://guides.rubyonrails.org/routing.html
  root to: 'home#index'
  
  namespace :api, format: 'json' do
    resources :tasks, only: [:index, :create, :update]
  end
end
</code></pre></div><h3 id="コントローラを作成"><a href="#コントローラを作成" class="header-anchor">#</a> コントローラを作成</h3> <p>API用のコントローラを作成する.<br>
controllerの場所は, <code>app/controllers/</code>以下に新しく<code>api</code>というディレクトリを作成する.<br>
名前は慣習的に<code>tasks_controller.rb</code>とする.</p> <p>追加するアクションは3つで, 以下の通り.</p> <table><thead><tr><th style="text-align:center;">Action Name</th> <th style="text-align:center;">REST</th> <th style="text-align:center;">Overview</th></tr></thead> <tbody><tr><td style="text-align:center;">index</td> <td style="text-align:center;">GET /tasks</td> <td style="text-align:center;">更新順の@tasksを返す</td></tr> <tr><td style="text-align:center;">create</td> <td style="text-align:center;">POST /tasks</td> <td style="text-align:center;">新しく@taskを作ってデータベースに保存</td></tr> <tr><td style="text-align:center;">''</td> <td style="text-align:center;">''</td> <td style="text-align:center;">保存できない場合, <code>:unprocessable_entity</code>ステータスの<code>json</code>ファイルをrenderする</td></tr> <tr><td style="text-align:center;">update</td> <td style="text-align:center;">PATCH/PUT /tasks/*</td> <td style="text-align:center;">@taskを更新する</td></tr> <tr><td style="text-align:center;">''</td> <td style="text-align:center;">''</td> <td style="text-align:center;">更新できなかった場合, <code>:unprocessable_entity</code>ステータスの<code>json</code>ファイルをrenderする</td></tr></tbody></table> <p>中身を勝手にいじられないように, <code>private</code>で<code>task_params</code>を定義しておく.</p> <div class="language- extra-class"><pre class="language-text"><code># -*- coding: utf-8 -*-
class Api::TasksController &lt; ApplicationController
 
  # GET /tasks
  def index
    # 後々のために, 更新順で返す
    @tasks = Task.order('updated_at DESC')
  end

  # POST /tasks
  def create
    @task = Task.new(task_params)
    
    if @task.save
      render :show, status :created
    else
      render json: @task.errors, status: :unprocessable_entity
    end
  end

  # PATCH/PUT /tasks/*
  def update
    @task = Task.find(params[:id])
    
    if @task.update(task_params)
      render :show, status: :ok
    else
      render json: @task.errors, status: :unprocessable_entity
    end
  end

  private
  def task_params
    params.fetch(:task, {}).permit(
      :name, :is_done
    )
  end
end
</code></pre></div><h3 id="viewのjsonファイル"><a href="#viewのjsonファイル" class="header-anchor">#</a> ViewのJSONファイル</h3> <p><code>app/views/api/tasks/</code>下に, <code>index</code>と<code>show</code>のための2つのjbuilderファイル(json)を配置.<br>
jbuilderについては, 以下を参照.<br> <a href="https://qiita.com/ryouzi/items/06cb0d4aa7b6527b3645" target="_blank" rel="noopener noreferrer">Railsのjbuilderの書き方と便利なイディオムやメソッド<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <div class="language- extra-class"><pre class="language-text"><code>// app/views/api/tasks/index.json.jbuilder
// `set!`は, `:tasks`という属性をまとめるメソッド
json.set! :tasks do
  // `array!`は, `@tasks`の内容をループで回すメソッド 
  // 返り値は配列になる
  json.array! @tasks do |task|
    // `extract!`は, `task`の中身を指定して返せるメソッド
    // 以下の場合は, `task`の中身を, `:id`, `:name`, ..., `:updated_at`をまとめて返すことになる
    json.extract! task, :id, :name, :is_done, :created_at, :updated_at
  end
end
</code></pre></div><div class="language- extra-class"><pre class="language-text"><code>// app/views/api/tasks/show.json.jbuilder
json.set! :task do
  json.extract! @task, :id, :name, :is_done, :created_at, :updated_at
end
</code></pre></div><h3 id="seeds-rbを作成し-curlコマンドで確認"><a href="#seeds-rbを作成し-curlコマンドで確認" class="header-anchor">#</a> seeds.rbを作成し, curlコマンドで確認</h3> <p>初期値データの作成.<br>
今回は未達成Taskを2つ, 達成済みTaskを1つ作る.
おなじみの<code>seeds.rb</code>を以下のように設定.</p> <div class="language- extra-class"><pre class="language-text"><code>// db/seeds.rb
2.times { Task.create!(name: 'Sample Task') }
1.times { Task.create!(name: 'Done Task', is_done: true) }
</code></pre></div><p>コマンドは<code>$ rails db:seed</code>.<br>
リセットする場合は<code>$ rails db:setup</code></p> <h3 id="curlでgetしてみる"><a href="#curlでgetしてみる" class="header-anchor">#</a> curlでGETしてみる</h3> <p><code>$ curl -X GET 0.0.0.0:5000/api/tasks | jq</code>を叩く.</p> <div class="language- extra-class"><pre class="language-text"><code>{
  &quot;tasks&quot;: [
    {
      &quot;id&quot;: 6,
      &quot;name&quot;: &quot;Done Task&quot;,
      &quot;is_done&quot;: true,
      &quot;created_at&quot;: &quot;2019-01-26T13:54:22.507Z&quot;,
      &quot;updated_at&quot;: &quot;2019-01-26T13:54:22.507Z&quot;
    },
    {
      &quot;id&quot;: 5,
      &quot;name&quot;: &quot;Sample Task&quot;,
      &quot;is_done&quot;: false,
      &quot;created_at&quot;: &quot;2019-01-26T13:54:22.496Z&quot;,
      &quot;updated_at&quot;: &quot;2019-01-26T13:54:22.496Z&quot;
    },
    {
      &quot;id&quot;: 4,
      &quot;name&quot;: &quot;Sample Task&quot;,
      &quot;is_done&quot;: false,
      &quot;created_at&quot;: &quot;2019-01-26T13:54:22.486Z&quot;,
      &quot;updated_at&quot;: &quot;2019-01-26T13:54:22.486Z&quot;
    },
    {
      &quot;id&quot;: 3,
      &quot;name&quot;: &quot;Done Task&quot;,
      &quot;is_done&quot;: true,
      &quot;created_at&quot;: &quot;2019-01-26T13:54:07.951Z&quot;,
      &quot;updated_at&quot;: &quot;2019-01-26T13:54:07.951Z&quot;
    },
    {
      &quot;id&quot;: 2,
      &quot;name&quot;: &quot;Sample Task&quot;,
      &quot;is_done&quot;: false,
      &quot;created_at&quot;: &quot;2019-01-26T13:54:07.939Z&quot;,
      &quot;updated_at&quot;: &quot;2019-01-26T13:54:07.939Z&quot;
    },
    {
      &quot;id&quot;: 1,
      &quot;name&quot;: &quot;Sample Task&quot;,
      &quot;is_done&quot;: false,
      &quot;created_at&quot;: &quot;2019-01-26T13:54:07.929Z&quot;,
      &quot;updated_at&quot;: &quot;2019-01-26T13:54:07.929Z&quot;
    }
  ]
}
</code></pre></div><p>なぜか2倍作成されている...<br>
Why...?</p> <p>あとで検証する. 今は眠いのだ.</p> <h3 id="curlでpostしてみる"><a href="#curlでpostしてみる" class="header-anchor">#</a> curlでPOSTしてみる</h3> <p><code>$ curl -X POST 0.0.0.0:5000/api/tasks -d 'task[hoge]=fuga'</code></p> <p><code>ActionController::InvalidAuthenticityToken</code>が返ってくる.<br>
認証していないのが問題らしい.</p> <h3 id="認証機能の追加"><a href="#認証機能の追加" class="header-anchor">#</a> 認証機能の追加</h3> <p><a href="https://qiita.com/Yarimizu14/items/c81a8cf1859f954b953e" target="_blank" rel="noopener noreferrer">【Rails】RailsでAPIの簡単なトークン認証を実装する<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a><br>
こちらの記事を参考にした.</p> <h2 id="_2019-1-27"><a href="#_2019-1-27" class="header-anchor">#</a> 2019/1/27</h2> <h3 id="認証機能の追加-つづき"><a href="#認証機能の追加-つづき" class="header-anchor">#</a> 認証機能の追加(つづき)</h3> <p>追加するのは, <code>app/controllers/application_controller.rb</code>.<br>
以下のように追加.</p> <div class="language- extra-class"><pre class="language-text"><code>class ApplicationController &lt; ActionController::Base

  include ActionController::HttpAuthentication::Token::ControllerMethods

  before_action :authenticate
  protect_from_forgery with: :exception
  
  protected
  def authenticate
    authenticate_token || render_unauthenticated
  end

  def authenticate_token
    authenticate_with_http_token do |token, options|
      token == 'hoge'
    end
  end
  
  def render_unauthenticated
    # render_errors(:unauthorized, ['invalid token'])
    obj = { message: 'token invalid' }
    render json: obj, status: :unauthorized
  end
  
end

</code></pre></div><p>この後,<br> <code>$ curl -X POST -H 'Content-Type:application/json' -H 'Authorization: Token hoge' 0.0.0.0:5000/api/tasks -d '{ &quot;task&quot;=&gt;{&quot;name&quot;:&quot;fuga&quot;} }'</code><br>
を叩くと,<br> <code>Can't verify CSRF token authenticity</code>と怒られる.<br>
このtokenだとダメなのか?</p> <h2 id="secureな認証付きトークンを用いてpostする"><a href="#secureな認証付きトークンを用いてpostする" class="header-anchor">#</a> secureな認証付きトークンを用いてPOSTする</h2> <p><a href="https://qiita.com/ochiochi/items/966b884eb17045dfb929" target="_blank" rel="noopener noreferrer">Rails5 APIで認証付きのWebAPIを作ってみる<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p>こちらの記事を参考にしてみる.</p> <p>これユーザ認証だ.</p> <p>uhmmmmmmmmmm....</p> <p>後でやります(TODOに投げる)<br>
Do better then perfectなので.</p> <h3 id="最悪の対処法"><a href="#最悪の対処法" class="header-anchor">#</a> 最悪の対処法</h3> <p><code>app/controller/application_controller.rb</code>のCSRF対策のコードをコメントアウト.<br>
許せ...</p> <p><code>$ curl -X POST -H 'Content-Type:application/json' 0.0.0.0:5000/api/tasks | jq</code></p> <div class="language- extra-class"><pre class="language-text"><code>{ &quot;task&quot;:
  {
    &quot;id&quot;: 7,
    &quot;name&quot;: &quot;fuga&quot;,
    &quot;is_done&quot;: false,
    &quot;created_at&quot;: &quot;2019-01-27T01:45:10.207Z&quot;,
    &quot;updated_at&quot;: &quot;2019-01-27T01:45:10.207Z&quot;
  }
}
</code></pre></div><p>おkですね(全くおkではない)<br>
後で認証は実装する.</p> <h2 id="materializeの導入"><a href="#materializeの導入" class="header-anchor">#</a> Materializeの導入</h2> <p>MaterializeというCSSフレームワークを導入する.<br>
Gemを追加して<code>bundle install</code></p> <p>その後, Materializeを適応するために以下の2ファイルを変更.</p> <ul><li>Stylesheetsはセミコロン抜け注意.</li> <li><code>Sprockets::FileNotFound</code>が出たら, Gemfileとかサーバの再起動とかしてみると直る.</li> <li><a href="https://github.com/mkhairi/materialize-sass/tree/v0.100" target="_blank" rel="noopener noreferrer">materialize-sassの公式<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li>カラースキームは<a href="https://materializecss.com/color.html" target="_blank" rel="noopener noreferrer">公式<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>を見て</li></ul> <div class="language- extra-class"><pre class="language-text"><code>// - app/assets/stylesheets/application.css
// + app/assets/stylesheets/application.scss
/* Materialize */

@import &quot;materialize/components/color-variables&quot;;
$primary-color: color(&quot;teal&quot;, &quot;accent-3&quot;) !default;
$secondary-color: color(&quot;cyan&quot;, &quot;base&quot;) !default;
@import 'materialize';
@import 'material_icons';
</code></pre></div><div class="language- extra-class"><pre class="language-text"><code>// app/assets/javascripts/application.js
//= require jquery
//= require jquery.turbolinks
//= require materialize-sprockets
//= require turbolinks
//= require_tree .

</code></pre></div><h2 id="componentsを活用してヘッダを作成"><a href="#componentsを活用してヘッダを作成" class="header-anchor">#</a> Componentsを活用してヘッダを作成</h2> <p>元のファイルは<code>index.html.erb</code>なので, そこの<code>&lt;div id=&quot;app&quot;&gt;</code>にvueの内容がマウントされる.<br> <code>&lt;navbar&gt;</code>の装飾をvueで行う.</p> <p>フォルダ構成は以下の通り.</p> <div class="language- extra-class"><pre class="language-text"><code>/home/vagrant/rails_work/workspace/vue_todo/app/javascript
|--app.vue
|--packs
| |--application.js
| |--components
| | |--header.vue // headerの情報を提供
| |--todo.js // index.html.erbの`&lt;div id=&quot;app&quot;&gt;の部分にマウントされる
</code></pre></div><ul><li><a href="https://github.com/task4233/vue_todo/blob/master/app/javascript/packs/components/header.vue" target="_blank" rel="noopener noreferrer">components/header.vue<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://github.com/task4233/vue_todo/blob/master/app/javascript/packs/todo.js" target="_blank" rel="noopener noreferrer">todo.js<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul> <h2 id="vue-routerを使用する"><a href="#vue-routerを使用する" class="header-anchor">#</a> Vue-Routerを使用する</h2> <p>目的は, Top, About, Contactページの作成.</p> <h3 id="what-s-vue-router"><a href="#what-s-vue-router" class="header-anchor">#</a> What's Vue-Router?</h3> <p><a href="https://router.vuejs.org/ja/" target="_blank" rel="noopener noreferrer">Vue Router<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>
Vue.jsでSPAを作るときに使うルータ.<br>
機能は以下の通り(from 公式)</p> <ul><li>ネストされたルート/ビューマッピング</li> <li>モジュール式、コンポーネントベースのルータ構造</li> <li>ルートパラメータ、クエリ、ワイルドカード</li> <li>Vue.js の transition 機能による、transition エフェクトの表示</li> <li>細かいナビゲーションコントロール</li> <li>自動で付与される active CSS クラス</li> <li>HTML5 history モードまたは hash モードと IE9 の互換性</li> <li>カスタマイズ可能なスクロール動作</li></ul> <p>兎にも角にも実装してみます.</p> <h3 id="vue-routerの追加"><a href="#vue-routerの追加" class="header-anchor">#</a> Vue-Routerの追加</h3> <p><code>$ yarn add vue-router</code><br>
で<code>vue-router</code>を追加</p> <h3 id="componentsの作成"><a href="#componentsの作成" class="header-anchor">#</a> Componentsの作成</h3> <h4 id="index-vue-top"><a href="#index-vue-top" class="header-anchor">#</a> index.vue(Top)</h4> <div class="language- extra-class"><pre class="language-text"><code>// app/javascript/packs/components/index.vue
&lt;template&gt;
  &lt;div&gt;
    &lt;p&gt;Index&lt;/p&gt;
  &lt;/div&gt;
&lt;/template&gt;
</code></pre></div><h4 id="about-vue-about"><a href="#about-vue-about" class="header-anchor">#</a> about.vue(About)</h4> <div class="language- extra-class"><pre class="language-text"><code>// app/javascript/packs/components/about.vue
&lt;template&gt;
  &lt;div&gt;
    &lt;p&gt;
      This is a sample todo application.&lt;br&gt;
      As I wanna practice vue.js, I've made this app.
    &lt;/p&gt;
  &lt;/div&gt;
&lt;/template&gt;
</code></pre></div><h4 id="contact-vue-contact"><a href="#contact-vue-contact" class="header-anchor">#</a> contact.vue(Contact)</h4> <div class="language- extra-class"><pre class="language-text"><code>// app/javascript/packs/components/contact.vue
&lt;template&gt;
  &lt;div&gt;
    &lt;p&gt;
      If you wanna contact me, plz send direct message to below account.&lt;br&gt;
      Twitter: `@task4233`
    &lt;/p&gt;
  &lt;/div&gt;
&lt;/template&gt;
</code></pre></div><h3 id="作成したcomponentsをvue-routerに登録"><a href="#作成したcomponentsをvue-routerに登録" class="header-anchor">#</a> 作成したComponentsをVue-routerに登録</h3> <p>Vue-routerを使用するために, <code>router</code>ディレクトリを作成してそちらに記述.<br> <code>mode: 'history'</code>とすることで, HTMLのhistory APIを使用して, 同じビューないでURLを書き換えられる.<br> <a href="https://router.vuejs.org/ja/guide/essentials/history-mode.html" target="_blank" rel="noopener noreferrer">HTML Historyモード<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p>ただし, not-foundパスが<code>index.html</code>にリダイレクトされるため, 404ページを<code>NotFountComponent</code>とする.</p> <div class="language- extra-class"><pre class="language-text"><code>// app/javascript/packs/router/router.js
import Vue from 'vue/dist/vue.esm.js'
import VueRouter from 'vue-router'
import Index from '../components/index.vue'
import About from '../components/about.vue'
import Contact from '../components/contact.vue'

Vue.use(VueRouter)

export default new VueRouter({
  mode: 'history',
  routes: [
    { path: '/', components: Index },
    { path: '/about', components: About },
    { path: '/contact', components: Contact },
    { path: '*', component: NotFoundComponent }
  ]
})
</code></pre></div><h4 id="vue-routerに応じたタグの修正"><a href="#vue-routerに応じたタグの修正" class="header-anchor">#</a> Vue-Routerに応じたタグの修正</h4> <p>Vue-Routerを使用すると,以下のようなタグが提供される.</p> <table><thead><tr><th style="text-align:center;">Name</th> <th style="text-align:center;">Effect</th></tr></thead> <tbody><tr><td style="text-align:center;"><code>&lt;router-link&gt;</code></td> <td style="text-align:center;"><code>&lt;a&gt;</code>タグとして変換されるが,</td></tr> <tr><td style="text-align:center;">''</td> <td style="text-align:center;">Vue-Routerに登録されたパスからコンポーネントを探す</td></tr> <tr><td style="text-align:center;"><code>&lt;router-view&gt;</code></td> <td style="text-align:center;"><code>&lt;router-link&gt;</code>で見つけたコンポーネントを表示</td></tr></tbody></table> <p>要するに, <code>&lt;a&gt;</code>タグを<code>&lt;router-link&gt;</code>に修正する.</p> <p>その後, <code>app/views/home/index.html.erb</code>に<code>&lt;router-view&gt;&lt;/router-view&gt;</code>を追加.</p> <h2 id="axiosを用いたapi通信-ajax"><a href="#axiosを用いたapi通信-ajax" class="header-anchor">#</a> Axiosを用いたAPI通信(Ajax)</h2> <h3 id="what-s-axios"><a href="#what-s-axios" class="header-anchor">#</a> What's Axios?</h3> <p>Ajax通信ライブラリらしい.<br> <a href="https://github.com/axios/axios" target="_blank" rel="noopener noreferrer">axios<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h3 id="axiosのインストール"><a href="#axiosのインストール" class="header-anchor">#</a> Axiosのインストール</h3> <p><code>$ yarn add axios</code></p> <h3 id="実践-axios"><a href="#実践-axios" class="header-anchor">#</a> 実践(Axios)</h3> <p>checkboxの書き方は, Materialize 1.0.0から変わったので注意.<br>
詳しくは, <a href="https://materializecss.com/checkboxes.html" target="_blank" rel="noopener noreferrer">公式<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>を見よ.</p> <p>また, 一覧を表示するために, JSを書く.<br>
仕組みは, インスタンスにプロパティとして<code>Task</code>(array)と, <code>newTask</code>(string)を与え, メソッドでAPIで取得してきた値をループさせて<code>tasks</code>に格納するというもの.</p> <ul><li><code>method</code>は, Vueインスタンスがマウントされたタイミングで実行されるライフサイクルフック(詳しくは, <a href="https://jp.vuejs.org/v2/guide/instance.html#%E3%83%A9%E3%82%A4%E3%83%95%E3%82%B5%E3%82%A4%E3%82%AF%E3%83%AB%E3%83%80%E3%82%A4%E3%82%A2%E3%82%B0%E3%83%A9%E3%83%A0" target="_blank" rel="noopener noreferrer">ライフサイクルダイアグラム<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>をみるとよい)</li> <li>一覧表示は, <a href="https://jp.vuejs.org/v2/api/#v-for" target="_blank" rel="noopener noreferrer"><code>v-for</code><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>と<a href="https://jp.vuejs.org/v2/api/#v-if" target="_blank" rel="noopener noreferrer"><code>v-if</code><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>を使ってやればよい(汚くなるけども, まぁ動くので)</li> <li>v-bindで置換</li> <li>単一コンポーネントにするので, コンパイル時にCSSを出さないようにする</li> <li>具体的には, <code>config/webpack/environment.js</code>で<code>environment.loaders.get('vue').options.extractCSS=false</code>とすれば良い</li> <li>accomplished tasksは基本的に非表示, 必要な時に表示すればおk.</li> <li>ボタンが押されたとき(<a href="https://jp.vuejs.org/v2/api/#v-on" target="_blank" rel="noopener noreferrer"><code>v-on</code><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>)に表示すればおk.</li></ul> <h3 id="新規作成フォームの作成"><a href="#新規作成フォームの作成" class="header-anchor">#</a> 新規作成フォームの作成</h3> <p>双方向バインディングが可能な<a href="https://jp.vuejs.org/v2/api/#v-model" target="_blank" rel="noopener noreferrer"><code>v-model</code><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>を用いる.<br> <code>&lt;input&gt;</code>タグで入力された値と, インスタンスの<a href="#%E5%AE%9F%E8%B7%B5-axios"><code>newTask</code>プロパティ</a>とをバインドさせる.</p> <div class="custom-block tip"><p>基本的には, <code>script</code>の<code>method</code>を定義して, イベントに対してそれを呼び出すという様式になっている様子.<br>
JSと同じ.</p></div></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">Last Updated: </span> <span class="time">9ヶ月前</span></div></footer> <!----> </main></div><div class="global-ui"><!----><!----></div></div>
    <script src="/assets/js/app.742f0a32.js" defer></script><script src="/assets/js/2.b8499f1b.js" defer></script><script src="/assets/js/85.817aa786.js" defer></script><script src="/assets/js/3.31e57b96.js" defer></script>
  </body>
</html>
