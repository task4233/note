<!DOCTYPE html>
<html lang="ja">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>ISUCONæœ¬ã®ãƒ¡ãƒ¢ | Note</title>
    <meta name="generator" content="VuePress 1.9.7">
    <link rel="icon" href="/imgs/icons/icon.png">
    <link rel="manifest" href="/manifest.json">
    <link rel="shortcut icon" href="/imgs/icons/favicon.ico">
    <meta name="description" content="ISUCONæœ¬ã®ãƒ¡ãƒ¢">
    <meta name="theme-color" content="#3eaf7c">
    
    <link rel="preload" href="/assets/css/0.styles.e16f9711.css" as="style"><link rel="preload" href="/assets/js/app.743ef69c.js" as="script"><link rel="preload" href="/assets/js/2.8c86708f.js" as="script"><link rel="preload" href="/assets/js/3.693800c4.js" as="script"><link rel="preload" href="/assets/js/44.cbe6deb9.js" as="script"><link rel="preload" href="/assets/js/4.cc429872.js" as="script"><link rel="prefetch" href="/assets/js/10.1831c564.js"><link rel="prefetch" href="/assets/js/11.e3cb858e.js"><link rel="prefetch" href="/assets/js/12.f691f405.js"><link rel="prefetch" href="/assets/js/13.e122abd7.js"><link rel="prefetch" href="/assets/js/14.bdabc596.js"><link rel="prefetch" href="/assets/js/15.3695a197.js"><link rel="prefetch" href="/assets/js/16.867ed167.js"><link rel="prefetch" href="/assets/js/17.9bd06323.js"><link rel="prefetch" href="/assets/js/18.4a5f8151.js"><link rel="prefetch" href="/assets/js/19.ded22c6d.js"><link rel="prefetch" href="/assets/js/20.29a3d5f9.js"><link rel="prefetch" href="/assets/js/21.c3aab69d.js"><link rel="prefetch" href="/assets/js/22.f19c35dc.js"><link rel="prefetch" href="/assets/js/23.58111946.js"><link rel="prefetch" href="/assets/js/24.71f4337e.js"><link rel="prefetch" href="/assets/js/25.9643d58f.js"><link rel="prefetch" href="/assets/js/26.18166fa0.js"><link rel="prefetch" href="/assets/js/27.e0c3d18b.js"><link rel="prefetch" href="/assets/js/28.54309732.js"><link rel="prefetch" href="/assets/js/29.8c3c77ec.js"><link rel="prefetch" href="/assets/js/30.eafc7451.js"><link rel="prefetch" href="/assets/js/31.cf50a740.js"><link rel="prefetch" href="/assets/js/32.de0580cd.js"><link rel="prefetch" href="/assets/js/33.9a4cb3ea.js"><link rel="prefetch" href="/assets/js/34.762a7aa9.js"><link rel="prefetch" href="/assets/js/35.797be974.js"><link rel="prefetch" href="/assets/js/36.47b6758d.js"><link rel="prefetch" href="/assets/js/37.eb6f6642.js"><link rel="prefetch" href="/assets/js/38.e780ee89.js"><link rel="prefetch" href="/assets/js/39.67063473.js"><link rel="prefetch" href="/assets/js/40.0c6c5764.js"><link rel="prefetch" href="/assets/js/41.1926a20f.js"><link rel="prefetch" href="/assets/js/42.f4f3ac7c.js"><link rel="prefetch" href="/assets/js/43.35d22cd8.js"><link rel="prefetch" href="/assets/js/45.f0551247.js"><link rel="prefetch" href="/assets/js/46.6dac12cb.js"><link rel="prefetch" href="/assets/js/47.5bc92527.js"><link rel="prefetch" href="/assets/js/48.2818f26e.js"><link rel="prefetch" href="/assets/js/49.b44c0060.js"><link rel="prefetch" href="/assets/js/5.a7b3795e.js"><link rel="prefetch" href="/assets/js/50.b5d1c090.js"><link rel="prefetch" href="/assets/js/51.bee0f371.js"><link rel="prefetch" href="/assets/js/52.862ad608.js"><link rel="prefetch" href="/assets/js/53.b897ea6f.js"><link rel="prefetch" href="/assets/js/54.e9b8553f.js"><link rel="prefetch" href="/assets/js/55.6d4c045b.js"><link rel="prefetch" href="/assets/js/56.4e40079d.js"><link rel="prefetch" href="/assets/js/57.0b43069c.js"><link rel="prefetch" href="/assets/js/58.a5d5286a.js"><link rel="prefetch" href="/assets/js/59.ab2ee1c1.js"><link rel="prefetch" href="/assets/js/6.7dcfc0df.js"><link rel="prefetch" href="/assets/js/60.442c6d22.js"><link rel="prefetch" href="/assets/js/61.0c16498f.js"><link rel="prefetch" href="/assets/js/62.07751717.js"><link rel="prefetch" href="/assets/js/63.dbaec0a5.js"><link rel="prefetch" href="/assets/js/64.5fc1b4f7.js"><link rel="prefetch" href="/assets/js/65.770f12f0.js"><link rel="prefetch" href="/assets/js/66.44223adc.js"><link rel="prefetch" href="/assets/js/67.0d43fb9d.js"><link rel="prefetch" href="/assets/js/68.53f059eb.js"><link rel="prefetch" href="/assets/js/69.5c775b20.js"><link rel="prefetch" href="/assets/js/7.c819681e.js"><link rel="prefetch" href="/assets/js/70.fad264db.js"><link rel="prefetch" href="/assets/js/71.c9bce44e.js"><link rel="prefetch" href="/assets/js/72.04a5e8d2.js"><link rel="prefetch" href="/assets/js/73.cb23c684.js"><link rel="prefetch" href="/assets/js/74.cc7436cf.js"><link rel="prefetch" href="/assets/js/75.80e4afd7.js"><link rel="prefetch" href="/assets/js/76.73de9d33.js"><link rel="prefetch" href="/assets/js/77.a6782b30.js"><link rel="prefetch" href="/assets/js/78.df1a2f88.js"><link rel="prefetch" href="/assets/js/79.35ed3b0a.js"><link rel="prefetch" href="/assets/js/8.8fb78f1d.js"><link rel="prefetch" href="/assets/js/80.40ceedcb.js"><link rel="prefetch" href="/assets/js/81.3157359e.js"><link rel="prefetch" href="/assets/js/82.9c0946ef.js"><link rel="prefetch" href="/assets/js/83.8751f0bf.js"><link rel="prefetch" href="/assets/js/84.be1a9ef9.js"><link rel="prefetch" href="/assets/js/85.19d7fbcd.js"><link rel="prefetch" href="/assets/js/86.05e80afb.js"><link rel="prefetch" href="/assets/js/87.9bf27c8f.js"><link rel="prefetch" href="/assets/js/88.51f8cda4.js"><link rel="prefetch" href="/assets/js/89.6bf98237.js"><link rel="prefetch" href="/assets/js/9.2941a322.js"><link rel="prefetch" href="/assets/js/90.279f66f1.js">
    <link rel="stylesheet" href="/assets/css/0.styles.e16f9711.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">Note</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/#links" class="nav-link">Links</a></div><div class="nav-item"><a href="/tags/" class="nav-link">Articles</a></div><div class="nav-item"><a href="/chukapi_fun_art.html" class="nav-link">Chukapi-Fun-Art</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/#links" class="nav-link">Links</a></div><div class="nav-item"><a href="/tags/" class="nav-link">Articles</a></div><div class="nav-item"><a href="/chukapi_fun_art.html" class="nav-link">Chukapi-Fun-Art</a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>ISUCONæœ¬ã®ãƒ¡ãƒ¢</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/article/20220613_isucon_book.html#references" class="sidebar-link">References</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/article/20220613_isucon_book.html#_1ç« -ãƒãƒ¥ãƒ¼ãƒ‹ãƒ³ã‚¯ã‚™ã®åŸºç¤çŸ¥è­˜" class="sidebar-link">1ç«  ãƒãƒ¥ãƒ¼ãƒ‹ãƒ³ã‚°ã®åŸºç¤çŸ¥è­˜</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/article/20220613_isucon_book.html#ãƒã‚šãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãƒãƒ¥ãƒ¼ãƒ‹ãƒ³ã‚¯ã‚™ã®åŸºæœ¬ã®ã" class="sidebar-link">ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãƒãƒ¥ãƒ¼ãƒ‹ãƒ³ã‚°ã®åŸºæœ¬ã®ã</a></li><li class="sidebar-sub-header"><a href="/article/20220613_isucon_book.html#ãƒã‚šãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãƒãƒ¥ãƒ¼ãƒ‹ãƒ³ã‚¯ã‚™ã®åŸºæœ¬ã®ã»" class="sidebar-link">ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãƒãƒ¥ãƒ¼ãƒ‹ãƒ³ã‚°ã®åŸºæœ¬ã®ã»</a></li><li class="sidebar-sub-header"><a href="/article/20220613_isucon_book.html#ãƒã‚šãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãƒãƒ¥ãƒ¼ãƒ‹ãƒ³ã‚¯ã‚™ã®åŸºæœ¬ã®ã‚“" class="sidebar-link">ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãƒãƒ¥ãƒ¼ãƒ‹ãƒ³ã‚°ã®åŸºæœ¬ã®ã‚“</a></li></ul></li><li><a href="/article/20220613_isucon_book.html#_2ç« -ãƒ¢ãƒ‹ã‚¿ãƒªãƒ³ã‚¯ã‚™" class="sidebar-link">2ç«  ãƒ¢ãƒ‹ã‚¿ãƒªãƒ³ã‚°</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/article/20220613_isucon_book.html#_3-åŸºç¤çš„ãªè² è·è©¦é¨“" class="sidebar-link">3. åŸºç¤çš„ãªè² è·è©¦é¨“</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/article/20220613_isucon_book.html#_4-ã‚·ãƒŠãƒªã‚ªã‚’æŒã£ãŸè² è·è©¦é¨“" class="sidebar-link">4. ã‚·ãƒŠãƒªã‚ªã‚’æŒã£ãŸè² è·è©¦é¨“</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/article/20220613_isucon_book.html#_5-ãƒ†ã‚™ãƒ¼ã‚¿ãƒ˜ã‚™ãƒ¼ã‚¹ã®ãƒãƒ¥ãƒ¼ãƒ‹ãƒ³ã‚¯ã‚™" class="sidebar-link">5. ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã®ãƒãƒ¥ãƒ¼ãƒ‹ãƒ³ã‚°</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/article/20220613_isucon_book.html#_6-ãƒªãƒã‚™ãƒ¼ã‚¹ãƒ•ã‚šãƒ­ã‚­ã‚·ã®åˆ©ç”¨" class="sidebar-link">6. ãƒªãƒãƒ¼ã‚¹ãƒ—ãƒ­ã‚­ã‚·ã®åˆ©ç”¨</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/article/20220613_isucon_book.html#_7-ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã®æ´»ç”¨" class="sidebar-link">7. ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã®æ´»ç”¨</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/article/20220613_isucon_book.html#_8-æŠ¼ã•ãˆã¦ãŠããŸã„é«˜é€ŸåŒ–æ‰‹æ³•" class="sidebar-link">8. æŠ¼ã•ãˆã¦ãŠããŸã„é«˜é€ŸåŒ–æ‰‹æ³•</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/article/20220613_isucon_book.html#_9-osã®åŸºç¤çŸ¥è­˜ã¨ãƒãƒ¥ãƒ¼ãƒ‹ãƒ³ã‚¯ã‚™" class="sidebar-link">9. OSã®åŸºç¤çŸ¥è­˜ã¨ãƒãƒ¥ãƒ¼ãƒ‹ãƒ³ã‚°</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/article/20220613_isucon_book.html#private-isuã®æ”»ç•¥" class="sidebar-link">private-isuã®æ”»ç•¥</a><ul class="sidebar-sub-headers"></ul></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="isuconæœ¬ã®ãƒ¡ãƒ¢"><a href="#isuconæœ¬ã®ãƒ¡ãƒ¢" class="header-anchor">#</a> ISUCONæœ¬ã®ãƒ¡ãƒ¢</h1> <p>ğŸ’¡
ã“ã‚Œã¯ISUCONæœ¬ã‚’èª­ã‚“ã æ™‚ã«æ€ã£ãŸã“ã¨ã‚„æ–°ã—ãçŸ¥ã£ãŸã“ã¨ã‚’è¨€è‘‰ã«èµ·ã“ã™ãŸã‚ã«ä½¿ã†ãƒ¡ãƒ¢ã§ã™ã€‚é›‘å¤šã«æ›¸ãã¾ã™ã€‚</p> <h2 id="references"><a href="#references" class="header-anchor">#</a> References</h2> <ul><li>è—¤åŸ et al., &quot;é”äººãŒæ•™ãˆã‚‹Webãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãƒãƒ¥ãƒ¼ãƒ‹ãƒ³ã‚°ã€œISUCONã‹ã‚‰å­¦ã¶é«˜é€ŸåŒ–ã®å®Ÿè·µ&quot;, 2022, ISBN 978-4-297-12846-3.</li> <li><a href="https://github.com/task4233/private-isu" target="_blank" rel="noopener noreferrer">GitHub<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://gist.github.com/south37/d4a5a8158f49e067237c17d13ecab12a" target="_blank" rel="noopener noreferrer">ISUCON Cheat Sheet<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul> <h2 id="_1ç« -ãƒãƒ¥ãƒ¼ãƒ‹ãƒ³ã‚¯ã‚™ã®åŸºç¤çŸ¥è­˜"><a href="#_1ç« -ãƒãƒ¥ãƒ¼ãƒ‹ãƒ³ã‚¯ã‚™ã®åŸºç¤çŸ¥è­˜" class="header-anchor">#</a> 1ç«  ãƒãƒ¥ãƒ¼ãƒ‹ãƒ³ã‚°ã®åŸºç¤çŸ¥è­˜</h2> <ul><li>å‚ç›´ã‚¹ã‚±ãƒ¼ãƒªãƒ³ã‚°(ã‚¹ã‚±ãƒ¼ãƒ«ã‚¢ãƒƒãƒ—/ãƒ€ã‚¦ãƒ³)
<ul><li>ã‚µãƒ¼ãƒã®æ€§èƒ½ã‚’å‘ä¸Š/ä½ä¸‹ã•ã›ã‚‹ã“ã¨</li></ul></li> <li>æ°´å¹³ã‚¹ã‚±ãƒ¼ãƒªãƒ³ã‚°(ã‚¹ã‚±ãƒ¼ãƒ«ã‚¢ã‚¦ãƒˆ/ã‚¤ãƒ³)
<ul><li>ã‚µãƒ¼ãƒã®æ•°ã‚’å¢—åŠ /æ¸›å°‘ã•ã›ã‚‹ã“ã¨</li></ul></li></ul> <h3 id="ãƒã‚šãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãƒãƒ¥ãƒ¼ãƒ‹ãƒ³ã‚¯ã‚™ã®åŸºæœ¬ã®ã"><a href="#ãƒã‚šãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãƒãƒ¥ãƒ¼ãƒ‹ãƒ³ã‚¯ã‚™ã®åŸºæœ¬ã®ã" class="header-anchor">#</a> <strong>ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãƒãƒ¥ãƒ¼ãƒ‹ãƒ³ã‚°ã®åŸºæœ¬ã®ã</strong></h3> <ul><li><p><strong>ã„ããªã‚Šæ‰‹ã‚’å‹•ã‹ã•ãªã„</strong></p></li> <li><p><strong>å‹˜ã§è¡Œå‹•ã—ãªã„</strong></p></li> <li><p><strong>ã€ŒåŸºæœ¬ã®ãã€ã‹ã‚‰ã€ŒåŸºæœ¬ã®ã‚“ã€ã¾ã§èª­ã‚“ã§ã‹ã‚‰ã€è€ƒãˆã¦ã€è¡Œå‹•ã™ã‚‹</strong></p></li> <li><p>æ¨æ¸¬ã›ãšè¨ˆæ¸¬ã™ã‚‹</p> <ul><li>æŒ‡æ¨™
<ul><li>ã‚·ã‚¹ãƒ†ãƒ ãƒªã‚½ãƒ¼ã‚¹åˆ©ç”¨çŠ¶æ³</li> <li>ãƒ¬ã‚¤ãƒ†ãƒ³ã‚·</li> <li>ã‚¹ãƒ«ãƒ¼ãƒ—ãƒƒãƒˆ</li></ul></li> <li>è² è·è©¦é¨“ã‚’ã™ã‚‹éš›ã«ã€ä¸è² è·å´ã®ã‚·ã‚¹ãƒ†ãƒ ã®ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ä¸è¶³ãŒå¾‹é€ŸåŸå› ã«ãªã‚‹ã“ã¨ãŒã‚ã‚‹</li></ul></li> <li><p>å…¬å¹³ã«æ¯”è¼ƒã™ã‚‹</p> <ul><li>ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã®å›ç·šãŒåŸå› ã§ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãŒä½ä¸‹ã™ã‚‹ã“ã¨ã‚‚ã‚ã‚‹</li></ul></li> <li><p>1ã¤ãšã¤æ¯”è¼ƒã™ã‚‹</p> <ul><li>ã¾ã¨ã‚ã¦æ–½ç­–ã‚’é©ç”¨ã™ã‚‹ã¨ã€ã©ã®æ–½ç­–ãŒåˆºã•ã£ãŸã®ã‹ãŒåˆ†ã‹ã‚‰ãªããªã‚‹</li> <li>PRã¯1ã¤ãšã¤ãƒãƒ¼ã‚¸ã—ã¦æŒ‡æ¨™ã‚’å–ã‚‹</li></ul></li></ul> <h3 id="ãƒã‚šãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãƒãƒ¥ãƒ¼ãƒ‹ãƒ³ã‚¯ã‚™ã®åŸºæœ¬ã®ã»"><a href="#ãƒã‚šãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãƒãƒ¥ãƒ¼ãƒ‹ãƒ³ã‚¯ã‚™ã®åŸºæœ¬ã®ã»" class="header-anchor">#</a> ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãƒãƒ¥ãƒ¼ãƒ‹ãƒ³ã‚°ã®åŸºæœ¬ã®ã»</h3> <ul><li><p><strong>ãƒœãƒˆãƒ«ãƒãƒƒã‚¯ã ã‘ã«ã‚¢ãƒ—ãƒ­ãƒ¼ãƒã™ã‚‹</strong></p> <ul><li>ãƒ¬ã‚¸ãŒæ··ã‚“ã§ã„ã‚‹ã®ã«ã€å…¥ã‚Šå£ã¨åº—å†…ã‚’åºƒãã—ã¦ã‚‚æ™‚é–“å½“ãŸã‚Šã®å£²ã‚Šä¸Šã’ã¯ä¸ŠãŒã‚‰ãªã„</li> <li>æœ€æ‚ªã€ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãŒè½ã¡ã‚‹</li></ul></li> <li><p><strong>ãƒœãƒˆãƒ«ãƒãƒƒã‚¯ã®ç‰¹å®šã¯å¤–å´ã‹ã‚‰é †ç•ªã«</strong></p> <ul><li>Webã‚µãƒ¼ãƒ“ã‚¹ã«ãŠã‘ã‚‹å…¥å‡ºåŠ›ã®ä¸€ç•ªå¤–å´ã‹ã‚‰è¦‹ã‚‹
<ul><li>æ‰€è¦æ™‚é–“ãŒé•·ã„ç®‡æ‰€</li> <li>ã‚·ã‚¹ãƒ†ãƒ ãƒªã‚½ãƒ¼ã‚¹ã®åˆ©ç”¨ç‡ãŒé«˜ã„ç®‡æ‰€</li></ul></li> <li>ãƒœãƒˆãƒ«ãƒãƒƒã‚¯ã«ãªã‚ŠãŒã¡ãªç®‡æ‰€
<ul><li>CPU</li> <li>ãƒ¡ãƒ¢ãƒª</li> <li>ãƒ‡ã‚£ã‚¹ã‚¯I/O</li> <li>ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯I/O</li></ul></li></ul></li> <li><p><strong>ãƒœãƒˆãƒ«ãƒãƒƒã‚¯å¯¾å‡¦ã®åŸºæœ¬3ãƒ‘ã‚¿ãƒ¼ãƒ³</strong></p> <ol><li><p>è§£æ±º</p> <p>èª²é¡Œã«ãªã£ã¦ã„ã‚‹äº‹è±¡ã‚’æ ¹æœ¬ã‹ã‚‰è§£æ±ºã™ã‚‹</p></li> <li><p>å›é¿</p> <p>èª²é¡Œã«ãªã£ã¦ã„ã‚‹äº‹è±¡ãŒãƒœãƒˆãƒ«ãƒãƒƒã‚¯ã«ãªã‚‰ãªã„ã‚ˆã†ã«è¿‚å›ãƒ»çœç•¥ã™ã‚‹</p></li> <li><p>ç·©å’Œ</p> <p>èª²é¡Œã«ãªã£ã¦ã„ã‚‹äº‹è±¡ã®å½±éŸ¿ã‚’å’Œã‚‰ã’ã‚‹</p></li></ol> <ul><li>å¯¾å¿œã‚³ã‚¹ãƒˆã¯å›é¿ &lt; ç·©å’Œ</li></ul></li></ul> <h3 id="ãƒã‚šãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãƒãƒ¥ãƒ¼ãƒ‹ãƒ³ã‚¯ã‚™ã®åŸºæœ¬ã®ã‚“"><a href="#ãƒã‚šãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãƒãƒ¥ãƒ¼ãƒ‹ãƒ³ã‚¯ã‚™ã®åŸºæœ¬ã®ã‚“" class="header-anchor">#</a> ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãƒãƒ¥ãƒ¼ãƒ‹ãƒ³ã‚°ã®åŸºæœ¬ã®ã‚“</h3> <ul><li>é«˜é€ŸåŒ–ã®å…·ä½“çš„ãªæ´»å‹•
<ol><li>è² è·è©¦é¨“è¨ˆç”»</li> <li>å®Ÿæ–½æº–å‚™</li> <li>è² è·è©¦è¡Œâ†’çµæœç¢ºèªâ†’æ”¹å–„â†’è² è·è©¦è¡Œâ†’â€¦</li></ol></li> <li>è² è·è©¦é¨“ã®è¨ˆç”»(é …ç›®ã¯P19)
<ul><li><strong>å¿…ãšå®šã‚ã¦ï¼ï¼ï¼</strong></li> <li><strong>ä½•ã®ãŸã‚ã«(ç›®çš„)ï¼Ÿ</strong></li> <li><strong>ã©ã®ã‚ˆã†ã«(æ–¹æ³•)ï¼Ÿ</strong></li> <li><strong>ã©ã®ç¨‹åº¦ã¾ã§(ã‚´ãƒ¼ãƒ«)ï¼Ÿ</strong></li></ul></li> <li>è¢«è² è·ç’°å¢ƒã®æº–å‚™
<ul><li>è² è·ã‚’ã‹ã‘ãªãŒã‚‰æ‰‹å‹•ã§ä½¿ç”¨æ„Ÿã‚’ç¢ºã‹ã‚ã‚‹ã®ã‚‚ã‚¢ãƒª</li> <li>å®Ÿæ–½æ™‚é–“ãƒ»å®Ÿæ–½çµæœãƒ»ãƒ¡ãƒˆãƒªã‚¯ã‚¹ãƒ»ãƒ­ã‚°ã‚’ã‚»ãƒƒãƒˆã§è‡ªå‹•ã§è¨˜éŒ²ã—ã¦ãŠãã¨è‰¯ã„
<ul><li>ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã®æ—¥æ™‚æŒ‡å®šæ©Ÿèƒ½ã§URLã‚’ç”Ÿæˆã™ã‚‹</li> <li>Slack/Discordã«Postã™ã‚‹ã‚ˆã†ã«ã—ã¦ãŠã</li></ul></li> <li>å®Ÿæ–½çµæœã‚’éƒ½åº¦è§£é‡ˆã™ã‚‹
<ul><li>ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹: Xä¸¦åˆ—ã§Yãƒ¦ãƒ¼ã‚¶ãŒNåˆ†é–“ã§æ“ä½œå®Œäº†</li> <li>ç•°å¸¸ã®æœ‰ç„¡: ã‚¨ãƒ©ãƒ¼ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã€ã‚·ã‚¹ãƒ†ãƒ ã‚¨ãƒ©ãƒ¼ã€ä¸å¯©ãªæŒ™å‹•ã€ä¸å®‰å®šãªãƒ¬ã‚¹ãƒãƒ³ã‚¹ã‚¿ã‚¤ãƒ </li> <li>ãƒœãƒˆãƒ«ãƒãƒƒã‚¯ã®ç§»å‹•æœ‰ç„¡</li> <li>ãã‚Œãã‚Œã®å€¤ã€ãƒªã‚½ãƒ¼ã‚¹ãƒ¡ãƒˆãƒªã‚¯ã‚¹ã®å€¤ãŒæƒ³å®šé€šã‚Šå¤‰åŒ–ã—ãŸã‹</li></ul></li></ul></li></ul> <h2 id="_2ç« -ãƒ¢ãƒ‹ã‚¿ãƒªãƒ³ã‚¯ã‚™"><a href="#_2ç« -ãƒ¢ãƒ‹ã‚¿ãƒªãƒ³ã‚¯ã‚™" class="header-anchor">#</a> 2ç«  ãƒ¢ãƒ‹ã‚¿ãƒªãƒ³ã‚°</h2> <ul><li><p>å¤–å½¢ç›£è¦–</p> <ul><li>Webã‚µãƒ¼ãƒ“ã‚¹ã®å¤–ã‹ã‚‰ãƒ¢ãƒ‹ã‚¿ãƒªãƒ³ã‚°ã™ã‚‹æ‰‹æ³•</li> <li>ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯çš„ãªæ¥ç¶šãƒˆãƒ©ãƒ–ãƒ«ã®ç™ºè¦‹ã«æœ‰åŠ¹ã ãŒã€å®Œå…¨ãªå†ç¾ã¯ç¾å®Ÿçš„ã§ã¯ãªã„</li></ul></li> <li><p>å†…éƒ¨ç›£è¦–</p> <ul><li>Webã‚µãƒ¼ãƒ“ã‚¹ã®ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®å†…å´ã‹ã‚‰ãƒ¢ãƒ‹ã‚¿ãƒªãƒ³ã‚°ã™ã‚‹æ‰‹æ³•</li> <li>å¤–éƒ¨ãƒ¦ãƒ¼ã‚¶ãŒè¦‹ã‚Œãªã„ã€ãƒªã‚½ãƒ¼ã‚¹ã®ãƒ¡ãƒˆãƒªã‚¯ã‚¹ç­‰ã‚’ç›£è¦–ã§ãã‚‹</li> <li>pullå‹(Prometheus)
<ul><li>ãƒ¢ãƒ‹ã‚¿ãƒªãƒ³ã‚°ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³(ä»¥ä¸‹MA)ãŒå„ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã‹ã‚‰ãƒ¡ãƒˆãƒªã‚¯ã‚¹ã‚’pullã—ã¦ãã‚‹</li> <li>ãƒ¡ãƒªãƒƒãƒˆ
<ul><li>MAå´ã§å–å¾—é–“éš”ã‚’ç®¡ç†ã§ãã‚‹</li> <li>ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã®å®Ÿè£…ã‚’ã‚·ãƒ³ãƒ—ãƒ«ã«ã§ãã‚‹</li></ul></li></ul></li> <li>pushå‹
<ul><li>å„ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆãŒãƒ¢ãƒ‹ã‚¿ãƒªãƒ³ã‚°ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã«å¯¾ã—ã¦ãƒ¡ãƒˆãƒªã‚¯ã‚¹ã‚’pushã™ã‚‹</li> <li>ãƒ¡ãƒªãƒƒãƒˆ
<ul><li>ã‚µãƒ¼ãƒå´ã®ãƒãƒ¼ãƒˆã‚’é–‹ã‘ãšã«æ¸ˆã‚€</li> <li>ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã®ç®¡ç†ã‚’ã›ãšã«æ¸ˆã‚€</li></ul></li></ul></li></ul></li> <li><p>ä½¿ãˆã‚‹ã‚³ãƒãƒ³ãƒ‰</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token builtin class-name">:</span> ãƒãƒ«ãƒã‚³ã‚¢CPUä½¿ç”¨ç‡ã®åé›†
mpstat -P ALL

<span class="token builtin class-name">:</span> ãƒ¡ãƒ¢ãƒªä½¿ç”¨ç‡ä¸Šä½5ä»¶ã®ãƒ—ãƒ­ã‚»ã‚¹ã®åé›†
<span class="token function">ps</span> aux --sort -%mem <span class="token operator">|</span> <span class="token function">head</span> -5

<span class="token builtin class-name">:</span> ãƒ¡ãƒ¢ãƒªä½¿ç”¨ç‡ã®åé›†
<span class="token function">free</span> -m
</code></pre></div></li> <li><p>å‰²åˆ(%)ã®å¤‰å‹•å…·åˆã‚’æ¯”è¼ƒã—ãªã„ã“ã¨</p> <ul><li>15%å¢—ã¨10%å¢—ã¯ã€ãã‚‚ãã‚‚ãƒ™ãƒ¼ã‚¹ãƒ©ã‚¤ãƒ³ãŒç•°ãªã‚‹å¯èƒ½æ€§ãŒã‚ã‚‹ã®ã§æ¯”è¼ƒã—ã¦ã‚‚æ„å‘³ãŒãªã„</li></ul></li> <li><p>åŒã˜ã‚µãƒ¼ãƒå†…ã‹ã‚‰è² è·è©¦é¨“ã‚’è¡Œã‚ãªã„ã“ã¨</p> <ul><li>æ¤œè¨¼å¯¾è±¡ã®ãƒªã‚½ãƒ¼ã‚¹ã‚’ä½¿ã†ã®ã§ã€ãã‚Œã¯ãã†</li></ul></li></ul> <h2 id="_3-åŸºç¤çš„ãªè² è·è©¦é¨“"><a href="#_3-åŸºç¤çš„ãªè² è·è©¦é¨“" class="header-anchor">#</a> 3. åŸºç¤çš„ãªè² è·è©¦é¨“</h2> <ul><li>alp</li></ul> <div class="language-bash extra-class"><pre class="language-bash"><code>alp json --file access.log
</code></pre></div><ul><li><p>ab</p></li> <li><p>abã¨alpã®æ¯”è¼ƒ</p> <p>abã® <code>Time per request</code> ã¨alpã® <code>avg</code> ãŒåŒã˜ãã‚‰ã„ã«ãªã£ã¦ã„ã‚‹ã“ã¨ã‚’ç¢ºèªã™ã‚‹</p> <p>abã®çµæœ</p> <div class="language-bash extra-class"><pre class="language-bash"><code>% ab -c <span class="token number">1</span> -n <span class="token number">10</span> http://localhost/                                                                                                                                      <span class="token punctuation">[</span>~/work/private-isu/webapp<span class="token punctuation">]</span>+<span class="token punctuation">[</span>master<span class="token punctuation">]</span>
This is ApacheBench, Version <span class="token number">2.3</span> <span class="token operator">&lt;</span><span class="token variable">$Revision</span><span class="token builtin class-name">:</span> <span class="token number">1879490</span> $<span class="token operator">&gt;</span>
Copyright <span class="token number">1996</span> Adam Twiss, Zeus Technology Ltd, http://www.zeustech.net/
Licensed to The Apache Software Foundation, http://www.apache.org/

Benchmarking localhost <span class="token punctuation">(</span>be patient<span class="token punctuation">)</span><span class="token punctuation">..</span><span class="token punctuation">..</span>.done

Server Software:        nginx/1.22.0
Server Hostname:        localhost
Server Port:            <span class="token number">80</span>

Document Path:          /
Document Length:        <span class="token number">35054</span> bytes

Concurrency Level:      <span class="token number">1</span>
Time taken <span class="token keyword">for</span> tests:   <span class="token number">23.625</span> seconds
Complete requests:      <span class="token number">10</span>
Failed requests:        <span class="token number">0</span>
Total transferred:      <span class="token number">354170</span> bytes
HTML transferred:       <span class="token number">350540</span> bytes
Requests per second:    <span class="token number">0.42</span> <span class="token punctuation">[</span><span class="token comment">#/sec] (mean)</span>
**Time per request:       <span class="token number">2362.545</span> <span class="token punctuation">[</span>ms<span class="token punctuation">]</span> <span class="token punctuation">(</span>mean<span class="token punctuation">)</span>**
Time per request:       <span class="token number">2362.545</span> <span class="token punctuation">[</span>ms<span class="token punctuation">]</span> <span class="token punctuation">(</span>mean, across all concurrent requests<span class="token punctuation">)</span>
Transfer rate:          <span class="token number">14.64</span> <span class="token punctuation">[</span>Kbytes/sec<span class="token punctuation">]</span> received

Connection Times <span class="token punctuation">(</span>ms<span class="token punctuation">)</span>
              min  mean<span class="token punctuation">[</span>+/-sd<span class="token punctuation">]</span> median   max
Connect:        <span class="token number">0</span>    <span class="token number">0</span>   <span class="token number">0.1</span>      <span class="token number">0</span>       <span class="token number">0</span>
Processing:  <span class="token number">1758</span> <span class="token number">2362</span> <span class="token number">982.9</span>   <span class="token number">1899</span>    <span class="token number">4597</span>
Waiting:     <span class="token number">1758</span> <span class="token number">2361</span> <span class="token number">982.4</span>   <span class="token number">1899</span>    <span class="token number">4595</span>
Total:       <span class="token number">1758</span> <span class="token number">2362</span> <span class="token number">982.9</span>   <span class="token number">1899</span>    <span class="token number">4597</span>

Percentage of the requests served within a certain <span class="token function">time</span> <span class="token punctuation">(</span>ms<span class="token punctuation">)</span>
  <span class="token number">50</span>%   <span class="token number">1899</span>
  <span class="token number">66</span>%   <span class="token number">2025</span>
  <span class="token number">75</span>%   <span class="token number">2378</span>
  <span class="token number">80</span>%   <span class="token number">3706</span>
  <span class="token number">90</span>%   <span class="token number">4597</span>
  <span class="token number">95</span>%   <span class="token number">4597</span>
  <span class="token number">98</span>%   <span class="token number">4597</span>
  <span class="token number">99</span>%   <span class="token number">4597</span>
 <span class="token number">100</span>%   <span class="token number">4597</span> <span class="token punctuation">(</span>longest request<span class="token punctuation">)</span>
</code></pre></div><p>alpã®çµæœ</p> <div class="language-bash extra-class"><pre class="language-bash"><code>% <span class="token function">tail</span> -n <span class="token number">10</span> logs/nginx/access.log<span class="token operator">|</span> alp json -o count,method,uri,min,avg,max
+-------+--------+-----+-------+-------+-------+
<span class="token operator">|</span> COUNT <span class="token operator">|</span> METHOD <span class="token operator">|</span> URI <span class="token operator">|</span>  MIN  <span class="token operator">|</span>  AVG  <span class="token operator">|</span>  MAX  <span class="token operator">|</span>
+-------+--------+-----+-------+-------+-------+
<span class="token operator">|</span>    <span class="token number">10</span> <span class="token operator">|</span> GET    <span class="token operator">|</span> /   <span class="token operator">|</span> <span class="token number">1.755</span> <span class="token operator">|</span> **2.357** <span class="token operator">|</span> <span class="token number">4.590</span> <span class="token operator">|</span>
+-------+--------+-----+-------+-------+-------+
</code></pre></div></li> <li><p>mysqldumpslowã¨pt-query-digestã®æ¯”è¼ƒ</p></li> <li><p>mysqldumpslow</p> <div class="language-bash extra-class"><pre class="language-bash"><code>% mysqldumpslow logs/mysql/mysql-slow.log                       <span class="token punctuation">[</span>~/work/private-isu/webapp<span class="token punctuation">]</span>+<span class="token punctuation">[</span>master<span class="token punctuation">]</span>

Reading mysql slow query log from logs/mysql/mysql-slow.log
Count: <span class="token number">1</span>  <span class="token assign-left variable">Time</span><span class="token operator">=</span><span class="token number">0</span>.08s <span class="token punctuation">(</span>0s<span class="token punctuation">)</span>  <span class="token assign-left variable">Lock</span><span class="token operator">=</span><span class="token number">0</span>.00s <span class="token punctuation">(</span>0s<span class="token punctuation">)</span>  <span class="token assign-left variable">Rows</span><span class="token operator">=</span><span class="token number">10001.0</span> <span class="token punctuation">(</span><span class="token number">10001</span><span class="token punctuation">)</span>, root<span class="token punctuation">[</span>root<span class="token punctuation">]</span>@webapp_app_1.webapp_default
  SELECT <span class="token variable"><span class="token variable">`</span><span class="token function">id</span><span class="token variable">`</span></span>, <span class="token variable"><span class="token variable">`</span>user_id<span class="token variable">`</span></span>, <span class="token variable"><span class="token variable">`</span>body<span class="token variable">`</span></span>, <span class="token variable"><span class="token variable">`</span>created_at<span class="token variable">`</span></span>, <span class="token variable"><span class="token variable">`</span>mime<span class="token variable">`</span></span> FROM <span class="token variable"><span class="token variable">`</span>posts<span class="token variable">`</span></span> ORDER BY <span class="token variable"><span class="token variable">`</span>created_at<span class="token variable">`</span></span> DESC

Count: <span class="token number">22</span>  <span class="token assign-left variable">Time</span><span class="token operator">=</span><span class="token number">0</span>.06s <span class="token punctuation">(</span>1s<span class="token punctuation">)</span>  <span class="token assign-left variable">Lock</span><span class="token operator">=</span><span class="token number">0</span>.00s <span class="token punctuation">(</span>0s<span class="token punctuation">)</span>  <span class="token assign-left variable">Rows</span><span class="token operator">=</span><span class="token number">2.9</span> <span class="token punctuation">(</span><span class="token number">64</span><span class="token punctuation">)</span>, root<span class="token punctuation">[</span>root<span class="token punctuation">]</span>@webapp_app_1.webapp_default
  SELECT * FROM <span class="token variable"><span class="token variable">`</span>comments<span class="token variable">`</span></span> WHERE <span class="token variable"><span class="token variable">`</span>post_id<span class="token variable">`</span></span> <span class="token operator">=</span> N ORDER BY <span class="token variable"><span class="token variable">`</span>created_at<span class="token variable">`</span></span> DESC LIMIT N

Count: <span class="token number">22</span>  <span class="token assign-left variable">Time</span><span class="token operator">=</span><span class="token number">0</span>.02s <span class="token punctuation">(</span>0s<span class="token punctuation">)</span>  <span class="token assign-left variable">Lock</span><span class="token operator">=</span><span class="token number">0</span>.00s <span class="token punctuation">(</span>0s<span class="token punctuation">)</span>  <span class="token assign-left variable">Rows</span><span class="token operator">=</span><span class="token number">1.0</span> <span class="token punctuation">(</span><span class="token number">22</span><span class="token punctuation">)</span>, root<span class="token punctuation">[</span>root<span class="token punctuation">]</span>@webapp_app_1.webapp_default
  SELECT COUNT<span class="token punctuation">(</span>*<span class="token punctuation">)</span> AS <span class="token variable"><span class="token variable">`</span>count<span class="token variable">`</span></span> FROM <span class="token variable"><span class="token variable">`</span>comments<span class="token variable">`</span></span> WHERE <span class="token variable"><span class="token variable">`</span>post_id<span class="token variable">`</span></span> <span class="token operator">=</span> N

Count: <span class="token number">20</span>  <span class="token assign-left variable">Time</span><span class="token operator">=</span><span class="token number">0</span>.00s <span class="token punctuation">(</span>0s<span class="token punctuation">)</span>  <span class="token assign-left variable">Lock</span><span class="token operator">=</span><span class="token number">0</span>.00s <span class="token punctuation">(</span>0s<span class="token punctuation">)</span>  <span class="token assign-left variable">Rows</span><span class="token operator">=</span><span class="token number">1.0</span> <span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span>, root<span class="token punctuation">[</span>root<span class="token punctuation">]</span>@webapp_app_1.webapp_default
  SELECT * FROM <span class="token variable"><span class="token variable">`</span>posts<span class="token variable">`</span></span> WHERE <span class="token variable"><span class="token variable">`</span><span class="token function">id</span><span class="token variable">`</span></span> <span class="token operator">=</span> N

Count: <span class="token number">86</span>  <span class="token assign-left variable">Time</span><span class="token operator">=</span><span class="token number">0</span>.00s <span class="token punctuation">(</span>0s<span class="token punctuation">)</span>  <span class="token assign-left variable">Lock</span><span class="token operator">=</span><span class="token number">0</span>.00s <span class="token punctuation">(</span>0s<span class="token punctuation">)</span>  <span class="token assign-left variable">Rows</span><span class="token operator">=</span><span class="token number">1.0</span> <span class="token punctuation">(</span><span class="token number">86</span><span class="token punctuation">)</span>, root<span class="token punctuation">[</span>root<span class="token punctuation">]</span>@webapp_app_1.webapp_default
  SELECT * FROM <span class="token variable"><span class="token variable">`</span><span class="token function">users</span><span class="token variable">`</span></span> WHERE <span class="token variable"><span class="token variable">`</span><span class="token function">id</span><span class="token variable">`</span></span> <span class="token operator">=</span> N

Count: <span class="token number">305</span>  <span class="token assign-left variable">Time</span><span class="token operator">=</span><span class="token number">0</span>.00s <span class="token punctuation">(</span>0s<span class="token punctuation">)</span>  <span class="token assign-left variable">Lock</span><span class="token operator">=</span><span class="token number">0</span>.00s <span class="token punctuation">(</span>0s<span class="token punctuation">)</span>  <span class="token assign-left variable">Rows</span><span class="token operator">=</span><span class="token number">0.4</span> <span class="token punctuation">(</span><span class="token number">133</span><span class="token punctuation">)</span>, 2users@2hosts
  <span class="token comment">#</span>

Count: <span class="token number">150</span>  <span class="token assign-left variable">Time</span><span class="token operator">=</span><span class="token number">0</span>.00s <span class="token punctuation">(</span>0s<span class="token punctuation">)</span>  <span class="token assign-left variable">Lock</span><span class="token operator">=</span><span class="token number">0</span>.00s <span class="token punctuation">(</span>0s<span class="token punctuation">)</span>  <span class="token assign-left variable">Rows</span><span class="token operator">=</span><span class="token number">0.0</span> <span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>, 0users@0hosts
  administrator command: Prepare

Count: <span class="token number">133</span>  <span class="token assign-left variable">Time</span><span class="token operator">=</span><span class="token number">0</span>.00s <span class="token punctuation">(</span>0s<span class="token punctuation">)</span>  <span class="token assign-left variable">Lock</span><span class="token operator">=</span><span class="token number">0</span>.00s <span class="token punctuation">(</span>0s<span class="token punctuation">)</span>  <span class="token assign-left variable">Rows</span><span class="token operator">=</span><span class="token number">0.0</span> <span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>, 0users@0hosts
  administrator command: Close stmt

Count: <span class="token number">11</span>  <span class="token assign-left variable">Time</span><span class="token operator">=</span><span class="token number">0</span>.00s <span class="token punctuation">(</span>0s<span class="token punctuation">)</span>  <span class="token assign-left variable">Lock</span><span class="token operator">=</span><span class="token number">0</span>.00s <span class="token punctuation">(</span>0s<span class="token punctuation">)</span>  <span class="token assign-left variable">Rows</span><span class="token operator">=</span><span class="token number">0.0</span> <span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>, 0users@0hosts
  administrator command: Ping

Count: <span class="token number">11</span>  <span class="token assign-left variable">Time</span><span class="token operator">=</span><span class="token number">0</span>.00s <span class="token punctuation">(</span>0s<span class="token punctuation">)</span>  <span class="token assign-left variable">Lock</span><span class="token operator">=</span><span class="token number">0</span>.00s <span class="token punctuation">(</span>0s<span class="token punctuation">)</span>  <span class="token assign-left variable">Rows</span><span class="token operator">=</span><span class="token number">0.0</span> <span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>, 0users@0hosts
  administrator command: Quit
</code></pre></div></li> <li><p>pt-query-digest</p> <div class="language-bash extra-class"><pre class="language-bash"><code>pt-query-digest ./logs/mysql/mysql-slow.log                   <span class="token punctuation">[</span>~/work/private-isu/webapp<span class="token punctuation">]</span>+<span class="token punctuation">[</span>master<span class="token punctuation">]</span>

<span class="token comment"># A software update is available:</span>
<span class="token comment">#   * The current version for Percona::Toolkit is 3.0.5</span>

<span class="token comment"># 360ms user time, 140ms system time, 34.92M rss, 4.13G vsz</span>
<span class="token comment"># Current date: Wed Jun  8 23:22:35 2022</span>
<span class="token comment"># Hostname: deadbeef.local</span>
<span class="token comment"># Files: ./logs/mysql/mysql-slow.log</span>
<span class="token comment"># Overall: 460 total, 9 unique, 1.27 QPS, 0.01x concurrency ______________</span>
<span class="token comment"># Time range: 2022-06-08T14:16:23 to 2022-06-08T14:22:24</span>
<span class="token comment"># Attribute          total     min     max     avg     95%  stddev  median</span>
<span class="token comment"># ============     ======= ======= ======= ======= ======= ======= =======</span>
<span class="token comment"># Exec time             2s     4us    88ms     5ms    59ms    15ms   236us</span>
<span class="token comment"># Lock time          465us       0    17us     1us     2us     1us       0</span>
<span class="token comment"># Rows sent          9.95k       0   9.77k   22.16    0.99  444.93       0</span>
<span class="token comment"># Rows examine       4.22M       0  97.66k   9.38k  97.04k  28.54k       0</span>
<span class="token comment"># Query size        16.57k      27      92   36.88   65.89   12.74   31.70</span>

<span class="token comment"># Profile</span>
<span class="token comment"># Rank Query ID           Response time Calls R/Call V/M   Item</span>
<span class="token comment"># ==== ================== ============= ===== ====== ===== ===============</span>
<span class="token comment">#    1 0x16849282195BE09F  1.4162 66.5%    22 0.0644  0.00 SELECT comments</span>
<span class="token comment">#    2 0x7539A5F45EB76A80  0.5197 24.4%    22 0.0236  0.01 SELECT comments</span>
<span class="token comment">#    3 0x44D0B06948A2E5CC  0.0825  3.9%     1 0.0825  0.00 SELECT posts</span>
<span class="token comment">#    4 0x99AA0165670CE848  0.0513  2.4%   150 0.0003  0.00 ADMIN PREPARE</span>
<span class="token comment"># MISC 0xMISC              0.0600  2.8%   265 0.0002   0.0 &lt;5 ITEMS&gt;</span>

<span class="token comment"># Query 1: 11 QPS, 0.71x concurrency, ID 0x16849282195BE09F at byte 20337</span>
<span class="token comment"># This item is included in the report because it matches --limit.</span>
<span class="token comment"># Scores: V/M = 0.00</span>
<span class="token comment"># Time range: 2022-06-08T14:17:38 to 2022-06-08T14:17:40</span>
<span class="token comment"># Attribute    pct   total     min     max     avg     95%  stddev  median</span>
<span class="token comment"># ============ === ======= ======= ======= ======= ======= ======= =======</span>
<span class="token comment"># Count          4      22</span>
<span class="token comment"># Exec time     66      1s    60ms    81ms    64ms    68ms     5ms    61ms</span>
<span class="token comment"># Lock time     12    57us     2us     4us     2us     2us       0     2us</span>
<span class="token comment"># Rows sent      0      64       1       3    2.91    2.90    0.40    2.90</span>
<span class="token comment"># Rows examine  49   2.10M  97.66k  97.66k  97.66k  97.04k       0  97.04k</span>
<span class="token comment"># Query size    10   1.76k      82      83   82.09   80.10    0.00   80.10</span>
<span class="token comment"># String:</span>
<span class="token comment"># Databases    isuconp</span>
<span class="token comment"># Hosts        webapp_app_1.webapp_default</span>
<span class="token comment"># Users        root</span>
<span class="token comment"># Query_time distribution</span>
<span class="token comment">#   1us</span>
<span class="token comment">#  10us</span>
<span class="token comment"># 100us</span>
<span class="token comment">#   1ms</span>
<span class="token comment">#  10ms  ################################################################</span>
<span class="token comment"># 100ms</span>
<span class="token comment">#    1s</span>
<span class="token comment">#  10s+</span>
<span class="token comment"># Tables</span>
<span class="token comment">#    SHOW TABLE STATUS FROM `isuconp` LIKE 'comments'\G</span>
<span class="token comment">#    SHOW CREATE TABLE `isuconp`.`comments`\G</span>
<span class="token comment"># EXPLAIN /*!50100 PARTITIONS*/</span>
SELECT * FROM <span class="token variable"><span class="token variable">`</span>comments<span class="token variable">`</span></span> WHERE <span class="token variable"><span class="token variable">`</span>post_id<span class="token variable">`</span></span> <span class="token operator">=</span> <span class="token number">9995</span> ORDER BY <span class="token variable"><span class="token variable">`</span>created_at<span class="token variable">`</span></span> DESC LIMIT <span class="token number">3</span><span class="token punctuation">\</span>G

<span class="token comment"># Query 2: 11 QPS, 0.26x concurrency, ID 0x7539A5F45EB76A80 at byte 2174 _</span>
<span class="token comment"># This item is included in the report because it matches --limit.</span>
<span class="token comment"># Scores: V/M = 0.01</span>
<span class="token comment"># Time range: 2022-06-08T14:17:38 to 2022-06-08T14:17:40</span>
<span class="token comment"># Attribute    pct   total     min     max     avg     95%  stddev  median</span>
<span class="token comment"># ============ === ======= ======= ======= ======= ======= ======= =======</span>
<span class="token comment"># Count          4      22</span>
<span class="token comment"># Exec time     24   520ms    19ms    88ms    24ms    21ms    14ms    20ms</span>
<span class="token comment"># Lock time     11    55us     2us     4us     2us     2us       0     1us</span>
<span class="token comment"># Rows sent      0      22       1       1       1       1       0       1</span>
<span class="token comment"># Rows examine  49   2.10M  97.66k  97.66k  97.66k  97.66k       0  97.66k</span>
<span class="token comment"># Query size     8   1.40k      65      66   65.09   62.76    0.50   62.76</span>
<span class="token comment"># String:</span>
<span class="token comment"># Databases    isuconp</span>
<span class="token comment"># Hosts        webapp_app_1.webapp_default</span>
<span class="token comment"># Users        root</span>
<span class="token comment"># Query_time distribution</span>
<span class="token comment">#   1us</span>
<span class="token comment">#  10us</span>
<span class="token comment"># 100us</span>
<span class="token comment">#   1ms</span>
<span class="token comment">#  10ms  ################################################################</span>
<span class="token comment"># 100ms</span>
<span class="token comment">#    1s</span>
<span class="token comment">#  10s+</span>
<span class="token comment"># Tables</span>
<span class="token comment">#    SHOW TABLE STATUS FROM `isuconp` LIKE 'comments'\G</span>
<span class="token comment">#    SHOW CREATE TABLE `isuconp`.`comments`\G</span>
<span class="token comment"># EXPLAIN /*!50100 PARTITIONS*/</span>
SELECT COUNT<span class="token punctuation">(</span>*<span class="token punctuation">)</span> AS <span class="token variable"><span class="token variable">`</span>count<span class="token variable">`</span></span> FROM <span class="token variable"><span class="token variable">`</span>comments<span class="token variable">`</span></span> WHERE <span class="token variable"><span class="token variable">`</span>post_id<span class="token variable">`</span></span> <span class="token operator">=</span> <span class="token number">10001</span><span class="token punctuation">\</span>G

<span class="token comment"># Query 3: 0 QPS, 0x concurrency, ID 0x44D0B06948A2E5CC at byte 1595 _____</span>
<span class="token comment"># This item is included in the report because it matches --limit.</span>
<span class="token comment"># Scores: V/M = 0.00</span>
<span class="token comment"># Time range: all events occurred at 2022-06-08T14:17:38</span>
<span class="token comment"># Attribute    pct   total     min     max     avg     95%  stddev  median</span>
<span class="token comment"># ============ === ======= ======= ======= ======= ======= ======= =======</span>
<span class="token comment"># Count          0       1</span>
<span class="token comment"># Exec time      3    82ms    82ms    82ms    82ms    82ms       0    82ms</span>
<span class="token comment"># Lock time      3    17us    17us    17us    17us    17us       0    17us</span>
<span class="token comment"># Rows sent     98   9.77k   9.77k   9.77k   9.77k   9.77k       0   9.77k</span>
<span class="token comment"># Rows examine   0  19.53k  19.53k  19.53k  19.53k  19.53k       0  19.53k</span>
<span class="token comment"># Query size     0      92      92      92      92      92       0      92</span>
<span class="token comment"># String:</span>
<span class="token comment"># Databases    isuconp</span>
<span class="token comment"># Hosts        webapp_app_1.webapp_default</span>
<span class="token comment"># Users        root</span>
<span class="token comment"># Query_time distribution</span>
<span class="token comment">#   1us</span>
<span class="token comment">#  10us</span>
<span class="token comment"># 100us</span>
<span class="token comment">#   1ms</span>
<span class="token comment">#  10ms  ################################################################</span>
<span class="token comment"># 100ms</span>
<span class="token comment">#    1s</span>
<span class="token comment">#  10s+</span>
<span class="token comment"># Tables</span>
<span class="token comment">#    SHOW TABLE STATUS FROM `isuconp` LIKE 'posts'\G</span>
<span class="token comment">#    SHOW CREATE TABLE `isuconp`.`posts`\G</span>
<span class="token comment"># EXPLAIN /*!50100 PARTITIONS*/</span>
SELECT <span class="token variable"><span class="token variable">`</span><span class="token function">id</span><span class="token variable">`</span></span>, <span class="token variable"><span class="token variable">`</span>user_id<span class="token variable">`</span></span>, <span class="token variable"><span class="token variable">`</span>body<span class="token variable">`</span></span>, <span class="token variable"><span class="token variable">`</span>created_at<span class="token variable">`</span></span>, <span class="token variable"><span class="token variable">`</span>mime<span class="token variable">`</span></span> FROM <span class="token variable"><span class="token variable">`</span>posts<span class="token variable">`</span></span> ORDER BY <span class="token variable"><span class="token variable">`</span>created_at<span class="token variable">`</span></span> DESC<span class="token punctuation">\</span>G

<span class="token comment"># Query 4: 37.50 QPS, 0.01x concurrency, ID 0x99AA0165670CE848 at byte 1926</span>
<span class="token comment"># This item is included in the report because it matches --limit.</span>
<span class="token comment"># Scores: V/M = 0.00</span>
<span class="token comment"># Time range: 2022-06-08T14:17:38 to 2022-06-08T14:17:42</span>
<span class="token comment"># Attribute    pct   total     min     max     avg     95%  stddev  median</span>
<span class="token comment"># ============ === ======= ======= ======= ======= ======= ======= =======</span>
<span class="token comment"># Count         32     150</span>
<span class="token comment"># Exec time      2    51ms   140us     5ms   341us   467us   419us   260us</span>
<span class="token comment"># Lock time      5    25us       0    16us       0       0     1us       0</span>
<span class="token comment"># Rows sent      0       0       0       0       0       0       0       0</span>
<span class="token comment"># Rows examine   0       0       0       0       0       0       0       0</span>
<span class="token comment"># Query size    26   4.39k      30      30      30      30       0      30</span>
<span class="token comment"># String:</span>
<span class="token comment"># Databases    isuconp</span>
<span class="token comment"># Hosts        webapp_app_1.webapp_default</span>
<span class="token comment"># Users        root</span>
<span class="token comment"># Query_time distribution</span>
<span class="token comment">#   1us</span>
<span class="token comment">#  10us</span>
<span class="token comment"># 100us  ################################################################</span>
<span class="token comment">#   1ms  #</span>
<span class="token comment">#  10ms</span>
<span class="token comment"># 100ms</span>
<span class="token comment">#    1s</span>
<span class="token comment">#  10s+</span>
administrator command: Prepare<span class="token punctuation">\</span>G
</code></pre></div></li> <li><p>CPUä½¿ç”¨ç‡ã®å±¥æ­´ã‚’æ®‹ã—ãŸã„å ´åˆã¯ <code>$ dstat</code></p></li></ul> <div class="language-bash extra-class"><pre class="language-bash"><code>dstat --cpu
</code></pre></div><h2 id="_4-ã‚·ãƒŠãƒªã‚ªã‚’æŒã£ãŸè² è·è©¦é¨“"><a href="#_4-ã‚·ãƒŠãƒªã‚ªã‚’æŒã£ãŸè² è·è©¦é¨“" class="header-anchor">#</a> 4. ã‚·ãƒŠãƒªã‚ªã‚’æŒã£ãŸè² è·è©¦é¨“</h2> <ul><li><p>k6</p> <ul><li>HTTP/1.1, 2, WebSocket, gRPCã§ã‚·ãƒŠãƒªã‚ªãƒ™ãƒ¼ã‚¹ã®è² è·è©¦é¨“ã‚’è¡Œãˆã‚‹ãƒ„ãƒ¼ãƒ«</li> <li>MacOSãªã‚‰ <code>$ brew install k6</code></li> <li>ä»–OSãªã‚‰<a href="https://k6.io/docs/getting-started/installation/" target="_blank" rel="noopener noreferrer">ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>ã‚’å‚ç…§ã—ã¦</li></ul></li> <li><p>ä¸¦åˆ—åº¦1ã§30ç§’é–“å®Ÿè¡Œã™ã‚‹å ´åˆ</p> <ul><li><code>$ k6 run --vus 1 --duration 30s ab.js</code></li> <li><code>vus</code> ã¯Virtual Usersã®ç•¥</li></ul></li> <li><p>å˜ä¸€URLã«ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’é€ä¿¡ã™ã‚‹ã‚·ãƒŠãƒªã‚ª</p> <div class="language-bash extra-class"><pre class="language-bash"><code>% <span class="token function">cat</span> ab.js                                                                                                                                                        <span class="token punctuation">[</span>~/work/private-isu/k6<span class="token punctuation">]</span>+<span class="token punctuation">[</span>master<span class="token punctuation">]</span>
<span class="token function">import</span> http from <span class="token string">&quot;k6/http&quot;</span>

const BASE_URL <span class="token operator">=</span> <span class="token string">&quot;http://localhost&quot;</span><span class="token punctuation">;</span>

<span class="token builtin class-name">export</span> default <span class="token function-name function">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  http.get<span class="token punctuation">(</span><span class="token variable"><span class="token variable">`</span>$<span class="token punctuation">{</span>BASE_URL<span class="token punctuation">}</span>/<span class="token variable">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
% k6 run --vus <span class="token number">1</span> --duration 30s ab.js                                                                                                                              <span class="token punctuation">[</span>~/work/private-isu/k6<span class="token punctuation">]</span>+<span class="token punctuation">[</span>master<span class="token punctuation">]</span>

          /<span class="token punctuation">\</span>      <span class="token operator">|</span>â€¾â€¾<span class="token operator">|</span> /â€¾â€¾/   /â€¾â€¾/   
     /<span class="token punctuation">\</span>  /  <span class="token punctuation">\</span>     <span class="token operator">|</span>  <span class="token operator">|</span>/  /   /  /    
    /  <span class="token punctuation">\</span>/    <span class="token punctuation">\</span>    <span class="token operator">|</span>     <span class="token punctuation">(</span>   /   â€¾â€¾<span class="token punctuation">\</span>  
   /          <span class="token punctuation">\</span>   <span class="token operator">|</span>  <span class="token operator">|</span><span class="token punctuation">\</span>  <span class="token punctuation">\</span> <span class="token operator">|</span>  <span class="token punctuation">(</span>â€¾<span class="token punctuation">)</span>  <span class="token operator">|</span> 
  / __________ <span class="token punctuation">\</span>  <span class="token operator">|</span>__<span class="token operator">|</span> <span class="token punctuation">\</span>__<span class="token punctuation">\</span> <span class="token punctuation">\</span>_____/ .io

  execution: <span class="token builtin class-name">local</span>
     script: ab.js
     output: -

  scenarios: <span class="token punctuation">(</span><span class="token number">100.00</span>%<span class="token punctuation">)</span> <span class="token number">1</span> scenario, <span class="token number">1</span> max VUs, 1m0s max duration <span class="token punctuation">(</span>incl. graceful stop<span class="token punctuation">)</span>:
           * default: <span class="token number">1</span> looping VUs <span class="token keyword">for</span> 30s <span class="token punctuation">(</span>gracefulStop: 30s<span class="token punctuation">)</span>

running <span class="token punctuation">(</span>0m31.5s<span class="token punctuation">)</span>, <span class="token number">0</span>/1 VUs, <span class="token number">13</span> complete and <span class="token number">0</span> interrupted iterations
default âœ“ <span class="token punctuation">[</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token punctuation">]</span> <span class="token number">1</span> VUs  30s

     data_received<span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span>: <span class="token number">461</span> kB <span class="token number">15</span> kB/s
     data_sent<span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span>: <span class="token number">975</span> B  <span class="token number">31</span> B/s
     http_req_blocked<span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span>.: <span class="token assign-left variable">avg</span><span class="token operator">=</span><span class="token number">51.46</span>Âµs <span class="token assign-left variable">min</span><span class="token operator">=</span><span class="token number">2</span>Âµs   <span class="token assign-left variable">med</span><span class="token operator">=</span><span class="token number">4</span>Âµs   <span class="token assign-left variable">max</span><span class="token operator">=</span><span class="token number">620</span>Âµs  p<span class="token punctuation">(</span><span class="token number">90</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token number">6</span>Âµs     p<span class="token punctuation">(</span><span class="token number">95</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token number">251.59</span>Âµs
     http_req_connecting<span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span>: <span class="token assign-left variable">avg</span><span class="token operator">=</span><span class="token number">13.15</span>Âµs <span class="token assign-left variable">min</span><span class="token operator">=</span>0s    <span class="token assign-left variable">med</span><span class="token operator">=</span>0s    <span class="token assign-left variable">max</span><span class="token operator">=</span><span class="token number">171</span>Âµs  p<span class="token punctuation">(</span><span class="token number">90</span><span class="token punctuation">)</span><span class="token operator">=</span>0s      p<span class="token punctuation">(</span><span class="token number">95</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token number">68.39</span>Âµs 
     http_req_duration<span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span>: <span class="token assign-left variable">avg</span><span class="token operator">=</span><span class="token number">2</span>.42s   <span class="token assign-left variable">min</span><span class="token operator">=</span><span class="token number">2</span>.29s <span class="token assign-left variable">med</span><span class="token operator">=</span><span class="token number">2</span>.33s <span class="token assign-left variable">max</span><span class="token operator">=</span><span class="token number">3</span>.32s  p<span class="token punctuation">(</span><span class="token number">90</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token number">2</span>.58s   p<span class="token punctuation">(</span><span class="token number">95</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token number">2</span>.91s   
       <span class="token punctuation">{</span> expected_response:true <span class="token punctuation">}</span><span class="token punctuation">..</span>.: <span class="token assign-left variable">avg</span><span class="token operator">=</span><span class="token number">2</span>.42s   <span class="token assign-left variable">min</span><span class="token operator">=</span><span class="token number">2</span>.29s <span class="token assign-left variable">med</span><span class="token operator">=</span><span class="token number">2</span>.33s <span class="token assign-left variable">max</span><span class="token operator">=</span><span class="token number">3</span>.32s  p<span class="token punctuation">(</span><span class="token number">90</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token number">2</span>.58s   p<span class="token punctuation">(</span><span class="token number">95</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token number">2</span>.91s   
     http_req_failed<span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span>: <span class="token number">0.00</span>%  âœ“ <span class="token number">0</span>        âœ— <span class="token number">13</span> 
     http_req_receiving<span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span>.: <span class="token assign-left variable">avg</span><span class="token operator">=</span><span class="token number">424.3</span>Âµs <span class="token assign-left variable">min</span><span class="token operator">=</span><span class="token number">89</span>Âµs  <span class="token assign-left variable">med</span><span class="token operator">=</span><span class="token number">129</span>Âµs <span class="token assign-left variable">max</span><span class="token operator">=</span><span class="token number">3</span>.54ms p<span class="token punctuation">(</span><span class="token number">90</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token number">554.6</span>Âµs p<span class="token punctuation">(</span><span class="token number">95</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token number">1</span>.8ms   
     http_req_sending<span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span>.: <span class="token assign-left variable">avg</span><span class="token operator">=</span><span class="token number">28.92</span>Âµs <span class="token assign-left variable">min</span><span class="token operator">=</span><span class="token number">13</span>Âµs  <span class="token assign-left variable">med</span><span class="token operator">=</span><span class="token number">16</span>Âµs  <span class="token assign-left variable">max</span><span class="token operator">=</span><span class="token number">173</span>Âµs  p<span class="token punctuation">(</span><span class="token number">90</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token number">24.6</span>Âµs  p<span class="token punctuation">(</span><span class="token number">95</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token number">84.19</span>Âµs 
     http_req_tls_handshaking<span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span>.: <span class="token assign-left variable">avg</span><span class="token operator">=</span>0s      <span class="token assign-left variable">min</span><span class="token operator">=</span>0s    <span class="token assign-left variable">med</span><span class="token operator">=</span>0s    <span class="token assign-left variable">max</span><span class="token operator">=</span>0s     p<span class="token punctuation">(</span><span class="token number">90</span><span class="token punctuation">)</span><span class="token operator">=</span>0s      p<span class="token punctuation">(</span><span class="token number">95</span><span class="token punctuation">)</span><span class="token operator">=</span>0s      
     http_req_waiting<span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span>.: <span class="token assign-left variable">avg</span><span class="token operator">=</span><span class="token number">2</span>.42s   <span class="token assign-left variable">min</span><span class="token operator">=</span><span class="token number">2</span>.28s <span class="token assign-left variable">med</span><span class="token operator">=</span><span class="token number">2</span>.33s <span class="token assign-left variable">max</span><span class="token operator">=</span><span class="token number">3</span>.32s  p<span class="token punctuation">(</span><span class="token number">90</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token number">2</span>.58s   p<span class="token punctuation">(</span><span class="token number">95</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token number">2</span>.91s   
     http_reqs<span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span>: <span class="token number">13</span>     <span class="token number">0.412203</span>/s
     iteration_duration<span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span>.: <span class="token assign-left variable">avg</span><span class="token operator">=</span><span class="token number">2</span>.42s   <span class="token assign-left variable">min</span><span class="token operator">=</span><span class="token number">2</span>.29s <span class="token assign-left variable">med</span><span class="token operator">=</span><span class="token number">2</span>.33s <span class="token assign-left variable">max</span><span class="token operator">=</span><span class="token number">3</span>.32s  p<span class="token punctuation">(</span><span class="token number">90</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token number">2</span>.58s   p<span class="token punctuation">(</span><span class="token number">95</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token number">2</span>.91s   
     iterations<span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span>.: <span class="token number">13</span>     <span class="token number">0.412203</span>/s
     vus<span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span>: <span class="token number">1</span>      <span class="token assign-left variable">min</span><span class="token operator">=</span><span class="token number">1</span>      <span class="token assign-left variable">max</span><span class="token operator">=</span><span class="token number">1</span>
     vus_max<span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span>: <span class="token number">1</span>      <span class="token assign-left variable">min</span><span class="token operator">=</span><span class="token number">1</span>      <span class="token assign-left variable">max</span><span class="token operator">=</span><span class="token number">1</span>
</code></pre></div></li> <li><p>ISUCONã§ã¯åˆæœŸåŒ–ã®ãŸã‚ã« <code>GET /initialize</code> ã¨ã„ã†URLã«ã‚¢ã‚¯ã‚»ã‚¹ã™ã‚‹</p></li> <li><p>æ–°ã—ã„ã‚·ãƒŠãƒªã‚ª</p> <ol><li>Webã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®åˆæœŸåŒ–</li> <li>ãƒ­ã‚°ã‚¤ãƒ³ã—ã¦ã‚³ãƒ¡ãƒ³ãƒˆã‚’æŠ•ç¨¿ã™ã‚‹å‡¦ç†</li> <li>ãƒ­ã‚°ã‚¤ãƒ³ã—ã¦ç”»åƒã‚’æŠ•ç¨¿ã™ã‚‹å‡¦ç†</li></ol> <ul><li><p>URLã®å…±æœ‰ç”¨JS</p> <div class="language-jsx extra-class"><pre class="language-jsx"><code><span class="token comment">// config.js</span>
<span class="token keyword">const</span> <span class="token constant">BASE_URL</span> <span class="token operator">=</span> <span class="token string">&quot;http://localhost&quot;</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">url</span><span class="token punctuation">(</span><span class="token parameter">path</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword">return</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token constant">BASE_URL</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>path<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div></li> <li><p>åˆæœŸåŒ–å‡¦ç†ç”¨JS</p> <div class="language-jsx extra-class"><pre class="language-jsx"><code><span class="token comment">// initialize.js</span>
<span class="token keyword">import</span> http <span class="token keyword">from</span> <span class="token string">&quot;k6/http&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> sleep <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;k6&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> url <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;./config.js&quot;</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  http<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token function">url</span><span class="token punctuation">(</span><span class="token string">&quot;/initialize&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">timeout</span><span class="token operator">:</span> <span class="token string">&quot;10s&quot;</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div></li> <li><p>åˆæœŸåŒ–ã®è² è·å®Ÿè¡Œ</p> <div class="language-bash extra-class"><pre class="language-bash"><code>% k6 run --vus <span class="token number">1</span> initialize.js                                                                                                               <span class="token punctuation">[</span>~/work/private-isu/k6/scinario-base-request<span class="token punctuation">]</span>+<span class="token punctuation">[</span>master<span class="token punctuation">]</span>

          /<span class="token punctuation">\</span>      <span class="token operator">|</span>â€¾â€¾<span class="token operator">|</span> /â€¾â€¾/   /â€¾â€¾/   
     /<span class="token punctuation">\</span>  /  <span class="token punctuation">\</span>     <span class="token operator">|</span>  <span class="token operator">|</span>/  /   /  /    
    /  <span class="token punctuation">\</span>/    <span class="token punctuation">\</span>    <span class="token operator">|</span>     <span class="token punctuation">(</span>   /   â€¾â€¾<span class="token punctuation">\</span>  
   /          <span class="token punctuation">\</span>   <span class="token operator">|</span>  <span class="token operator">|</span><span class="token punctuation">\</span>  <span class="token punctuation">\</span> <span class="token operator">|</span>  <span class="token punctuation">(</span>â€¾<span class="token punctuation">)</span>  <span class="token operator">|</span> 
  / __________ <span class="token punctuation">\</span>  <span class="token operator">|</span>__<span class="token operator">|</span> <span class="token punctuation">\</span>__<span class="token punctuation">\</span> <span class="token punctuation">\</span>_____/ .io

  execution: <span class="token builtin class-name">local</span>
     script: initialize.js
     output: -

  scenarios: <span class="token punctuation">(</span><span class="token number">100.00</span>%<span class="token punctuation">)</span> <span class="token number">1</span> scenario, <span class="token number">1</span> max VUs, 10m30s max duration <span class="token punctuation">(</span>incl. graceful stop<span class="token punctuation">)</span>:
           * default: <span class="token number">1</span> iterations <span class="token keyword">for</span> each of <span class="token number">1</span> VUs <span class="token punctuation">(</span>maxDuration: 10m0s, gracefulStop: 30s<span class="token punctuation">)</span>

running <span class="token punctuation">(</span>00m01.1s<span class="token punctuation">)</span>, <span class="token number">0</span>/1 VUs, <span class="token number">1</span> complete and <span class="token number">0</span> interrupted iterations
default âœ“ <span class="token punctuation">[</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token punctuation">]</span> <span class="token number">1</span> VUs  00m01.1s/10m0s  <span class="token number">1</span>/1 iters, <span class="token number">1</span> per VU

     data_received<span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span>: <span class="token number">255</span> B <span class="token number">241</span> B/s
     data_sent<span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span>: <span class="token number">85</span> B  <span class="token number">80</span> B/s
     http_req_blocked<span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span>.: <span class="token assign-left variable">avg</span><span class="token operator">=</span><span class="token number">1</span>.18ms  <span class="token assign-left variable">min</span><span class="token operator">=</span><span class="token number">1</span>.18ms  <span class="token assign-left variable">med</span><span class="token operator">=</span><span class="token number">1</span>.18ms  <span class="token assign-left variable">max</span><span class="token operator">=</span><span class="token number">1</span>.18ms  p<span class="token punctuation">(</span><span class="token number">90</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token number">1</span>.18ms  p<span class="token punctuation">(</span><span class="token number">95</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token number">1</span>.18ms 
     http_req_connecting<span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span>: <span class="token assign-left variable">avg</span><span class="token operator">=</span><span class="token number">198</span>Âµs   <span class="token assign-left variable">min</span><span class="token operator">=</span><span class="token number">198</span>Âµs   <span class="token assign-left variable">med</span><span class="token operator">=</span><span class="token number">198</span>Âµs   <span class="token assign-left variable">max</span><span class="token operator">=</span><span class="token number">198</span>Âµs   p<span class="token punctuation">(</span><span class="token number">90</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token number">198</span>Âµs   p<span class="token punctuation">(</span><span class="token number">95</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token number">198</span>Âµs  
     http_req_duration<span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span>: <span class="token assign-left variable">avg</span><span class="token operator">=</span><span class="token number">52</span>.12ms <span class="token assign-left variable">min</span><span class="token operator">=</span><span class="token number">52</span>.12ms <span class="token assign-left variable">med</span><span class="token operator">=</span><span class="token number">52</span>.12ms <span class="token assign-left variable">max</span><span class="token operator">=</span><span class="token number">52</span>.12ms p<span class="token punctuation">(</span><span class="token number">90</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token number">52</span>.12ms p<span class="token punctuation">(</span><span class="token number">95</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token number">52</span>.12ms
       <span class="token punctuation">{</span> expected_response:true <span class="token punctuation">}</span><span class="token punctuation">..</span>.: <span class="token assign-left variable">avg</span><span class="token operator">=</span><span class="token number">52</span>.12ms <span class="token assign-left variable">min</span><span class="token operator">=</span><span class="token number">52</span>.12ms <span class="token assign-left variable">med</span><span class="token operator">=</span><span class="token number">52</span>.12ms <span class="token assign-left variable">max</span><span class="token operator">=</span><span class="token number">52</span>.12ms p<span class="token punctuation">(</span><span class="token number">90</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token number">52</span>.12ms p<span class="token punctuation">(</span><span class="token number">95</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token number">52</span>.12ms
     http_req_failed<span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span>: <span class="token number">0.00</span>% âœ“ <span class="token number">0</span>        âœ— <span class="token number">1</span>  
     http_req_receiving<span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span>.: <span class="token assign-left variable">avg</span><span class="token operator">=</span><span class="token number">169</span>Âµs   <span class="token assign-left variable">min</span><span class="token operator">=</span><span class="token number">169</span>Âµs   <span class="token assign-left variable">med</span><span class="token operator">=</span><span class="token number">169</span>Âµs   <span class="token assign-left variable">max</span><span class="token operator">=</span><span class="token number">169</span>Âµs   p<span class="token punctuation">(</span><span class="token number">90</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token number">169</span>Âµs   p<span class="token punctuation">(</span><span class="token number">95</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token number">169</span>Âµs  
     http_req_sending<span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span>.: <span class="token assign-left variable">avg</span><span class="token operator">=</span><span class="token number">706</span>Âµs   <span class="token assign-left variable">min</span><span class="token operator">=</span><span class="token number">706</span>Âµs   <span class="token assign-left variable">med</span><span class="token operator">=</span><span class="token number">706</span>Âµs   <span class="token assign-left variable">max</span><span class="token operator">=</span><span class="token number">706</span>Âµs   p<span class="token punctuation">(</span><span class="token number">90</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token number">706</span>Âµs   p<span class="token punctuation">(</span><span class="token number">95</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token number">706</span>Âµs  
     http_req_tls_handshaking<span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span>.: <span class="token assign-left variable">avg</span><span class="token operator">=</span>0s      <span class="token assign-left variable">min</span><span class="token operator">=</span>0s      <span class="token assign-left variable">med</span><span class="token operator">=</span>0s      <span class="token assign-left variable">max</span><span class="token operator">=</span>0s      p<span class="token punctuation">(</span><span class="token number">90</span><span class="token punctuation">)</span><span class="token operator">=</span>0s      p<span class="token punctuation">(</span><span class="token number">95</span><span class="token punctuation">)</span><span class="token operator">=</span>0s     
     http_req_waiting<span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span>.: <span class="token assign-left variable">avg</span><span class="token operator">=</span><span class="token number">51</span>.25ms <span class="token assign-left variable">min</span><span class="token operator">=</span><span class="token number">51</span>.25ms <span class="token assign-left variable">med</span><span class="token operator">=</span><span class="token number">51</span>.25ms <span class="token assign-left variable">max</span><span class="token operator">=</span><span class="token number">51</span>.25ms p<span class="token punctuation">(</span><span class="token number">90</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token number">51</span>.25ms p<span class="token punctuation">(</span><span class="token number">95</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token number">51</span>.25ms
     http_reqs<span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span>: <span class="token number">1</span>     <span class="token number">0.945969</span>/s
     iteration_duration<span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span>.: <span class="token assign-left variable">avg</span><span class="token operator">=</span><span class="token number">1</span>.05s   <span class="token assign-left variable">min</span><span class="token operator">=</span><span class="token number">1</span>.05s   <span class="token assign-left variable">med</span><span class="token operator">=</span><span class="token number">1</span>.05s   <span class="token assign-left variable">max</span><span class="token operator">=</span><span class="token number">1</span>.05s   p<span class="token punctuation">(</span><span class="token number">90</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token number">1</span>.05s   p<span class="token punctuation">(</span><span class="token number">95</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token number">1</span>.05s  
     iterations<span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span>.: <span class="token number">1</span>     <span class="token number">0.945969</span>/s
     vus<span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span>: <span class="token number">1</span>     <span class="token assign-left variable">min</span><span class="token operator">=</span><span class="token number">1</span>      <span class="token assign-left variable">max</span><span class="token operator">=</span><span class="token number">1</span>
     vus_max<span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span>: <span class="token number">1</span>     <span class="token assign-left variable">min</span><span class="token operator">=</span><span class="token number">1</span>      <span class="token assign-left variable">max</span><span class="token operator">=</span><span class="token number">1</span>
</code></pre></div></li> <li><p>ã‚³ãƒ¡ãƒ³ãƒˆæŠ•ç¨¿ã™ã‚‹JS</p> <div class="language-jsx extra-class"><pre class="language-jsx"><code><span class="token comment">// comment.js</span>
<span class="token keyword">import</span> http <span class="token keyword">from</span> <span class="token string">&quot;k6/http&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> check <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;k6&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> parseHTML <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;k6/html&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> url <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;./config.js&quot;</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// login</span>
  <span class="token keyword">const</span> login_res <span class="token operator">=</span> http<span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span><span class="token function">url</span><span class="token punctuation">(</span><span class="token string">&quot;/login&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">account_name</span><span class="token operator">:</span> <span class="token string">&quot;terra&quot;</span><span class="token punctuation">,</span>
    <span class="token literal-property property">password</span><span class="token operator">:</span> <span class="token string">&quot;terraterra&quot;</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token function">check</span><span class="token punctuation">(</span>login_res<span class="token punctuation">,</span> <span class="token punctuation">{</span>
    <span class="token string-property property">&quot;is status 200&quot;</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token parameter">r</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> r<span class="token punctuation">.</span>status <span class="token operator">===</span> <span class="token number">200</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> res <span class="token operator">=</span> http<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token function">url</span><span class="token punctuation">(</span><span class="token string">&quot;/@terra&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> doc <span class="token operator">=</span> <span class="token function">parseHTML</span><span class="token punctuation">(</span>res<span class="token punctuation">.</span>body<span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">const</span> token <span class="token operator">=</span> doc<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token string">'input[name=&quot;csrf_token&quot;]'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">first</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">attr</span><span class="token punctuation">(</span><span class="token string">&quot;value&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> post_id <span class="token operator">=</span> doc<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token string">'input[name=&quot;post_id&quot;]'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">first</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">attr</span><span class="token punctuation">(</span><span class="token string">&quot;value&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">// comment</span>
  <span class="token keyword">const</span> comment_res <span class="token operator">=</span> http<span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span><span class="token function">url</span><span class="token punctuation">(</span><span class="token string">&quot;/comment&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">post_id</span><span class="token operator">:</span> post_id<span class="token punctuation">,</span>
    <span class="token literal-property property">csrf_token</span><span class="token operator">:</span> token<span class="token punctuation">,</span>
    <span class="token literal-property property">comment</span><span class="token operator">:</span> <span class="token string">&quot;Hello k6!&quot;</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token function">check</span><span class="token punctuation">(</span>comment_res<span class="token punctuation">,</span> <span class="token punctuation">{</span>
    <span class="token string-property property">&quot;is status 200&quot;</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token parameter">r</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> r<span class="token punctuation">.</span>status <span class="token operator">===</span> <span class="token number">200</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div></li> <li><p>ã‚³ãƒ¡ãƒ³ãƒˆæŠ•ç¨¿ã®è² è·å®Ÿè¡Œ</p> <div class="language-bash extra-class"><pre class="language-bash"><code>% k6 run --vus <span class="token number">1</span> comment.js                                                                                                                  <span class="token punctuation">[</span>~/work/private-isu/k6/scinario-base-request<span class="token punctuation">]</span>+<span class="token punctuation">[</span>master<span class="token punctuation">]</span>

          /<span class="token punctuation">\</span>      <span class="token operator">|</span>â€¾â€¾<span class="token operator">|</span> /â€¾â€¾/   /â€¾â€¾/   
     /<span class="token punctuation">\</span>  /  <span class="token punctuation">\</span>     <span class="token operator">|</span>  <span class="token operator">|</span>/  /   /  /    
    /  <span class="token punctuation">\</span>/    <span class="token punctuation">\</span>    <span class="token operator">|</span>     <span class="token punctuation">(</span>   /   â€¾â€¾<span class="token punctuation">\</span>  
   /          <span class="token punctuation">\</span>   <span class="token operator">|</span>  <span class="token operator">|</span><span class="token punctuation">\</span>  <span class="token punctuation">\</span> <span class="token operator">|</span>  <span class="token punctuation">(</span>â€¾<span class="token punctuation">)</span>  <span class="token operator">|</span> 
  / __________ <span class="token punctuation">\</span>  <span class="token operator">|</span>__<span class="token operator">|</span> <span class="token punctuation">\</span>__<span class="token punctuation">\</span> <span class="token punctuation">\</span>_____/ .io

  execution: <span class="token builtin class-name">local</span>
     script: comment.js
     output: -

  scenarios: <span class="token punctuation">(</span><span class="token number">100.00</span>%<span class="token punctuation">)</span> <span class="token number">1</span> scenario, <span class="token number">1</span> max VUs, 10m30s max duration <span class="token punctuation">(</span>incl. graceful stop<span class="token punctuation">)</span>:
           * default: <span class="token number">1</span> iterations <span class="token keyword">for</span> each of <span class="token number">1</span> VUs <span class="token punctuation">(</span>maxDuration: 10m0s, gracefulStop: 30s<span class="token punctuation">)</span>

running at file:///Users/takashimima/work/private-isu/k6/scinario-base-request/comment.js:18:24<span class="token punctuation">(</span><span class="token number">40</span><span class="token punctuation">)</span>
default at native  <span class="token assign-left variable">executor</span><span class="token operator">=</span>per-vu-iterations <span class="token assign-left variable">scenario</span><span class="token operator">=</span>default <span class="token assign-left variable">source</span><span class="token operator">=</span>stacktrace

running <span class="token punctuation">(</span>00m06.8s<span class="token punctuation">)</span>, <span class="token number">0</span>/1 VUs, <span class="token number">1</span> complete and <span class="token number">0</span> interrupted iterations
default âœ“ <span class="token punctuation">[</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token punctuation">]</span> <span class="token number">1</span> VUs  00m06.8s/10m0s  <span class="token number">1</span>/1 iters, <span class="token number">1</span> per VU

     âœ“ is status <span class="token number">200</span>

     checks<span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span>.: <span class="token number">100.00</span>% âœ“ <span class="token number">1</span>        âœ— <span class="token number">0</span>  
     data_received<span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span>: <span class="token number">72</span> kB   <span class="token number">11</span> kB/s
     data_sent<span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span>: <span class="token number">600</span> B   <span class="token number">89</span> B/s
     http_req_blocked<span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span>.: <span class="token assign-left variable">avg</span><span class="token operator">=</span><span class="token number">568.66</span>Âµs <span class="token assign-left variable">min</span><span class="token operator">=</span><span class="token number">2</span>Âµs     <span class="token assign-left variable">med</span><span class="token operator">=</span><span class="token number">4</span>Âµs   <span class="token assign-left variable">max</span><span class="token operator">=</span><span class="token number">1</span>.7ms p<span class="token punctuation">(</span><span class="token number">90</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token number">1</span>.36ms  p<span class="token punctuation">(</span><span class="token number">95</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token number">1</span>.53ms 
     http_req_connecting<span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span>: <span class="token assign-left variable">avg</span><span class="token operator">=</span><span class="token number">62.33</span>Âµs  <span class="token assign-left variable">min</span><span class="token operator">=</span>0s      <span class="token assign-left variable">med</span><span class="token operator">=</span>0s    <span class="token assign-left variable">max</span><span class="token operator">=</span><span class="token number">187</span>Âµs p<span class="token punctuation">(</span><span class="token number">90</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token number">149.6</span>Âµs p<span class="token punctuation">(</span><span class="token number">95</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token number">168.3</span>Âµs
     http_req_duration<span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span>: <span class="token assign-left variable">avg</span><span class="token operator">=</span><span class="token number">2</span>.25s    <span class="token assign-left variable">min</span><span class="token operator">=</span><span class="token number">44</span>.9ms  <span class="token assign-left variable">med</span><span class="token operator">=</span><span class="token number">2</span>.88s <span class="token assign-left variable">max</span><span class="token operator">=</span><span class="token number">3</span>.84s p<span class="token punctuation">(</span><span class="token number">90</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token number">3</span>.65s   p<span class="token punctuation">(</span><span class="token number">95</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token number">3</span>.75s  
       <span class="token punctuation">{</span> expected_response:true <span class="token punctuation">}</span><span class="token punctuation">..</span>.: <span class="token assign-left variable">avg</span><span class="token operator">=</span><span class="token number">2</span>.25s    <span class="token assign-left variable">min</span><span class="token operator">=</span><span class="token number">44</span>.9ms  <span class="token assign-left variable">med</span><span class="token operator">=</span><span class="token number">2</span>.88s <span class="token assign-left variable">max</span><span class="token operator">=</span><span class="token number">3</span>.84s p<span class="token punctuation">(</span><span class="token number">90</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token number">3</span>.65s   p<span class="token punctuation">(</span><span class="token number">95</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token number">3</span>.75s  
     http_req_failed<span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span>: <span class="token number">0.00</span>%   âœ“ <span class="token number">0</span>        âœ— <span class="token number">3</span>  
     http_req_receiving<span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span>.: <span class="token assign-left variable">avg</span><span class="token operator">=</span><span class="token number">260</span>Âµs    <span class="token assign-left variable">min</span><span class="token operator">=</span><span class="token number">175</span>Âµs   <span class="token assign-left variable">med</span><span class="token operator">=</span><span class="token number">213</span>Âµs <span class="token assign-left variable">max</span><span class="token operator">=</span><span class="token number">392</span>Âµs p<span class="token punctuation">(</span><span class="token number">90</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token number">356.2</span>Âµs p<span class="token punctuation">(</span><span class="token number">95</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token number">374.1</span>Âµs
     http_req_sending<span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span>.: <span class="token assign-left variable">avg</span><span class="token operator">=</span><span class="token number">148.66</span>Âµs <span class="token assign-left variable">min</span><span class="token operator">=</span><span class="token number">14</span>Âµs    <span class="token assign-left variable">med</span><span class="token operator">=</span><span class="token number">18</span>Âµs  <span class="token assign-left variable">max</span><span class="token operator">=</span><span class="token number">414</span>Âµs p<span class="token punctuation">(</span><span class="token number">90</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token number">334.8</span>Âµs p<span class="token punctuation">(</span><span class="token number">95</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token number">374.4</span>Âµs
     http_req_tls_handshaking<span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span>.: <span class="token assign-left variable">avg</span><span class="token operator">=</span>0s       <span class="token assign-left variable">min</span><span class="token operator">=</span>0s      <span class="token assign-left variable">med</span><span class="token operator">=</span>0s    <span class="token assign-left variable">max</span><span class="token operator">=</span>0s    p<span class="token punctuation">(</span><span class="token number">90</span><span class="token punctuation">)</span><span class="token operator">=</span>0s      p<span class="token punctuation">(</span><span class="token number">95</span><span class="token punctuation">)</span><span class="token operator">=</span>0s     
     http_req_waiting<span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span>.: <span class="token assign-left variable">avg</span><span class="token operator">=</span><span class="token number">2</span>.25s    <span class="token assign-left variable">min</span><span class="token operator">=</span><span class="token number">44</span>.09ms <span class="token assign-left variable">med</span><span class="token operator">=</span><span class="token number">2</span>.87s <span class="token assign-left variable">max</span><span class="token operator">=</span><span class="token number">3</span>.84s p<span class="token punctuation">(</span><span class="token number">90</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token number">3</span>.65s   p<span class="token punctuation">(</span><span class="token number">95</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token number">3</span>.75s  
     http_reqs<span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span>: <span class="token number">3</span>       <span class="token number">0.442368</span>/s
     iteration_duration<span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span>.: <span class="token assign-left variable">avg</span><span class="token operator">=</span><span class="token number">6</span>.77s    <span class="token assign-left variable">min</span><span class="token operator">=</span><span class="token number">6</span>.77s   <span class="token assign-left variable">med</span><span class="token operator">=</span><span class="token number">6</span>.77s <span class="token assign-left variable">max</span><span class="token operator">=</span><span class="token number">6</span>.77s p<span class="token punctuation">(</span><span class="token number">90</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token number">6</span>.77s   p<span class="token punctuation">(</span><span class="token number">95</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token number">6</span>.77s  
     iterations<span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span>.: <span class="token number">1</span>       <span class="token number">0.147456</span>/s
     vus<span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span>: <span class="token number">1</span>       <span class="token assign-left variable">min</span><span class="token operator">=</span><span class="token number">1</span>      <span class="token assign-left variable">max</span><span class="token operator">=</span><span class="token number">1</span>
     vus_max<span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span>: <span class="token number">1</span>       <span class="token assign-left variable">min</span><span class="token operator">=</span><span class="token number">1</span>      <span class="token assign-left variable">max</span><span class="token operator">=</span><span class="token number">1</span>
</code></pre></div></li> <li><p>ç”»åƒã‚’ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã™ã‚‹JS</p> <div class="language-jsx extra-class"><pre class="language-jsx"><code><span class="token comment">// postimage.js</span>
<span class="token keyword">import</span> http <span class="token keyword">from</span> <span class="token string">&quot;k6/http&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> parseHTML <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;k6/html&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> url <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;./config.js&quot;</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> testImage <span class="token operator">=</span> <span class="token function">open</span><span class="token punctuation">(</span><span class="token string">&quot;testImage.jpg&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;b&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// login</span>
  <span class="token keyword">const</span> res <span class="token operator">=</span> http<span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span><span class="token function">url</span><span class="token punctuation">(</span><span class="token string">&quot;/login&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">account_name</span><span class="token operator">:</span> <span class="token string">&quot;terra&quot;</span><span class="token punctuation">,</span>
    <span class="token literal-property property">password</span><span class="token operator">:</span> <span class="token string">&quot;terraterra&quot;</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> doc <span class="token operator">=</span> <span class="token function">parseHTML</span><span class="token punctuation">(</span>res<span class="token punctuation">.</span>body<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> token <span class="token operator">=</span> doc<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token string">'input[name=&quot;csrf_token&quot;]'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">first</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">attr</span><span class="token punctuation">(</span><span class="token string">&quot;value&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  
  <span class="token comment">// post image</span>
  http<span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span><span class="token function">url</span><span class="token punctuation">(</span><span class="token string">&quot;/&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">file</span><span class="token operator">:</span> http<span class="token punctuation">.</span><span class="token function">file</span><span class="token punctuation">(</span>testImage<span class="token punctuation">,</span> <span class="token string">&quot;testimage.jpg&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;image/jpeg&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token literal-property property">body</span><span class="token operator">:</span> <span class="token string">&quot;Posted by k6&quot;</span><span class="token punctuation">,</span>
    <span class="token literal-property property">csrf_token</span><span class="token operator">:</span> token<span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div></li> <li><p>JSONã‚’èª­ã¿è¾¼ã‚€ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã®JS</p> <div class="language-json extra-class"><pre class="language-json"><code><span class="token punctuation">[</span>
    <span class="token punctuation">{</span>
        <span class="token property">&quot;account_name&quot;</span><span class="token operator">:</span><span class="token string">&quot;terra&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;password&quot;</span><span class="token operator">:</span><span class="token string">&quot;terraterra&quot;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span>
        <span class="token property">&quot;account_name&quot;</span><span class="token operator">:</span><span class="token string">&quot;sheri&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;password&quot;</span><span class="token operator">:</span><span class="token string">&quot;sherisheri&quot;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span>
        <span class="token property">&quot;account_name&quot;</span><span class="token operator">:</span><span class="token string">&quot;janelle&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;password&quot;</span><span class="token operator">:</span><span class="token string">&quot;janellejanelle&quot;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span>
        <span class="token property">&quot;account_name&quot;</span><span class="token operator">:</span><span class="token string">&quot;chasity&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;password&quot;</span><span class="token operator">:</span><span class="token string">&quot;chasitychasity&quot;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">]</span>
</code></pre></div><div class="language-jsx extra-class"><pre class="language-jsx"><code><span class="token comment">// account.js</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> SharedArray <span class="token punctuation">}</span> <span class="token keyword">import</span> <span class="token string">&quot;k6/data&quot;</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> accounts <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SharedArray</span><span class="token punctuation">(</span><span class="token string">'accounts'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span><span class="token function">open</span><span class="token punctuation">(</span><span class="token string">'./account.json'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">getAccount</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> accounts<span class="token punctuation">[</span>Math<span class="token punctuation">.</span><span class="token function">floor</span><span class="token punctuation">(</span>Math<span class="token punctuation">.</span><span class="token function">random</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">*</span> accounts<span class="token punctuation">.</span>length<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

</code></pre></div><div class="language-jsx extra-class"><pre class="language-jsx"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> getAccount <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;./account.js&quot;</span><span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function">commentScenario</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> account <span class="token operator">=</span> <span class="token function">getAccount</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> login_res <span class="token operator">=</span> http<span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span><span class="token function">url</span><span class="token punctuation">(</span><span class="token string">&quot;/login&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">account_name</span><span class="token operator">:</span> account_name<span class="token punctuation">,</span>
    <span class="token literal-property property">password</span><span class="token operator">:</span> account<span class="token punctuation">.</span>password<span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div></li> <li><p>è¤‡æ•°ã®ã‚·ãƒŠãƒªã‚ªã‚’çµ„ã¿åˆã‚ã›ãŸçµ±åˆã‚·ãƒŠãƒªã‚ªç”¨JS</p> <div class="language-jsx extra-class"><pre class="language-jsx"><code><span class="token comment">// integrated.js</span>
<span class="token keyword">import</span> initialize <span class="token keyword">from</span> <span class="token string">&quot;./initialize.js&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> comment <span class="token keyword">from</span> <span class="token string">&quot;./comment.js&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> postimage <span class="token keyword">from</span> <span class="token string">&quot;./postimage.js&quot;</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token punctuation">{</span>
    initialize<span class="token punctuation">,</span>
    comment<span class="token punctuation">,</span>
    postimage
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">// The scinario is </span>
<span class="token comment">// 1.   initialize    (0[s] ~10[s])</span>
<span class="token comment">// 2-1. leave comments(12[s]~42[s])</span>
<span class="token comment">// 2-2. post images   (12[s]~42[s])</span>
<span class="token keyword">export</span> <span class="token keyword">const</span> options <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">scenarios</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">initialize</span><span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token literal-property property">executor</span><span class="token operator">:</span> <span class="token string">&quot;shared-iterations&quot;</span><span class="token punctuation">,</span> <span class="token comment">// multiple virtual users</span>
            <span class="token literal-property property">vus</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
            <span class="token literal-property property">iterations</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
            <span class="token literal-property property">exec</span><span class="token operator">:</span> <span class="token string">&quot;initialize&quot;</span><span class="token punctuation">,</span>
            <span class="token literal-property property">maxDuration</span><span class="token operator">:</span> <span class="token string">&quot;10s&quot;</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token literal-property property">comment</span><span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token literal-property property">executor</span><span class="token operator">:</span> <span class="token string">&quot;constant-vus&quot;</span><span class="token punctuation">,</span>
            <span class="token literal-property property">vus</span><span class="token operator">:</span> <span class="token number">4</span><span class="token punctuation">,</span>
            <span class="token literal-property property">duration</span><span class="token operator">:</span> <span class="token string">&quot;30s&quot;</span><span class="token punctuation">,</span>
            <span class="token literal-property property">exec</span><span class="token operator">:</span> <span class="token string">&quot;comment&quot;</span><span class="token punctuation">,</span>
            <span class="token literal-property property">startTime</span><span class="token operator">:</span> <span class="token string">&quot;12s&quot;</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token literal-property property">postImage</span><span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token literal-property property">executor</span><span class="token operator">:</span> <span class="token string">&quot;constant-vus&quot;</span><span class="token punctuation">,</span>
            <span class="token literal-property property">vus</span><span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
            <span class="token literal-property property">duration</span><span class="token operator">:</span> <span class="token string">&quot;30s&quot;</span><span class="token punctuation">,</span>
            <span class="token literal-property property">exec</span><span class="token operator">:</span> <span class="token string">&quot;postimage&quot;</span><span class="token punctuation">,</span>
            <span class="token literal-property property">startTime</span><span class="token operator">:</span> <span class="token string">&quot;12s&quot;</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
</code></pre></div></li> <li><p>è¤‡æ•°ã®ã‚·ãƒŠãƒªã‚ªã‚’çµ„ã¿åˆã‚ã›ãŸçµ±åˆã‚·ãƒŠãƒªã‚ªã®è² è·å®Ÿè¡Œ</p> <div class="language-bash extra-class"><pre class="language-bash"><code>% k6 run integrated.js                                                                                                                       <span class="token punctuation">[</span>~/work/private-isu/k6/scinario-base-request<span class="token punctuation">]</span>+<span class="token punctuation">[</span>master<span class="token punctuation">]</span>

          /<span class="token punctuation">\</span>      <span class="token operator">|</span>â€¾â€¾<span class="token operator">|</span> /â€¾â€¾/   /â€¾â€¾/   
     /<span class="token punctuation">\</span>  /  <span class="token punctuation">\</span>     <span class="token operator">|</span>  <span class="token operator">|</span>/  /   /  /    
    /  <span class="token punctuation">\</span>/    <span class="token punctuation">\</span>    <span class="token operator">|</span>     <span class="token punctuation">(</span>   /   â€¾â€¾<span class="token punctuation">\</span>  
   /          <span class="token punctuation">\</span>   <span class="token operator">|</span>  <span class="token operator">|</span><span class="token punctuation">\</span>  <span class="token punctuation">\</span> <span class="token operator">|</span>  <span class="token punctuation">(</span>â€¾<span class="token punctuation">)</span>  <span class="token operator">|</span> 
  / __________ <span class="token punctuation">\</span>  <span class="token operator">|</span>__<span class="token operator">|</span> <span class="token punctuation">\</span>__<span class="token punctuation">\</span> <span class="token punctuation">\</span>_____/ .io

  execution: <span class="token builtin class-name">local</span>
     script: integrated.js
     output: -

  scenarios: <span class="token punctuation">(</span><span class="token number">100.00</span>%<span class="token punctuation">)</span> <span class="token number">3</span> scenarios, <span class="token number">7</span> max VUs, 1m12s max duration <span class="token punctuation">(</span>incl. graceful stop<span class="token punctuation">)</span>:
           * initialize: <span class="token number">1</span> iterations shared among <span class="token number">1</span> VUs <span class="token punctuation">(</span>maxDuration: 10s, exec: initialize, gracefulStop: 30s<span class="token punctuation">)</span>
           * comment: <span class="token number">4</span> looping VUs <span class="token keyword">for</span> 30s <span class="token punctuation">(</span>exec: comment, startTime: 12s, gracefulStop: 30s<span class="token punctuation">)</span>
           * postImage: <span class="token number">2</span> looping VUs <span class="token keyword">for</span> 30s <span class="token punctuation">(</span>exec: postimage, startTime: 12s, gracefulStop: 30s<span class="token punctuation">)</span>

running <span class="token punctuation">(</span>0m44.4s<span class="token punctuation">)</span>, <span class="token number">0</span>/7 VUs, <span class="token number">7</span> complete and <span class="token number">0</span> interrupted iterations
initialize âœ“ <span class="token punctuation">[</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token punctuation">]</span> <span class="token number">1</span> VUs  01.1s/10s  <span class="token number">1</span>/1 shared iters
comment    âœ“ <span class="token punctuation">[</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token punctuation">]</span> <span class="token number">4</span> VUs  30s       
postImage  âœ“ <span class="token punctuation">[</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token punctuation">]</span> <span class="token number">2</span> VUs  30s       

     âœ“ is status <span class="token number">200</span>

     checks<span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span>.: <span class="token number">100.00</span>% âœ“ <span class="token number">8</span>        âœ— <span class="token number">0</span>  
     data_received<span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span>: <span class="token number">382</span> kB  <span class="token number">8.6</span> kB/s
     data_sent<span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span>: <span class="token number">32</span> kB   <span class="token number">716</span> B/s
     http_req_blocked<span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span>.: <span class="token assign-left variable">avg</span><span class="token operator">=</span><span class="token number">374.06</span>Âµs <span class="token assign-left variable">min</span><span class="token operator">=</span><span class="token number">2</span>Âµs     <span class="token assign-left variable">med</span><span class="token operator">=</span><span class="token number">4</span>Âµs    <span class="token assign-left variable">max</span><span class="token operator">=</span><span class="token number">5</span>.99ms p<span class="token punctuation">(</span><span class="token number">90</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token number">979</span>Âµs    p<span class="token punctuation">(</span><span class="token number">95</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token number">1</span>.01ms  
     http_req_connecting<span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span>: <span class="token assign-left variable">avg</span><span class="token operator">=</span><span class="token number">141</span>Âµs    <span class="token assign-left variable">min</span><span class="token operator">=</span>0s      <span class="token assign-left variable">med</span><span class="token operator">=</span>0s     <span class="token assign-left variable">max</span><span class="token operator">=</span><span class="token number">878</span>Âµs  p<span class="token punctuation">(</span><span class="token number">90</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token number">609.59</span>Âµs p<span class="token punctuation">(</span><span class="token number">95</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token number">844.4</span>Âµs 
     http_req_duration<span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span>: <span class="token assign-left variable">avg</span><span class="token operator">=</span><span class="token number">6</span>.61s    <span class="token assign-left variable">min</span><span class="token operator">=</span><span class="token number">35</span>.72ms <span class="token assign-left variable">med</span><span class="token operator">=</span><span class="token number">3</span>.29s  <span class="token assign-left variable">max</span><span class="token operator">=</span><span class="token number">21</span>.16s p<span class="token punctuation">(</span><span class="token number">90</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token number">16</span>.82s   p<span class="token punctuation">(</span><span class="token number">95</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token number">19</span>.67s  
       <span class="token punctuation">{</span> expected_response:true <span class="token punctuation">}</span><span class="token punctuation">..</span>.: <span class="token assign-left variable">avg</span><span class="token operator">=</span><span class="token number">6</span>.61s    <span class="token assign-left variable">min</span><span class="token operator">=</span><span class="token number">35</span>.72ms <span class="token assign-left variable">med</span><span class="token operator">=</span><span class="token number">3</span>.29s  <span class="token assign-left variable">max</span><span class="token operator">=</span><span class="token number">21</span>.16s p<span class="token punctuation">(</span><span class="token number">90</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token number">16</span>.82s   p<span class="token punctuation">(</span><span class="token number">95</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token number">19</span>.67s  
     http_req_failed<span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span>: <span class="token number">0.00</span>%   âœ“ <span class="token number">0</span>        âœ— <span class="token number">29</span> 
     http_req_receiving<span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span>.: <span class="token assign-left variable">avg</span><span class="token operator">=</span><span class="token number">224.86</span>Âµs <span class="token assign-left variable">min</span><span class="token operator">=</span><span class="token number">69</span>Âµs    <span class="token assign-left variable">med</span><span class="token operator">=</span><span class="token number">99</span>Âµs   <span class="token assign-left variable">max</span><span class="token operator">=</span><span class="token number">2</span>.15ms p<span class="token punctuation">(</span><span class="token number">90</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token number">271.99</span>Âµs p<span class="token punctuation">(</span><span class="token number">95</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token number">693.39</span>Âµs
     http_req_sending<span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span>.: <span class="token assign-left variable">avg</span><span class="token operator">=</span><span class="token number">57.79</span>Âµs  <span class="token assign-left variable">min</span><span class="token operator">=</span><span class="token number">14</span>Âµs    <span class="token assign-left variable">med</span><span class="token operator">=</span><span class="token number">22</span>Âµs   <span class="token assign-left variable">max</span><span class="token operator">=</span><span class="token number">194</span>Âµs  p<span class="token punctuation">(</span><span class="token number">90</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token number">167.8</span>Âµs  p<span class="token punctuation">(</span><span class="token number">95</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token number">183.59</span>Âµs
     http_req_tls_handshaking<span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span>.: <span class="token assign-left variable">avg</span><span class="token operator">=</span>0s       <span class="token assign-left variable">min</span><span class="token operator">=</span>0s      <span class="token assign-left variable">med</span><span class="token operator">=</span>0s     <span class="token assign-left variable">max</span><span class="token operator">=</span>0s     p<span class="token punctuation">(</span><span class="token number">90</span><span class="token punctuation">)</span><span class="token operator">=</span>0s       p<span class="token punctuation">(</span><span class="token number">95</span><span class="token punctuation">)</span><span class="token operator">=</span>0s      
     http_req_waiting<span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span>.: <span class="token assign-left variable">avg</span><span class="token operator">=</span><span class="token number">6</span>.61s    <span class="token assign-left variable">min</span><span class="token operator">=</span><span class="token number">35</span>.52ms <span class="token assign-left variable">med</span><span class="token operator">=</span><span class="token number">3</span>.29s  <span class="token assign-left variable">max</span><span class="token operator">=</span><span class="token number">21</span>.16s p<span class="token punctuation">(</span><span class="token number">90</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token number">16</span>.82s   p<span class="token punctuation">(</span><span class="token number">95</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token number">19</span>.67s  
     http_reqs<span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span>: <span class="token number">29</span>      <span class="token number">0.653619</span>/s
     iteration_duration<span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span>.: <span class="token assign-left variable">avg</span><span class="token operator">=</span><span class="token number">27</span>.54s   <span class="token assign-left variable">min</span><span class="token operator">=</span><span class="token number">1</span>.1s    <span class="token assign-left variable">med</span><span class="token operator">=</span><span class="token number">31</span>.94s <span class="token assign-left variable">max</span><span class="token operator">=</span><span class="token number">32</span>.36s p<span class="token punctuation">(</span><span class="token number">90</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token number">32</span>.25s   p<span class="token punctuation">(</span><span class="token number">95</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token number">32</span>.3s   
     iterations<span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span>.: <span class="token number">7</span>       <span class="token number">0.15777</span>/s
     vus<span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span>: <span class="token number">3</span>       <span class="token assign-left variable">min</span><span class="token operator">=</span><span class="token number">0</span>      <span class="token assign-left variable">max</span><span class="token operator">=</span><span class="token number">6</span>
     vus_max<span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span>: <span class="token number">7</span>       <span class="token assign-left variable">min</span><span class="token operator">=</span><span class="token number">7</span>      <span class="token assign-left variable">max</span><span class="token operator">=</span><span class="token number">7</span>
</code></pre></div></li> <li><p>alpã®å®Ÿè¡Œçµæœ</p> <div class="language-bash extra-class"><pre class="language-bash"><code>% alp json --sort <span class="token function">sum</span> -r -m <span class="token string">&quot;/posts/[0-9]+,/@\w+&quot;</span> -o count,method,uri,min,avg,max,sum --file ./access.log.20220610-135211                           <span class="token punctuation">[</span>~/work/private-isu/webapp/logs/nginx<span class="token punctuation">]</span>+<span class="token punctuation">[</span>master<span class="token punctuation">]</span>
+-------+--------+---------------+--------+--------+--------+---------+
<span class="token operator">|</span> COUNT <span class="token operator">|</span> METHOD <span class="token operator">|</span>      URI      <span class="token operator">|</span>  MIN   <span class="token operator">|</span>  AVG   <span class="token operator">|</span>  MAX   <span class="token operator">|</span>   SUM   <span class="token operator">|</span>
+-------+--------+---------------+--------+--------+--------+---------+
<span class="token operator">|</span>    <span class="token number">12</span> <span class="token operator">|</span> GET    <span class="token operator">|</span> /             <span class="token operator">|</span>  <span class="token number">2.451</span> <span class="token operator">|</span>  <span class="token number">8.737</span> <span class="token operator">|</span> <span class="token number">15.176</span> <span class="token operator">|</span> <span class="token number">104.846</span> <span class="token operator">|</span>
<span class="token operator">|</span>     <span class="token number">8</span> <span class="token operator">|</span> GET    <span class="token operator">|</span> /@<span class="token punctuation">\</span>w+         <span class="token operator">|</span> <span class="token number">11.055</span> <span class="token operator">|</span> <span class="token number">12.770</span> <span class="token operator">|</span> <span class="token number">14.676</span> <span class="token operator">|</span> <span class="token number">102.158</span> <span class="token operator">|</span>
<span class="token operator">|</span>     <span class="token number">4</span> <span class="token operator">|</span> POST   <span class="token operator">|</span> /             <span class="token operator">|</span>  <span class="token number">2.214</span> <span class="token operator">|</span>  <span class="token number">9.666</span> <span class="token operator">|</span> <span class="token number">12.875</span> <span class="token operator">|</span>  <span class="token number">38.665</span> <span class="token operator">|</span>
<span class="token operator">|</span>    <span class="token number">12</span> <span class="token operator">|</span> POST   <span class="token operator">|</span> /login        <span class="token operator">|</span>  <span class="token number">0.047</span> <span class="token operator">|</span>  <span class="token number">1.971</span> <span class="token operator">|</span>  <span class="token number">7.830</span> <span class="token operator">|</span>  <span class="token number">23.649</span> <span class="token operator">|</span>
<span class="token operator">|</span>     <span class="token number">4</span> <span class="token operator">|</span> GET    <span class="token operator">|</span> /posts/<span class="token punctuation">[</span><span class="token number">0</span>-9<span class="token punctuation">]</span>+ <span class="token operator">|</span>  <span class="token number">0.120</span> <span class="token operator">|</span>  <span class="token number">3.518</span> <span class="token operator">|</span> <span class="token number">11.152</span> <span class="token operator">|</span>  <span class="token number">14.073</span> <span class="token operator">|</span>
<span class="token operator">|</span>     <span class="token number">1</span> <span class="token operator">|</span> GET    <span class="token operator">|</span> /initialize   <span class="token operator">|</span>  <span class="token number">0.027</span> <span class="token operator">|</span>  <span class="token number">0.027</span> <span class="token operator">|</span>  <span class="token number">0.027</span> <span class="token operator">|</span>   <span class="token number">0.027</span> <span class="token operator">|</span>
+-------+--------+---------------+--------+--------+--------+---------+
</code></pre></div><p>â€»<code>-m</code> ã§çµã‚Šè¾¼ã‚ãªã„ã®ã¯ã€ãã‚‚ãã‚‚ãã®ãƒ­ã‚°ãŒæ®‹ã£ã¦ãªã„ã‹ã‚‰</p> <div class="language-bash extra-class"><pre class="language-bash"><code>% alp json --sort <span class="token function">sum</span> -r -m <span class="token string">&quot;/posts/[0-9]+,/@\w+&quot;</span> -o count,method,uri,min,avg,max,sum --file ./access.log.20220610-125756                           <span class="token punctuation">[</span>~/work/private-isu/webapp/logs/nginx<span class="token punctuation">]</span>+<span class="token punctuation">[</span>master<span class="token punctuation">]</span>
+-------+--------+----------------------+-------+-------+-------+--------+
<span class="token operator">|</span> COUNT <span class="token operator">|</span> METHOD <span class="token operator">|</span>         URI          <span class="token operator">|</span>  MIN  <span class="token operator">|</span>  AVG  <span class="token operator">|</span>  MAX  <span class="token operator">|</span>  SUM   <span class="token operator">|</span>
+-------+--------+----------------------+-------+-------+-------+--------+
<span class="token operator">|</span>    <span class="token number">15</span> <span class="token operator">|</span> GET    <span class="token operator">|</span> /                    <span class="token operator">|</span> <span class="token number">2.288</span> <span class="token operator">|</span> <span class="token number">2.498</span> <span class="token operator">|</span> <span class="token number">3.502</span> <span class="token operator">|</span> <span class="token number">37.466</span> <span class="token operator">|</span>
<span class="token operator">|</span>     <span class="token number">2</span> <span class="token operator">|</span> GET    <span class="token operator">|</span> /js/timeago.min.js   <span class="token operator">|</span> <span class="token number">0.473</span> <span class="token operator">|</span> <span class="token number">1.472</span> <span class="token operator">|</span> <span class="token number">2.471</span> <span class="token operator">|</span>  <span class="token number">2.944</span> <span class="token operator">|</span>
<span class="token operator">|</span>     <span class="token number">2</span> <span class="token operator">|</span> GET    <span class="token operator">|</span> /js/main.js          <span class="token operator">|</span> <span class="token number">0.460</span> <span class="token operator">|</span> <span class="token number">1.459</span> <span class="token operator">|</span> <span class="token number">2.458</span> <span class="token operator">|</span>  <span class="token number">2.918</span> <span class="token operator">|</span>
<span class="token operator">|</span>     <span class="token number">2</span> <span class="token operator">|</span> GET    <span class="token operator">|</span> /image/9998.jpg      <span class="token operator">|</span> <span class="token number">0.408</span> <span class="token operator">|</span> <span class="token number">1.320</span> <span class="token operator">|</span> <span class="token number">2.232</span> <span class="token operator">|</span>  <span class="token number">2.640</span> <span class="token operator">|</span>
<span class="token operator">|</span>     <span class="token number">2</span> <span class="token operator">|</span> GET    <span class="token operator">|</span> /image/9999.jpg      <span class="token operator">|</span> <span class="token number">0.120</span> <span class="token operator">|</span> <span class="token number">1.302</span> <span class="token operator">|</span> <span class="token number">2.485</span> <span class="token operator">|</span>  <span class="token number">2.605</span> <span class="token operator">|</span>
<span class="token operator">|</span>     <span class="token number">1</span> <span class="token operator">|</span> GET    <span class="token operator">|</span> /css/style.css       <span class="token operator">|</span> <span class="token number">2.454</span> <span class="token operator">|</span> <span class="token number">2.454</span> <span class="token operator">|</span> <span class="token number">2.454</span> <span class="token operator">|</span>  <span class="token number">2.454</span> <span class="token operator">|</span>
<span class="token operator">|</span>     <span class="token number">2</span> <span class="token operator">|</span> GET    <span class="token operator">|</span> /image/10000.png     <span class="token operator">|</span> <span class="token number">0.205</span> <span class="token operator">|</span> <span class="token number">0.258</span> <span class="token operator">|</span> <span class="token number">0.311</span> <span class="token operator">|</span>  <span class="token number">0.516</span> <span class="token operator">|</span>
<span class="token operator">|</span>     <span class="token number">2</span> <span class="token operator">|</span> GET    <span class="token operator">|</span> /image/9997.jpg      <span class="token operator">|</span> <span class="token number">0.013</span> <span class="token operator">|</span> <span class="token number">0.238</span> <span class="token operator">|</span> <span class="token number">0.462</span> <span class="token operator">|</span>  <span class="token number">0.475</span> <span class="token operator">|</span>
<span class="token operator">|</span>     <span class="token number">1</span> <span class="token operator">|</span> GET    <span class="token operator">|</span> /image/9987.jpg      <span class="token operator">|</span> <span class="token number">0.431</span> <span class="token operator">|</span> <span class="token number">0.431</span> <span class="token operator">|</span> <span class="token number">0.431</span> <span class="token operator">|</span>  <span class="token number">0.431</span> <span class="token operator">|</span>
<span class="token operator">|</span>     <span class="token number">1</span> <span class="token operator">|</span> GET    <span class="token operator">|</span> /image/9986.jpg      <span class="token operator">|</span> <span class="token number">0.425</span> <span class="token operator">|</span> <span class="token number">0.425</span> <span class="token operator">|</span> <span class="token number">0.425</span> <span class="token operator">|</span>  <span class="token number">0.425</span> <span class="token operator">|</span>
<span class="token operator">|</span>     <span class="token number">2</span> <span class="token operator">|</span> GET    <span class="token operator">|</span> /image/9996.jpg      <span class="token operator">|</span> <span class="token number">0.422</span> <span class="token operator">|</span> <span class="token number">0.211</span> <span class="token operator">|</span> <span class="token number">0.422</span> <span class="token operator">|</span>  <span class="token number">0.422</span> <span class="token operator">|</span>
<span class="token operator">|</span>     <span class="token number">1</span> <span class="token operator">|</span> GET    <span class="token operator">|</span> /image/9981.jpg      <span class="token operator">|</span> <span class="token number">0.367</span> <span class="token operator">|</span> <span class="token number">0.367</span> <span class="token operator">|</span> <span class="token number">0.367</span> <span class="token operator">|</span>  <span class="token number">0.367</span> <span class="token operator">|</span>
<span class="token operator">|</span>     <span class="token number">1</span> <span class="token operator">|</span> GET    <span class="token operator">|</span> /image/9991.jpg      <span class="token operator">|</span> <span class="token number">0.366</span> <span class="token operator">|</span> <span class="token number">0.366</span> <span class="token operator">|</span> <span class="token number">0.366</span> <span class="token operator">|</span>  <span class="token number">0.366</span> <span class="token operator">|</span>
<span class="token operator">|</span>     <span class="token number">1</span> <span class="token operator">|</span> GET    <span class="token operator">|</span> /image/9982.jpg      <span class="token operator">|</span> <span class="token number">0.365</span> <span class="token operator">|</span> <span class="token number">0.365</span> <span class="token operator">|</span> <span class="token number">0.365</span> <span class="token operator">|</span>  <span class="token number">0.365</span> <span class="token operator">|</span>
<span class="token operator">|</span>     <span class="token number">1</span> <span class="token operator">|</span> GET    <span class="token operator">|</span> /image/9983.jpg      <span class="token operator">|</span> <span class="token number">0.357</span> <span class="token operator">|</span> <span class="token number">0.357</span> <span class="token operator">|</span> <span class="token number">0.357</span> <span class="token operator">|</span>  <span class="token number">0.357</span> <span class="token operator">|</span>
<span class="token operator">|</span>     <span class="token number">1</span> <span class="token operator">|</span> GET    <span class="token operator">|</span> /image/9990.jpg      <span class="token operator">|</span> <span class="token number">0.346</span> <span class="token operator">|</span> <span class="token number">0.346</span> <span class="token operator">|</span> <span class="token number">0.346</span> <span class="token operator">|</span>  <span class="token number">0.346</span> <span class="token operator">|</span>
<span class="token operator">|</span>     <span class="token number">1</span> <span class="token operator">|</span> GET    <span class="token operator">|</span> /image/9988.jpg      <span class="token operator">|</span> <span class="token number">0.342</span> <span class="token operator">|</span> <span class="token number">0.342</span> <span class="token operator">|</span> <span class="token number">0.342</span> <span class="token operator">|</span>  <span class="token number">0.342</span> <span class="token operator">|</span>
<span class="token operator">|</span>     <span class="token number">1</span> <span class="token operator">|</span> GET    <span class="token operator">|</span> /image/9989.jpg      <span class="token operator">|</span> <span class="token number">0.340</span> <span class="token operator">|</span> <span class="token number">0.340</span> <span class="token operator">|</span> <span class="token number">0.340</span> <span class="token operator">|</span>  <span class="token number">0.340</span> <span class="token operator">|</span>
<span class="token operator">|</span>     <span class="token number">1</span> <span class="token operator">|</span> GET    <span class="token operator">|</span> /image/9985.jpg      <span class="token operator">|</span> <span class="token number">0.323</span> <span class="token operator">|</span> <span class="token number">0.323</span> <span class="token operator">|</span> <span class="token number">0.323</span> <span class="token operator">|</span>  <span class="token number">0.323</span> <span class="token operator">|</span>
<span class="token operator">|</span>     <span class="token number">1</span> <span class="token operator">|</span> GET    <span class="token operator">|</span> /image/9995.jpg      <span class="token operator">|</span> <span class="token number">0.306</span> <span class="token operator">|</span> <span class="token number">0.306</span> <span class="token operator">|</span> <span class="token number">0.306</span> <span class="token operator">|</span>  <span class="token number">0.306</span> <span class="token operator">|</span>
<span class="token operator">|</span>     <span class="token number">1</span> <span class="token operator">|</span> GET    <span class="token operator">|</span> /image/9993.jpg      <span class="token operator">|</span> <span class="token number">0.267</span> <span class="token operator">|</span> <span class="token number">0.267</span> <span class="token operator">|</span> <span class="token number">0.267</span> <span class="token operator">|</span>  <span class="token number">0.267</span> <span class="token operator">|</span>
<span class="token operator">|</span>     <span class="token number">1</span> <span class="token operator">|</span> GET    <span class="token operator">|</span> /image/9980.jpg      <span class="token operator">|</span> <span class="token number">0.267</span> <span class="token operator">|</span> <span class="token number">0.267</span> <span class="token operator">|</span> <span class="token number">0.267</span> <span class="token operator">|</span>  <span class="token number">0.267</span> <span class="token operator">|</span>
<span class="token operator">|</span>     <span class="token number">1</span> <span class="token operator">|</span> GET    <span class="token operator">|</span> /image/9994.jpg      <span class="token operator">|</span> <span class="token number">0.255</span> <span class="token operator">|</span> <span class="token number">0.255</span> <span class="token operator">|</span> <span class="token number">0.255</span> <span class="token operator">|</span>  <span class="token number">0.255</span> <span class="token operator">|</span>
<span class="token operator">|</span>     <span class="token number">1</span> <span class="token operator">|</span> GET    <span class="token operator">|</span> /img/ajax-loader.gif <span class="token operator">|</span> <span class="token number">0.253</span> <span class="token operator">|</span> <span class="token number">0.253</span> <span class="token operator">|</span> <span class="token number">0.253</span> <span class="token operator">|</span>  <span class="token number">0.253</span> <span class="token operator">|</span>
<span class="token operator">|</span>     <span class="token number">2</span> <span class="token operator">|</span> GET    <span class="token operator">|</span> /image/10001.png     <span class="token operator">|</span> <span class="token number">0.023</span> <span class="token operator">|</span> <span class="token number">0.056</span> <span class="token operator">|</span> <span class="token number">0.090</span> <span class="token operator">|</span>  <span class="token number">0.113</span> <span class="token operator">|</span>
<span class="token operator">|</span>     <span class="token number">1</span> <span class="token operator">|</span> GET    <span class="token operator">|</span> /favicon.ico         <span class="token operator">|</span> <span class="token number">0.004</span> <span class="token operator">|</span> <span class="token number">0.004</span> <span class="token operator">|</span> <span class="token number">0.004</span> <span class="token operator">|</span>  <span class="token number">0.004</span> <span class="token operator">|</span>
+-------+--------+----------------------+-------+-------+-------+--------+
deadbeef<span class="token punctuation">(</span><span class="token number">23</span>:05:24<span class="token punctuation">)</span> ~/work/private-isu/webapp/logs/nginx
</code></pre></div></li></ul></li></ul> <h2 id="_5-ãƒ†ã‚™ãƒ¼ã‚¿ãƒ˜ã‚™ãƒ¼ã‚¹ã®ãƒãƒ¥ãƒ¼ãƒ‹ãƒ³ã‚¯ã‚™"><a href="#_5-ãƒ†ã‚™ãƒ¼ã‚¿ãƒ˜ã‚™ãƒ¼ã‚¹ã®ãƒãƒ¥ãƒ¼ãƒ‹ãƒ³ã‚¯ã‚™" class="header-anchor">#</a> 5. ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã®ãƒãƒ¥ãƒ¼ãƒ‹ãƒ³ã‚°</h2> <ul><li><p>RDBMS</p> <ul><li>å¼·ã„ä¸€è²«æ€§ã‚’æŒã¤
<ul><li>ä¸€è²«æ€§ã¨ã¯ã€ã„ãã¤ã‚‚ã®è¡¨ã«ã‚ãŸã‚Šå‡¦ç†ã‚’è¡Œã‚ãªã‘ã‚Œã°ãªã‚‰ãªã„å ´åˆã§ã‚‚ç”Ÿåˆæˆã‚’ä¿ã¤æ€§è³ª</li></ul></li> <li>MySQL, MariaDB, PostgreSQL, SQLite</li></ul></li> <li><p>NoSQL</p> <ul><li>å¼·ã„ä¸€è²«æ€§ã‚’æŒãŸãªã„ä»£ã‚ã‚Šã«é«˜é€Ÿãªå‡¦ç†ã‚’å®Ÿç¾ã™ã‚‹</li> <li>ã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢ã«ã‚ˆã£ã¦ã¯ã€è¤‡æ•°ã®ã‚µãƒ¼ãƒã«åˆ†æ•£ã—ã¦é«˜ã„ã‚¹ã‚±ãƒ¼ãƒ©ãƒ“ãƒªãƒ†ã‚£ã‚’æŒã¤</li> <li>memcached, Redis, DynamoDB, Firebase Realtime Database, Cloud Firestore</li></ul></li> <li><p>NewSQL</p> <ul><li>å¼·ã„ä¸€è²«æ€§ã¨é«˜ã„ã‚¹ã‚±ãƒ¼ãƒ©ãƒ“ãƒªãƒ†ã‚£ãŠã‚ˆã³å¯ç”¨æ€§ã‚’æŒã¤</li> <li>ä»£ã‚ã‚Šã«ã‚µãƒ¼ãƒã‚³ã‚¹ãƒˆã‚„ãƒ¬ã‚¤ãƒ†ãƒ³ã‚·ã®éƒ¨åˆ†ã§åŠ£ã‚‹</li> <li>Cloud Spanner, TiDB, Cockroach DB</li></ul></li> <li><p>ã‚¹ãƒ­ãƒ¼ã‚¯ã‚¨ãƒªã®å¯è¦–åŒ–</p> <ul><li>pt-query-digest
<ul><li><p>Installation</p> <p><a href="https://www.percona.com/doc/percona-toolkit/LATEST/installation.html" target="_blank" rel="noopener noreferrer">Installing Percona Toolkit<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <div class="language-bash extra-class"><pre class="language-bash"><code>// Debianç³»
<span class="token function">sudo</span> <span class="token function">apt</span> update
<span class="token function">sudo</span> <span class="token function">apt</span> <span class="token function">install</span> percona-toolkit
</code></pre></div><p>Slow Log Queryã®æœ‰åŠ¹åŒ–</p> <div class="language-bash extra-class"><pre class="language-bash"><code>// /etc/my.cnf
slow_query_log <span class="token operator">=</span> <span class="token number">1</span>
slow_query_log_file <span class="token operator">=</span> /var/log/mysql/mysql-slow.log
long_query_time <span class="token operator">=</span> <span class="token number">0</span>
</code></pre></div></li></ul></li></ul></li> <li><p>ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹</p> <ul><li><strong>ã‚ˆãæ¡ä»¶ã®çµã‚Šè¾¼ã¿ã«ä½¿ã‚ã‚Œã‚‹å ´åˆã¯ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã‚’è²¼ã‚Œ</strong> <ul><li>åˆ¤æ–­ã™ã‚‹ã«ã¯EXPLAINã‚’å…ˆé ­ã«ã¤ã‘ã¦å®Ÿè¡Œã—ã‚</li> <li>è¤‡åˆã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã‚‚å¯èƒ½ã ãŒã€å¯èƒ½ãªé™ã‚Šå˜ä¸€ã®ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã«ã™ã¹ã</li></ul></li> <li><strong>ä½•ã§ã‚‚ã‹ã‚“ã§ã‚‚ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã‚’è²¼ã‚‹ãªï¼ï¼ï¼</strong> <ul><li>ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã®è¿½åŠ ã€å‰Šé™¤ã«ã¯æ™‚é–“ãŒã‹ã‹ã‚‹</li> <li>ãƒ‡ãƒ¼ã‚¿ã®è¿½åŠ ãƒ»æ›´æ–°ã«ã‚‚æ™‚é–“ãŒã‹ã‹ã‚‹</li></ul></li> <li>ãƒ—ãƒ©ã‚¤ãƒãƒªã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹
<ul><li>ä¸»ã‚­ãƒ¼(PRIMARY KEY)ã«è²¼ã‚‰ã‚Œã‚‹ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹</li> <li>1ãƒ†ãƒ¼ãƒ–ãƒ«ã«1ã¤ã—ã‹å­˜åœ¨ã§ããªã„</li></ul></li> <li>ã‚»ã‚«ãƒ³ãƒ€ãƒªã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹
<ul><li>ãƒ—ãƒ©ã‚¤ãƒãƒªã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ä»¥å¤–ã®ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹</li> <li>ãƒ—ãƒ©ã‚¤ãƒãƒªã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã‚’å‚ç…§ã—ãªã„ã§çµæœãŒè¿”ã›ã‚‹é«˜é€ŸåŒ–ã‚’Covering Indexã¨å‘¼ã¶</li> <li>ä»¥ä¸‹ã®ä¾‹ã¯ãƒ—ãƒ©ã‚¤ãƒãƒªã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã‚’å‚ç…§ã›ãšã«çµæœãŒè¿”ã›ã‚‹ãŸã‚ã€ <code>user_id</code>ã«ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã‚’è²¼ã‚‹ã“ã¨ã§é«˜é€ŸåŒ–ãŒæœŸå¾…ã§ãã‚‹</li></ul></li></ul> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> <span class="token function">COUNT</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span> <span class="token keyword">FROM</span> comments WH
E user_id <span class="token operator">=</span> <span class="token number">123</span><span class="token punctuation">;</span>
</code></pre></div><ul><li><p>LIKEå¥ã‚’ç”¨ã„ã¦ã„ã‚‹å ´åˆã¯å…¨æ–‡æ¤œç´¢ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ãŒä½¿ãˆã‚‹</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> comments <span class="token keyword">WHERE</span> <span class="token keyword">comment</span> <span class="token operator">LIKE</span> <span class="token string">'%hoge%'</span>
</code></pre></div><ul><li>BTree Indexã®æ€§è³ªä¸Šã€å‰æ–¹ä¸€è‡´ã«ã—ã‹ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã‚’åˆ©ç”¨ã§ããªã„</li> <li>MySQLã§ã¯å…¨æ–‡æ¤œç´¢ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã‚’é©ç”¨ã§ãã‚‹</li></ul> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">ALTER</span> <span class="token keyword">TABLE</span> comments <span class="token keyword">ADD</span> FULLTEXT <span class="token keyword">INDEX</span> comments_full_idx <span class="token punctuation">(</span><span class="token keyword">comment</span><span class="token punctuation">)</span> <span class="token keyword">WITH</span> PARSER ngram<span class="token punctuation">;</span>
</code></pre></div></li></ul></li> <li><p>N+1å•é¡Œ</p> <ul><li>ã¨ã‚Šã‚ãˆãš <code>JOIN</code> å¥ã§æ›¸ãç›´ã™ã¨è§£æ¶ˆã•ã‚Œã‚‹ã“ã¨ãŒã‚ã‚‹
<ul><li>QueryãŒPreloadã•ã‚Œã‚‹ãŸã‚</li></ul></li> <li>Cacheã™ã‚‹
<ul><li>1åº¦ç›®ã®ãƒªã‚¯ã‚¨ã‚¹ãƒˆãŒé…ããªã‚‹å•é¡Œã¯è§£æ¶ˆã•ã‚Œãªã„</li> <li>èµ·å‹•æ™‚ã«Cacheã‚’ç™»éŒ²ã™ã‚‹ã“ã¨ã§N+1ã®å•é¡Œã‚’å°ã•ãã™ã‚‹</li></ul></li> <li>Index
<ul><li><code>ORDER BY</code> ç‹™ã„ã®Indexã¯ <code>FORCE INDEX</code> ã«ã—ãªã„ã¨æ©Ÿèƒ½ã—ãªã„ã“ã¨ãŒã‚ã‚‹</li></ul></li> <li><code>SELECT *</code> ç³»ã®ã‚¯ã‚¨ãƒªã¯ç„¡é§„ã«å¤šãã®ãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—ã™ã‚‹ã“ã¨ã«ç¹‹ãŒã‚‹å ´åˆã‚‚ã‚ã‚‹
<ul><li>Columnã®å®£è¨€æ™‚ã« <code>INVISIBLE</code> ã‚’ä»˜ä¸ã™ã‚‹</li></ul></li> <li>Prepared Statementã¯åŠ¹ç‡ãŒè½ã¡ãŒã¡
<ul><li>æº–å‚™ãŠã‚ˆã³é–‹æ”¾(CLOSE)æ™‚ã«ãƒªã‚½ãƒ¼ã‚¹ã‚’è¦ã™ã‚‹ãŸã‚</li> <li>Goãªã‚‰ <code>[sql.Open](http://sql.Open)</code> ã®æ™‚ã«ã€ <code>interpolateParams=true</code> ã«ã™ã‚‹</li></ul></li></ul></li> <li><p>DBã¨ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã¨ã®TCPã‚³ãƒã‚¯ã‚·ãƒ§ãƒ³</p> <ul><li>Client
<ul><li>MaxIdleConnection(default value: 2)
<ul><li>idleæ™‚ã«ä¿æŒã—ã¦ãŠãã‚³ãƒã‚¯ã‚·ãƒ§ãƒ³æ•°</li></ul></li> <li>MaxOpenConnection(default value: 0: inf)
<ul><li>æœ€å¤§æ¥ç¶šæ•°</li></ul></li></ul></li> <li>DB
<ul><li>max_connections
<ul><li><code>my.cnf</code> ã§è¨­å®šã§ãã‚‹</li></ul></li></ul></li></ul> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token punctuation">[</span>mysqld<span class="token punctuation">]</span>
max_connections <span class="token operator">=</span> <span class="token number">65535</span>
</code></pre></div></li> <li><p>innodbã®è¨­å®š(P162)</p></li></ul> <h2 id="_6-ãƒªãƒã‚™ãƒ¼ã‚¹ãƒ•ã‚šãƒ­ã‚­ã‚·ã®åˆ©ç”¨"><a href="#_6-ãƒªãƒã‚™ãƒ¼ã‚¹ãƒ•ã‚šãƒ­ã‚­ã‚·ã®åˆ©ç”¨" class="header-anchor">#</a> 6. ãƒªãƒãƒ¼ã‚¹ãƒ—ãƒ­ã‚­ã‚·ã®åˆ©ç”¨</h2> <ul><li>é™çš„ãƒ•ã‚¡ã‚¤ãƒ«ã‚’Nginxã‚µãƒ¼ãƒã‹ã‚‰ã‚µãƒ¼ãƒ–ã™ã‚‹ã¨ã</li></ul> <div class="language- extra-class"><pre class="language-text"><code>server {
  listen 80;

  # (snip)
  
	# js, jpg, png, css ã®æ‹¡å¼µå­ã‚’æŒã¤ãƒ•ã‚¡ã‚¤ãƒ«ã‚’å…¨ã¦Nginxã‹ã‚‰è¿”ã™
	root /home/isucon/webapp/public/;

  location ~ .*\.(htm|html|css|js|jpg|png|gif|ico) {
    expires 24h;
    add_header Cache-Control public;
      
    open_file_cache max=100  # file descriptor ãªã©ã‚’ cache

    gzip on;  # cpu ä½¿ã†ã®ã§ãƒ¡ãƒªãƒƒãƒˆãƒ»ãƒ‡ãƒ¡ãƒªãƒƒãƒˆè¦‹æ¥µã‚ã‚‹å¿…è¦ã‚ã‚Šã€‚gzip_static ä½¿ãˆã‚‹ãªã‚‰äº‹å‰ã«gzipåœ§ç¸®ã—ãŸä¸Šã§ãã¡ã‚‰ã‚’ä½¿ã†ã€‚
    gzip_types text/css application/javascript application/json application/font-woff application/font-tff image/gif image/png image/jpeg image/svg+xml image/x-icon application/octet-stream;
    gzip_disable &quot;msie6&quot;;
    gzip_static on;  # nginx configureæ™‚ã« --with-http_gzip_static_module å¿…è¦
    gzip_vary on;
    gzip_min_length 1k; # gzipåœ§ç¸®ã™ã‚‹ã¨å…ƒã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚ˆã‚Šã‚‚å¤§ãããªã‚‹ã“ã¨ãŒã‚ã‚‹
  }

  location / {
    proxy_set_header Host $host;
    proxy_pass http://localhost:8080;
  }
}
</code></pre></div><ul><li><strong>applicationå´ã§ã‚‚gzipåœ§ç¸®ã—ãŸæ–¹ãŒè‰¯ã„</strong> <ul><li>ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã‚³ã‚¹ãƒˆã¯ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹çš„ã«ã‚‚é‡‘éŠ­çš„ã«ã‚‚é«˜ãã€é«˜ã„ç¢ºç‡ã§ãƒœãƒˆãƒ«ãƒãƒƒã‚¯ã«ãªã‚‹ãŸã‚</li> <li>gzipåœ§ç¸®ã™ã‚‹å‰æã§ã‚µãƒ¼ãƒã®CPUã‚’è€ƒæ…®ã—ãŸæ–¹ãŒè‰¯ã„</li></ul></li> <li>keepaliveã«ã™ã‚‹ãŸã‚ã«ã¯(P179)
<ul><li>ãƒ¡ãƒªãƒƒãƒˆã¯ã‚³ãƒã‚¯ã‚·ãƒ§ãƒ³ã®ä½œã‚Šç›´ã—ã«ã‚ˆã‚‹ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ä½ä¸‹ã‚„è² è·ã®å¢—åŠ ãŒæ¸›ã‚‹ã“ã¨</li> <li>ãƒ‡ãƒ¡ãƒªãƒƒãƒˆã¯keepaliveã‚’ç„¡åŠ¹ã«ã—ã¦ã„ã‚‹ã¨ãã‚ˆã‚Šã‚‚ã‚³ãƒã‚¯ã‚·ãƒ§ãƒ³æ•°ãŒå¢—ãˆã‚Œã°å¢—ãˆã‚‹ã»ã©ã‚µãƒ¼ãƒå´ã«è² è·ãŒã‹ã‹ã‚‹ã“ã¨</li> <li>HTTP/2ã®åˆ©ç”¨
<ul><li>Nginxã§ <code>listen 443 ssl http2</code> ã¨ã—ã¦ãŠã‘ã°è‰¯ã„</li></ul></li></ul></li></ul> <h2 id="_7-ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã®æ´»ç”¨"><a href="#_7-ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã®æ´»ç”¨" class="header-anchor">#</a> 7. ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã®æ´»ç”¨</h2> <ul><li>Thundering herd problem
<ul><li>ã‚­ãƒ£ãƒƒã‚·ãƒ¥ãŒãªã„å ´åˆã€å¤§é‡ã®ãƒªã‚¯ã‚¨ã‚¹ãƒˆãŒappã«æ¥ãŸå ´åˆã€ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚’ä½œæˆã™ã‚‹ãŸã‚ã«Originã«å¤§é‡ã®ãƒªã‚¯ã‚¨ã‚¹ãƒˆãŒã„ãã“ã¨</li></ul></li></ul> <h2 id="_8-æŠ¼ã•ãˆã¦ãŠããŸã„é«˜é€ŸåŒ–æ‰‹æ³•"><a href="#_8-æŠ¼ã•ãˆã¦ãŠããŸã„é«˜é€ŸåŒ–æ‰‹æ³•" class="header-anchor">#</a> 8. æŠ¼ã•ãˆã¦ãŠããŸã„é«˜é€ŸåŒ–æ‰‹æ³•</h2> <ul><li><strong>å¤–éƒ¨ã‚³ãƒãƒ³ãƒ‰ã§ã¯ãªããƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’åˆ©ç”¨ã™ã‚‹</strong> <ul><li>opensslã‚³ãƒãƒ³ãƒ‰ã‚’shã§å®Ÿè¡Œã™ã‚‹ã®ã§ã¯ãªãã€è¨€èªå´ã®ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’åˆ©ç”¨ã—ãŸæ–¹ãŒã‚ªãƒ¼ãƒãƒ¼ãƒ˜ãƒƒãƒ‰ãŒå°ã•ããªã‚‹</li></ul></li> <li>ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³å´ã§å†—é•·ãªãƒ­ã‚°ã‚’å‡ºåŠ›ã—ãªã„
<ul><li>ãƒ­ã‚°å‡ºåŠ›ã¯ãƒ‡ã‚£ã‚¹ã‚¯ãƒªãƒ—ã‚¿ã‚’ãƒ­ãƒƒã‚¯ã™ã‚‹ä¸Šã«æ™‚é–“ãŒã‹ã‹ã‚‹</li></ul></li> <li>Goã®HTTPã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã«ã¤ã„ã¦
<ul><li><strong><strong><a href="https://qiita.com/ono_matope/items/60e96c01b43c64ed1d18" target="_blank" rel="noopener noreferrer">Goã§net/httpã‚’ä½¿ã†æ™‚ã®ã“ã¾ã”ã¾ã¨ã—ãŸæ³¨æ„<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></strong></strong></li></ul></li> <li>é™çš„ãƒ•ã‚¡ã‚¤ãƒ«é…ä¿¡ã‚’ãƒªãƒãƒ¼ã‚¹ãƒ—ãƒ­ã‚­ã‚·ã‹ã‚‰ç›´æ¥é…ä¿¡ã™ã‚‹
<ul><li>ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯å¸¯åŸŸãŒé€¼è¿«ã—ãªã„ã‚ˆã†ã«ã™ã‚‹ãŸã‚</li> <li>ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚µãƒ¼ãƒã®ãƒ¡ãƒ¢ãƒªã‚’é£Ÿã„æ½°ã•ãªã„ã‚ˆã†ã«ã™ã‚‹ãŸã‚</li></ul></li> <li>HTTPãƒ˜ãƒƒãƒ€ã‚’ç”¨ã„ã¦ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆå´ã«ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã•ã›ã‚‹
<ul><li><code>Cache-Control: max-age=86400</code> ã®ã‚ˆã†ãªãƒ˜ãƒƒãƒ€</li> <li>Nginxã§ã‚ã‚Œã° <code>expires</code> ã‚’è¨­å®šã—ã¦ãŠã‘ã° ğŸ†—</li></ul></li> <li>CDNâ€¦â€¦ã¯ISUCONã«ãŠã„ã¦ã¯å¤šåˆ†æ°—ã«ã—ãªãã¦è‰¯ã•ãã†</li></ul> <h2 id="_9-osã®åŸºç¤çŸ¥è­˜ã¨ãƒãƒ¥ãƒ¼ãƒ‹ãƒ³ã‚¯ã‚™"><a href="#_9-osã®åŸºç¤çŸ¥è­˜ã¨ãƒãƒ¥ãƒ¼ãƒ‹ãƒ³ã‚¯ã‚™" class="header-anchor">#</a> 9. OSã®åŸºç¤çŸ¥è­˜ã¨ãƒãƒ¥ãƒ¼ãƒ‹ãƒ³ã‚°</h2> <ul><li>Linuxã¯OSã¨ã—ã¦ã®ã‚³ã‚¢æ©Ÿèƒ½ã‚’Linux Kernelã¨å‘¼ã°ã‚Œã‚‹ã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢ãŒæ‹…ã£ã¦ã„ã‚‹</li> <li>OSä¸Šã§å‹•ä½œã™ã‚‹ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã¯ã‚·ã‚¹ãƒ†ãƒ ã‚³ãƒ¼ãƒ«ã¨å‘¼ã°ã‚Œã‚‹å‘½ä»¤ã‚’ç”¨ã„ã¦Linux Kernelã®æ©Ÿèƒ½ã‚’åˆ©ç”¨ã—ã¦ã„ã‚‹</li> <li>ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã¨OSã®ã‚³ã‚¢éƒ¨åˆ†ã®é–“ã«ã‚¤ãƒ³ã‚¿ãƒ•ã‚§ãƒ¼ã‚¹ã‚’è¨­ã‘ã¦å®Ÿè£…ã‚’åˆ†å‰²ã™ã‚‹ã“ã¨ã§ã€<strong>æ§˜ã€…ãªãƒãƒ¼ãƒ‰ã‚¦ã‚§ã‚¢ã”ã¨ã®é•ã„ã‚’OSä¸Šã§å‹•ä½œã™ã‚‹ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ãŒOSã®ãƒ¬ã‚¤ãƒ¤ãƒ¼ã«ãŠã‘ã‚‹é•ã„ã‚’æ„è­˜ã™ã‚‹ã“ã¨ãªãåˆ©ç”¨ã§ãã‚‹ã‚ˆã†ã«ãªã£ã¦ã„ã‚‹</strong></li> <li>èª­ã¿æ›¸ãã™ã‚‹ãƒ•ã‚¡ã‚¤ãƒ«ãŒã©ã®ã‚ˆã†ãªãƒãƒ¼ãƒ‰ã‚¦ã‚§ã‚¢ã§æ›¸ãè¾¼ã¾ã‚Œã¦ã„ã¦ã€ã©ã®ã‚ˆã†ãªãƒ•ã‚¡ã‚¤ãƒ«ã‚·ã‚¹ãƒ†ãƒ ä¸Šã§èª­ã¿æ›¸ããŒè¡Œã‚ã‚Œã‚‹ã®ã‹ã‚’æŒ‡å®šã™ã‚‹ã‚‚ã®ã§ã¯ãªã„
<ul><li>ã‚·ã‚¹ãƒ†ãƒ ã‚³ãƒ¼ãƒ«ã‚’ç”¨ã„ã‚‹ã“ã¨ã§ã€ãƒãƒ¼ãƒ‰ã‚¦ã‚§ã‚¢ã‚„OSãƒ¬ã‚¤ãƒ¤ã®ã‚·ã‚¹ãƒ†ãƒ ã‚’éš è”½ã—ã¦ã„ã‚‹ã“ã¨ã«ã‚ˆã‚‹æ©æµ</li></ul></li> <li>open(2)ã®2ã¯ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã®ç•ªå·
<ul><li><a href="https://t.co/RyLxxLmS6u" target="_blank" rel="noopener noreferrer">https://atmarkit.itmedia.co.jp/flinux/rensai/linuxtips/073mannum.html<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></li> <li>Linux Kernelå´ã‚’ã‚«ãƒ¼ãƒãƒ«ç©ºé–“</li> <li>ã‚·ã‚¹ãƒ†ãƒ ã‚³ãƒ¼ãƒ«ã‚’åˆ©ç”¨ã™ã‚‹LinuxOSä¸Šã®ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ãŒå‹•ä½œã™ã‚‹éƒ¨åˆ†ã‚’ãƒ¦ãƒ¼ã‚¶ç©ºé–“ã¨å‘¼ã¶</li> <li>ã‚«ãƒ¼ãƒãƒ«ç©ºé–“ã§å‡¦ç†ãŒå®Œçµã™ã‚‹å ´åˆã¯ã€ãƒ¦ãƒ¼ã‚¶ç©ºé–“ã¨æ¯”è¼ƒã—ã¦ã‚ªãƒ¼ãƒãƒ¼ãƒ˜ãƒƒãƒ‰ãŒå°‘ãªãã€ã‚ˆã‚Šé«˜é€Ÿã«å‹•ä½œã™ã‚‹å‚¾å‘ã«ã‚ã‚‹</li> <li>ãƒŸãƒ‰ãƒ«ã‚¦ã‚§ã‚¢ãªã©ã€é€Ÿåº¦ãŒè¦æ±‚ã•ã‚Œã‚‹ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã¯ç›´æ¥ã‚«ãƒ¼ãƒãƒ«ç©ºé–“ã§å‡¦ç†ã‚’è¡Œã†ã‚ˆã†å®Ÿè£…ã™ã‚‹ä¾‹ã‚‚ãŸãã•ã‚“ã‚ã‚‹</li> <li>ã‚¹ãƒ«ãƒ¼ãƒ—ãƒƒãƒˆ
<ul><li>ä¸€å®šæ™‚é–“ã§å‡¦ç†ã§ãã‚‹ãƒ‘ã‚±ãƒƒãƒˆã®é‡</li></ul></li> <li>ãƒ¬ã‚¤ãƒ†ãƒ³ã‚·
<ul><li>é€šä¿¡ã‚’é–‹å§‹ã—ã¦ã‹ã‚‰çµ‚äº†ã™ã‚‹ã¾ã§ã®æ‰€è¦æ™‚é–“</li></ul></li> <li>HDD
<ul><li>ã‚·ãƒ¼ã‚±ãƒ³ã‚·ãƒ£ãƒ«ãƒªãƒ¼ãƒ‰/ãƒ©ã‚¤ãƒˆ &gt; ãƒ©ãƒ³ãƒ€ãƒ ãƒªãƒ¼ãƒ‰/ãƒ©ã‚¤ãƒˆ</li></ul></li> <li>ä»®æƒ³ãƒ‡ã‚£ã‚¹ã‚¯
<ul><li>ãƒ©ãƒ³ãƒ€ãƒ ãƒªãƒ¼ãƒ‰/ãƒ©ã‚¤ãƒˆ &gt; ã‚·ãƒ¼ã‚±ãƒ³ã‚·ãƒ£ãƒ«ãƒªãƒ¼ãƒ‰/ãƒ©ã‚¤ãƒˆ</li></ul></li></ul> <hr> <ul><li>Linuxã‚«ãƒ¼ãƒãƒ«ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿
<ul><li><code>net.core.somaxconn</code> <ul><li>HTTPãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’å—ã‘å–ã‚Œã‚‹ã‚½ã‚±ãƒƒãƒˆã®æœ€å¤§æ•°</li></ul></li> <li><code>net.ipv4.ip_local_port_range</code> <ul><li>Ephemeral Portsã®å¹…</li></ul></li></ul></li></ul> <h2 id="private-isuã®æ”»ç•¥"><a href="#private-isuã®æ”»ç•¥" class="header-anchor">#</a> private-isuã®æ”»ç•¥</h2> <ol><li>commentsãƒ†ãƒ¼ãƒ–ãƒ«ã«ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã‚’è¿½åŠ ã™ã‚‹</li> <li>é™çš„ãƒ•ã‚¡ã‚¤ãƒ«ã‚’Nginxã§é…ä¿¡ã™ã‚‹</li> <li>ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ç”»åƒã‚’é™çš„ãƒ•ã‚¡ã‚¤ãƒ«åŒ–ã™ã‚‹</li> <li>N+1ã®è§£æ±º(JOINã‚’åˆ©ç”¨ã™ã‚‹)</li> <li>prepared statementã‚’é™¤å»ã™ã‚‹</li> <li>commentsãƒ†ãƒ¼ãƒ–ãƒ«ã¸ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã‚’è¿½åŠ ã™ã‚‹</li> <li>N+1çµæœã‚’ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã™ã‚‹</li> <li>é©åˆ‡ãªã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã‚’åˆ©ç”¨ã§ããªã„ã‚¯ã‚¨ãƒªã‚’æ›¸ãæ›ãˆã‚‹</li> <li>å¤–éƒ¨ã‚³ãƒãƒ³ãƒ‰ã®å‘¼ã³å‡ºã—ã‚’æ­¢ã‚ã‚‹</li> <li>MySQLã®ãƒ­ã‚°ã‚’æ®‹ã•ãªã„ã‚ˆã†ã«ã™ã‚‹</li> <li>memcachedã¸ã®N+1ã®ä¿®æ­£</li></ol></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">Last Updated: </span> <span class="time">1ãƒ¶æœˆå‰</span></div></footer> <!----> </main></div><div class="global-ui"><!----><!----></div></div>
    <script src="/assets/js/app.743ef69c.js" defer></script><script src="/assets/js/2.8c86708f.js" defer></script><script src="/assets/js/3.693800c4.js" defer></script><script src="/assets/js/44.cbe6deb9.js" defer></script><script src="/assets/js/4.cc429872.js" defer></script>
  </body>
</html>
